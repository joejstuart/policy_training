{"instruction": "Find a task named 'clamav-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:36d40d4009cd527f0beab5c7584356b4fb9c5baf001a7e83d8733f9a6757c818\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756320563\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:49:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-container'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-oci-ta:0.4@sha256:db496b9f7072fb9d1c4b749db6bab8c19c0b647a8a4d2589833dcec979876657\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24@sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:62807ed275ab2095195c390d662896e2e383a0cba6aecc96a1432c38ae461354\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:59Z\",\n                \"finishedOn\": \"2025-08-28T18:31:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"bundle/bundle_build_args.map\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"bundle/Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [\n                      \"version=v2.24.0\",\n                      \"io.openshift.tags=odh-operator-bundle\",\n                      \"url=https://github.com/red-hat-data-services/RHOAI-Build-Config\",\n                      \"release=1756405785\",\n                      \"git.url=https://github.com/red-hat-data-services/RHOAI-Build-Config\",\n                      \"git.commit=adf575fd0fcaaf93708eb372d2f68313384e4e4a\"\n                    ],\n                    \"NO_PROXY\": \"\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-container\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b38d64a3b1c55fb49f7f24e9d698308cb8ef4d04319e6dc0e70bf8e49fe35bc7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"090fb558925ff12714f920f9967e585612674398\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:1c6f673fe100a49f58aaef62580c8adf0c397790964f4e7bac7fcd3f4d07c92e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"release-1.3\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:6b42b39c3854c5bb9555c0c36c41e4295ee4dd403a4fbc08d72fb91f4657b9f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:0e90cf8259c7f54baad27d2a538294115f725ceb269ef789957fe68790803cbd\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6, quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:347c70e22cd8aaf5d511a734ae857ca30c0f0d52cd3480106275407ddb45e8f4\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:28Z\",\n                \"finishedOn\": \"2025-11-19T18:06:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476@sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\",\n                      \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476@sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"5d\",\n                    \"SBOM_SKIP_VALIDATION\": \"false\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:404f3bb83d250b75d7246db21a6bb8f09ba9f307ba781d448ac6825baae1ad4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:04+00:00\\\",\\\"note\\\":\\\"Task coo-fbc-v4-20-on-push-m26gh-fbc-fips-check-oci-ta failed: Could not render unreleased bundle image: registry.redhat.io/cluster-observability-operator/cluster-observability-operator-bundle@sha256:04d900c45998f21ccf96af1ba6b8c7485d13c676ca365d70b491f7dcc48974ac. Make sure the image is accessible or a mirror is provided for the same in images-mirror-set.yaml\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:58Z\",\n                \"finishedOn\": \"2025-11-12T05:28:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"image-digest\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b30d58fc0d923907b368b4d8518d9f6623ed51aaf756d94dfa723d26dc29c604\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:21Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"58e6512b6dc3ca99e1f8674b1cd8a68039754a6f\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:f289abe0fb4f64dcd09b8f7cbae89da11a64db1f123b7fb8a9986dafe31e6bdd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T06:59:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:c5e56643c0f5e19409e86c8fd4de4348413b6f10456aa0875498d5c63bf6ef0e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\":\\\"sha256:8de22cde4c025fa5a2280aae23bfba29affb99c85c1a55ee86278f162e653c58\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\":\\\"sha256:2dea4572abe98b008cfecd7794c81976a05e0e757a538043a3090722c91a5e44\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\":\\\"sha256:1b468490de5adda615f836950610ee8c2191c2fb0c74ade4e2713a570f69fdcd\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\":\\\"sha256:0836df554e3319b95f52f20b89cc6ded3f9debdf61148c4d022dcd92ee2cd56e\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:51+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:3411aeecdf045f8e61532abb88c28b7479cb8372420ac713f1f6756aa8fa843a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ef0c365378e0382400cfe0294fce5f2537b5eb934ebe67fc8addf45f67bc8a5c\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:36Z\",\n                \"finishedOn\": \"2025-11-12T05:26:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-arm64@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-ppc64le@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-s390x@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cc04739e04597e94b2875bc33b1b73c57327c13f0c08ec17b2abfdc4ae7a0381\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:48:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"aacdad213d00cdcff677600177ba5ce759582a9e\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"ERROR\\\",\\\"timestamp\\\":\\\"2025-08-20T16:08:28+00:00\\\",\\\"note\\\":\\\"Unexpected error: Script errored at command: cosign download sbom $arch_imageanddigest > ${SBOM_FILE_PATH}.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:08:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'sast-unicode-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:05+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:38Z\",\n                \"finishedOn\": \"2025-09-04T07:17:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:302828e9d7abc72b8a44fb2b9be068f86c982d8e5f4550b8bf654571d6361ee8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:3411aeecdf045f8e61532abb88c28b7479cb8372420ac713f1f6756aa8fa843a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ef0c365378e0382400cfe0294fce5f2537b5eb934ebe67fc8addf45f67bc8a5c\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:36Z\",\n                \"finishedOn\": \"2025-11-12T05:26:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-arm64@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-ppc64le@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-s390x@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:05:23Z\",\n                \"finishedOn\": \"2025-08-20T16:05:30Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\":\\\"sha256:d76c0eedd258d81cbcd9f7d6a2a76d351a266ed9a6936d6f40cc9e39f8c49c5d\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\":\\\"sha256:13c25e0934b40db9282eca16363c7683f7b9c20445400a47d39759688a12235c\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\":\\\"sha256:f5f55d8bfbba90a8694e95caf8191f9bd31e8e9e63f867ea5a5d6f87c334392d\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\":\\\"sha256:4bfa9df3c03380734e8daa664e6dd0c708ab0b0a70449dfeeba89ef3956f19c5\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T20:22:17Z\",\n                \"finishedOn\": \"2025-08-27T20:22:24Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-source-image' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:56fa2cbfc04bad4765b7fe1fa8022587f4042d4e8533bb5f65311d46b43226ee\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\\\", \\\"image_digest\\\": \\\"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src@sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/rhoai-konflux/alpine' and commit '149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/rhoai-konflux/alpine\",\n              \"digest\": {\n                \"sha256\": \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/rhoai-konflux/alpine\"\n    material.digest.sha1 == \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:216200a63475889d9ca17ef331322335f77ff17655add588b8b04c240297dc89\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:27+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:28:03Z\",\n                \"finishedOn\": \"2025-11-12T05:28:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"841e003b8c398ccebffee99100db698a83b77667:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-gcp-filestore-csi-driver-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"841e003b8c398ccebffee99100db698a83b77667\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\":\\\"sha256:9f280cc0d2093d95dfba3a0a050fc39ed9977c7d829e6e389f08d6dcfad1f478\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\":\\\"sha256:28eaabd9496b4451a73b82ebd4106e9b5c856eaeb460244501650e361e4c66ef\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\":\\\"sha256:b4993c129faaf7ba0dcaf0aeeb7598ca6099ae3ff51087689875d65dc5086f41\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\":\\\"sha256:3f33e229bd14925b2b180d5c06e8301a134a7ab6ebf38c16c722ce100619d782\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:54+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:55Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:20:38+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4bc9ae76a0fbf4007c76523772379720c-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:20:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\",\n                    \"image-digest\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'sast-snyk-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:e371aa09c65ab309138b4aeae9ea4dd93f83119c5cc61e9f2057fe5bb518fbe9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:10:40+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-sriov-network-operator-bfph6-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:10:41Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\",\n                    \"image-digest\": \"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\", \\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\", \\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\", \\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\", \\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:18:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:278f84550844c1c050a65536799f4b54e7c203e0ac51393aa75379dd974c82e9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:bd21f15d03f95d4df19f858d9df59cb089e012bfdd8d55d66bf71a77c05adc3d\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"IMAGE_DIGEST\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:49Z\",\n                \"finishedOn\": \"2025-09-04T10:11:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"false\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"af380340b19d316a235576db78456f3f087b279e\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e@sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:36d40d4009cd527f0beab5c7584356b4fb9c5baf001a7e83d8733f9a6757c818\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756405912\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:55Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\\\", \\\"digests\\\": [\\\"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 106, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T10:12:01+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:54Z\",\n                \"finishedOn\": \"2025-09-04T10:12:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T19:23:36Z\",\n                \"finishedOn\": \"2025-05-08T19:23:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:d48c621ae828a3cbca162e12ec166210d2d77a7ba23b0e5d60c4a1b94491adeb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:22Z\",\n                \"finishedOn\": \"2025-05-08T19:13:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:f87c0cccd5a5906aab86b966a42847362c57198cf2e4c2e49b9376e65932b240\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"{\\\"type\\\": \\\"npm\\\"}\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:dea8d9b4bec3e99d612d799798acf132df48276164b5193ea68f9f3c25ae425b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746732115\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\", \\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\", \\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\", \\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\", \\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:48+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:53Z\",\n                \"finishedOn\": \"2025-08-20T15:47:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src\\\", \\\"image_digest\\\": \\\"sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src@sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:57+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:30Z\",\n                \"finishedOn\": \"2025-09-04T07:16:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:09Z\",\n                \"finishedOn\": \"2025-08-20T15:47:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:df185dbe4e2852668f9c46f938dd752e90ea9c79696363378435a6499596c319\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:31+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c046d42369b94d2b4d5225157c5a8cfc4fde0d172452b9e2526da53a75fa2b8e\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:80a4562d5f86eb6812f00d4e30e94c1ad27ec937735dc29f5a63e9335676b3dc\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\", \\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\", \\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\", \\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 329, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T20:38:31Z\",\n                \"finishedOn\": \"2025-05-08T20:38:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:27Z\",\n                \"finishedOn\": \"2025-08-20T16:10:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:1f6e2c9beba52d21c562ba1dea55f579f67e33b80099615bfd2043864896284d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:ecd33669676b3a193ff4c2c6223cb912cc1b0cf5cc36e080eaec7718500272cf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:11Z\",\n                \"finishedOn\": \"2025-08-20T16:10:17Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:18Z\",\n                \"finishedOn\": \"2025-08-20T16:10:27Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:27Z\",\n                \"finishedOn\": \"2025-08-20T16:10:33Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:61155ff6bed089dac26df0ce1e1a781dc87329901bb2365c9d753110cd7b980d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:12:08Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5faec9d73b9403e7e121c89506a574e6c4fa245a030c92f4632b3e6fca91e5e0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:17:26Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1f06919168bb568caa5b6af9551ff9df3220f8c06df7d4df08e98f12013d8148\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:26:25Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:45df64587108fc9760add8e916599c10966183fdb59c10420bb1f1cc691ed513\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:16:30Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201@sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fec028d5a057d15cfe62ed95ff25942f005b4c025f4641061b37a351db95945c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:26Z\",\n                \"finishedOn\": \"2025-08-20T16:26:43Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:53+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:55Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:53+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:55Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:05+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:27:06Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:50Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:28:04+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:27372c86dc682a07262abf62e2747bdbc60ca983e431d585058ac864c3543ebd\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:4bbacb8c18e9f13dd198b0e457b0737ad156e1dc53fb8b646745fb386e27283c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:28:07Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:01+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:28:07Z\",\n                \"finishedOn\": \"2025-08-20T16:29:02Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:08+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4c4ac56711dd174d94f58757f584e40f9-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:29:09Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:29:10Z\",\n                \"finishedOn\": \"2025-08-20T16:29:17Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:4c2b0a2d2904108f8d19edfa878df6cd49ed19aab73ab6fc6a435fba0265f771\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:6b42b39c3854c5bb9555c0c36c41e4295ee4dd403a4fbc08d72fb91f4657b9f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:29Z\",\n                \"finishedOn\": \"2025-08-20T16:10:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'apply-tags' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:1c6f673fe100a49f58aaef62580c8adf0c397790964f4e7bac7fcd3f4d07c92e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"release-1.3\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201@sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:601d73801dad9ccc654e5496dbd1b482c7e2b790eb944341189b8ac43fe732d7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:22Z\",\n                \"finishedOn\": \"2025-08-20T16:16:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/rhoai-konflux/alpine' and commit '149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/rhoai-konflux/alpine\",\n              \"digest\": {\n                \"sha256\": \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/rhoai-konflux/alpine\"\n    material.digest.sha1 == \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all tasks that have status 'Succeeded'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:47:00Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:10Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:18Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5444626147a79bf9c621ec72e18a9eea5dcbaaaac35059063a71a5edfbf2c406\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:58b4eb6591e7cbc05c6e9c9306eb0f52cb1be0e88155cb8b501c1c2585e47cf9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:09:06Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4f449160b7e79378241b18204fbd5b3580cc0faea29adfe517341523bdb27991\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T16:16:22Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d917a6c605262201283e33d45e5b23bc3eff90e4b8956c750e96a97c35554eae\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:53:16Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201@sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:601d73801dad9ccc654e5496dbd1b482c7e2b790eb944341189b8ac43fe732d7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:22Z\",\n                \"finishedOn\": \"2025-08-20T16:16:39Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:49Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:46Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:17:38+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:fc5d844e2da0781932097270a845bac01a92df64ad98f08b6cd4d40188338b4c\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:64aeda019de937c9f626c13d1164a7dfaf8a097998057049ffbf747b48537b21\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:17:43Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:18:26+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:17:43Z\",\n                \"finishedOn\": \"2025-08-20T16:18:28Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:19:50+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-ose-metallb-operator-pdrnn-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:19:51Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:19:51Z\",\n                \"finishedOn\": \"2025-08-20T16:19:58Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "tasks_with_status := [task |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.status == \"Succeeded\"\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:d44336d7bcbd1f7cedee639357a493bd1f661e2859e49e11a34644bdf6819c4e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:43+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:07:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:873a0cbcf9d1533b4d9c1b3de2c47451f8b5a10aa0c3e17bfc45f6b439042854\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:23112147958e0b86932d12e16208081a8aff6ccb099194f2346842dc3d0f96c6\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:322c86ad5ee252c04440184d9f5046d276415148cb6bfaf571be1b102101786b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T14:21:18+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:58Z\",\n                \"finishedOn\": \"2025-08-28T14:21:21Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:8901482c90f5fe9fc413df7ca2d47f2142ab481794182e0a4220eb25e31348f6\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:89197c6c3e5686b5dca8b4c6e1e604d575197ca61ef21765630ed8d32fd4085f\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T20:38:31Z\",\n                \"finishedOn\": \"2025-05-08T20:38:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:80a4562d5f86eb6812f00d4e30e94c1ad27ec937735dc29f5a63e9335676b3dc\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\", \\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\", \\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\", \\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 329, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b\\\",\\\"sha256:1d416eaa1ef456e4243d3372dc25a4c8820654a0a2b517edba4aecf9474489be\\\",\\\"sha256:8ddf267b9c37170a06465f93443f600bf470239e03c47f2c096d0f6d6e6e0d63\\\",\\\"sha256:d1cf2dc47b1c139e39bd1c34edd8c33d03ffbc42638526c8f48429294934555e\\\",\\\"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756390908\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:58Z\",\n                \"finishedOn\": \"2025-08-28T14:21:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bf43aebb011b72d681f53e361dc07e92446614ca44718c3cb98fb84e7c5862c4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:04Z\",\n                \"finishedOn\": \"2025-08-20T16:08:21Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T20:42:10Z\",\n                \"finishedOn\": \"2025-08-27T20:42:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1749529764\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:43Z\",\n                \"finishedOn\": \"2025-06-10T04:29:58Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:15214d7736224455f1f2782c05df3239d0145f5e7e900e9a1055ee421e31d62d\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:34:34Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:3b9b1fa1081a50d3e1ec754351f0780b2a867433a73569c1e9573ee7c2653d5a\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:35:55Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:ac2de036a80ebc574f2711bc803c19927040e45caf779bf59dfa58b725ac4f47\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:39:39Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336@sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:5ac20d525495a4d6d449da38763187a47edb291acd70efa1dbbd8a14f75d8048\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:39Z\",\n                \"finishedOn\": \"2025-06-10T04:39:54Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\":\\\"sha256:e0d0adf148dff15572a04ce4b6460b554d03f42b09b57ea14358ced4d23acd55\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\":\\\"sha256:76a6956e29a5c71dbf068910bfe68159d3023cf9742b6d08c70f3d640709af4a\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\":\\\"sha256:8dfada9f7864c5e3d48eecb585f195ee321dbbfa71cfb62f26cd137b5f4fce7d\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":9,\\\"medium\\\":21,\\\"low\\\":21,\\\"unknown\\\":12}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:39Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749530486\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:28Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\", \\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\", \\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\", \\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 329, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:47Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:41:33Z\",\n                \"finishedOn\": \"2025-06-10T04:41:40Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:278f84550844c1c050a65536799f4b54e7c203e0ac51393aa75379dd974c82e9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:bd21f15d03f95d4df19f858d9df59cb089e012bfdd8d55d66bf71a77c05adc3d\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"IMAGE_DIGEST\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756404727\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:12:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:47:00Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:10Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:18Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5444626147a79bf9c621ec72e18a9eea5dcbaaaac35059063a71a5edfbf2c406\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:58b4eb6591e7cbc05c6e9c9306eb0f52cb1be0e88155cb8b501c1c2585e47cf9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:09:06Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4f449160b7e79378241b18204fbd5b3580cc0faea29adfe517341523bdb27991\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T16:16:22Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d917a6c605262201283e33d45e5b23bc3eff90e4b8956c750e96a97c35554eae\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:53:16Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201@sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:601d73801dad9ccc654e5496dbd1b482c7e2b790eb944341189b8ac43fe732d7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:22Z\",\n                \"finishedOn\": \"2025-08-20T16:16:39Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:49Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:46Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:17:38+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:fc5d844e2da0781932097270a845bac01a92df64ad98f08b6cd4d40188338b4c\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:64aeda019de937c9f626c13d1164a7dfaf8a097998057049ffbf747b48537b21\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:17:43Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:18:26+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:17:43Z\",\n                \"finishedOn\": \"2025-08-20T16:18:28Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:19:50+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-ose-metallb-operator-pdrnn-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:19:51Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:19:51Z\",\n                \"finishedOn\": \"2025-08-20T16:19:58Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:42+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9\",\n            \"digest\": {\n              \"sha256\": \"957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9\",\n            \"digest\": {\n              \"sha256\": \"9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9\",\n            \"digest\": {\n              \"sha256\": \"5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:68a8fe28527c4469243119a449e2b3a6655f2acac589c069ea6433242da8ed4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\":\\\"sha256:6c553e4b7971b4a358040f8590e28aea0b713d7824646cd03415783334a4ffc8\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:32:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:36+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:38+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"9553a0254dbab514fe775a168d48aef8f0cd26d0\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"9553a0254dbab514fe775a168d48aef8f0cd26d0\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"9553a02\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:02Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"9553a0254dbab514fe775a168d48aef8f0cd26d0:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-dpu-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"9553a0254dbab514fe775a168d48aef8f0cd26d0\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:06Z\",\n                \"finishedOn\": \"2025-05-08T19:13:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:c5e56643c0f5e19409e86c8fd4de4348413b6f10456aa0875498d5c63bf6ef0e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": false, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:sha256-3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335.src\\\", \\\"image_digest\\\": \\\"sha256:16573c9130c583d548cb80cfb444537fc5767b3647cb042d5513551f98b91221\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:sha256-3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335.src@sha256:16573c9130c583d548cb80cfb444537fc5767b3647cb042d5513551f98b91221\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:16573c9130c583d548cb80cfb444537fc5767b3647cb042d5513551f98b91221\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:sha256-3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:33:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:2dc676423439af7d423310e3374fc94b606809ada67893590906536109614efc\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:1b0d61ee77524d80b519e7afc9f897c4167bc833786bd70628a9d887b5c2abf9\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:38Z\",\n                \"finishedOn\": \"2025-08-20T15:47:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-local-storage-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31, quay.io/rhoai/odh-rhel9-operator@sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1, quay.io/rhoai/odh-rhel9-operator@sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18, quay.io/rhoai/odh-rhel9-operator@sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24@sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:72260cabff4384565768ec2eaa1f56a0088762baf4d1dd9b70f8cc166713afb1\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:28Z\",\n                \"finishedOn\": \"2025-08-27T20:04:45Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"632adedacf538382e56cc272c6986beb3c8925e2\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"IMAGES\": [\n                      \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-x86-64@sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\",\n                      \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-ppc64le@sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\",\n                      \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-s390x@sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\",\n                      \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-m2xlarge-arm64@sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check success: No base images to check.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'coverity-availability-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:36+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'prefetch-dependencies' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:8f73fd977807d4e3dc322814b7f8d7c4b66da457ddb664a4f91c21244b91df9d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:42+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:47+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'show-sbom' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:10:41Z\",\n                \"finishedOn\": \"2025-08-20T16:10:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:46:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970300\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:22+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-dpu-operator-9rmqb-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:05:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\",\n                    \"image-digest\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T18:06:34Z\",\n                \"finishedOn\": \"2025-08-27T18:06:41Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:36d40d4009cd527f0beab5c7584356b4fb9c5baf001a7e83d8733f9a6757c818\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756320563\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:49:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:216200a63475889d9ca17ef331322335f77ff17655add588b8b04c240297dc89\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:27+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:28:03Z\",\n                \"finishedOn\": \"2025-11-12T05:28:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'rhoai-init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\",\n                  \"params\": [\n                    {\n                      \"name\": \"url\",\n                      \"value\": \"https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n                    },\n                    {\n                      \"name\": \"revision\",\n                      \"value\": \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n                    },\n                    {\n                      \"name\": \"pathInRepo\",\n                      \"value\": \"konflux-tekton-tasks/rhoai-init/0.1/rhoai-init.yaml\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-llm-d-inference-scheduler-v2-24-on-push-grqkj|odh-llm-d-inference-scheduler-v2-24-on-push-grqkj> - 2025-08-27T17:44:49\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:44:39Z\",\n                \"finishedOn\": \"2025-08-27T17:44:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"expected-cluster\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rhoai-init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:19:20Z\",\n                \"finishedOn\": \"2025-08-20T16:19:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'apply-tags' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:1c6f673fe100a49f58aaef62580c8adf0c397790964f4e7bac7fcd3f4d07c92e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"release-1.3\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:36d40d4009cd527f0beab5c7584356b4fb9c5baf001a7e83d8733f9a6757c818\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756404804\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:13:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:03+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-image-index' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:e206be2ffdfec6787d6a8284c98236a4820493131055509ee7a15a8646ba2189\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:22Z\",\n                \"finishedOn\": \"2025-09-04T07:16:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:d0ee13ab3d9564f7ee806a8ceaced934db493a3a40e11ff6db3a912b8bbace95\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"build/Dockerfile.openshift\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:23:14+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:22:29Z\",\n                \"finishedOn\": \"2025-08-20T16:23:16Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:2b5ace1b5ec0e701a1436a8d52c38f4da58abb5e5a07322337e621e405559c28\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:70881c97a4c51ee1f4d023fa1110e0bdfcfd2f51d9a261fa543c3862b9a4eee9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"ocp__4.17__kubernetes-nmstate-rhel9-operator\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2c34868bb9c35b85a64500dec9fefc4fba3e7be1f9ce0afdd14ec8e88d8f0d0c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:21Z\",\n                \"finishedOn\": \"2025-08-20T15:49:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"9553a0254dbab514fe775a168d48aef8f0cd26d0\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:569165278e3c85e3b897abad9f6d714d76be4b061f44f5f7614ed1c83ad117b4\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:36Z\",\n                \"finishedOn\": \"2025-11-12T05:17:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all tasks that have status 'Succeeded'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1762924605\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:26Z\",\n                \"finishedOn\": \"2025-11-12T05:17:35Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:36Z\",\n                \"finishedOn\": \"2025-11-12T05:17:43Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-arm64@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:c02b976ef7a6bdf2ad90a68ed5083346727b8872f63257815ea40b3d792ee186\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:26:36Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-ppc64le@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:e78a805ee7572a235428a60e42889c7e7a40cfa79fa0c0548ccc3f8bc70e1b88\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:46Z\",\n                \"finishedOn\": \"2025-11-12T05:21:14Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-s390x@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:4047688c6214fd84eb6dd87e1abed52fd55f2a8a3d79b7a58907ee776e7b60f9\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:46Z\",\n                \"finishedOn\": \"2025-11-12T05:21:57Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ef0c365378e0382400cfe0294fce5f2537b5eb934ebe67fc8addf45f67bc8a5c\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:36Z\",\n                \"finishedOn\": \"2025-11-12T05:26:57Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:04Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:00+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:818e582f4c8457fbbe9ede7b2075a1284be5fe240f2527278453df64bfda9030\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:28:03Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:27+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:28:03Z\",\n                \"finishedOn\": \"2025-11-12T05:28:28Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:04+00:00\\\",\\\"note\\\":\\\"Task coo-fbc-v4-20-on-push-m26gh-fbc-fips-check-oci-ta failed: Could not render unreleased bundle image: registry.redhat.io/cluster-observability-operator/cluster-observability-operator-bundle@sha256:04d900c45998f21ccf96af1ba6b8c7485d13c676ca365d70b491f7dcc48974ac. Make sure the image is accessible or a mirror is provided for the same in images-mirror-set.yaml\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:58Z\",\n                \"finishedOn\": \"2025-11-12T05:28:06Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "tasks_with_status := [task |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.status == \"Succeeded\"\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:02+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:82436859839d816c9e368ae2154e6f8fe0affe44ecca52048e9494a3ccafdc21\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:49+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:13:42+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-43d404726e1e132cd7c0588f2a09e4953-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:13:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\",\n                    \"image-digest\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:d0ee13ab3d9564f7ee806a8ceaced934db493a3a40e11ff6db3a912b8bbace95\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:bced27c2e2670c7139bd8b1cf8fda441ea4fce9048b7ad623062995df9cbde83\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"bundle.openshift.Dockerfile\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_DIGEST\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:1b0d61ee77524d80b519e7afc9f897c4167bc833786bd70628a9d887b5c2abf9\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:57:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:58+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-cluster-nfd-operator-84plm-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:30:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\",\n                    \"image-digest\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-08-20T16:12:17+00:00\\\",\\\"note\\\":\\\"Step extract-and-validate failed (1): Could not fetch related images. Make sure you have catalog.yaml or catalog.json formatted correctly in your file-based catalog (FBC) fragment image.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":8,\\\"failures\\\":1,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:63cc9fef3ac927c93ad7ffe9c1eff75eb4afc9ad9804ac37840754bd211f59b0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:12:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:03+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970376\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:25+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T18:06:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:41:33Z\",\n                \"finishedOn\": \"2025-06-10T04:41:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\", \\\"digests\\\": [\\\"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\\\",\\\"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\\\",\\\"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\\\",\\\"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\\\",\\\"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:08+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:24Z\",\n                \"finishedOn\": \"2025-08-20T16:27:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:92bebb791041a4ad47e6f4f62784640dee258690076667c590707eeebac32851\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src\\\", \\\"image_digest\\\": \\\"sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src@sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git' and commit '19a01971a39db7e50c40e6db8405dfa957eec70b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-llm-d-inference-scheduler-v2-24-on-push-grqkj|odh-llm-d-inference-scheduler-v2-24-on-push-grqkj> - 2025-08-27T17:44:49\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:44:39Z\",\n                \"finishedOn\": \"2025-08-27T17:44:51Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:44:52Z\",\n                \"finishedOn\": \"2025-08-27T17:44:56Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5963a6cc76fa32879f860e9b2df35fa9428106a0\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/llm-d-inference-scheduler\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5963a6cc76fa32879f860e9b2df35fa9428106a0\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756315065\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5963a6c\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/llm-d-inference-scheduler\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:e276653f9b2eccce3d0b627e3336d3767bc08a49bac832c821135d0a4c2a0b38\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:44:56Z\",\n                \"finishedOn\": \"2025-08-27T17:45:06Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:45:06Z\",\n                \"finishedOn\": \"2025-08-27T17:47:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:609bf6cc9b31b872439a97dbf0172be95b88bfc1fb3572695863c91b77dae9b4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:47:19Z\",\n                \"finishedOn\": \"2025-08-27T17:48:56Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24@sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:c48af8bccc664777d2560fe0bd635a50fa00fa7e240de7c38c94e02c703704c0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:48:56Z\",\n                \"finishedOn\": \"2025-08-27T17:49:09Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src\\\", \\\"image_digest\\\": \\\"sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src@sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:51Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:25+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:26Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:25+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T18:06:28Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\",\\\"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:40+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:41Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\",\\\"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\":\\\"sha256:a6665a626fa8faa6c82aaa5a6eb869ebe575338b26d585e45b693070a19ad251\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":3,\\\"medium\\\":15,\\\"low\\\":37,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:39Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\",\\\"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756316997\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":7,\\\"failures\\\":1,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:59Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:30+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:32Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\",\\\"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756316985\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:49Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:16Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:e24d26271e1a77ad88ba277769ec063c038feb35a442705c5c1069dc82e70894\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:19Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\\\", \\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 106, \\\"8a3872bf3228467c\\\": 4, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:17+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:18Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-27T18:06:28Z\",\n                \"finishedOn\": \"2025-08-27T18:06:34Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T18:06:34Z\",\n                \"finishedOn\": \"2025-08-27T18:06:41Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n    material.digest.sha1 == \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b38d64a3b1c55fb49f7f24e9d698308cb8ef4d04319e6dc0e70bf8e49fe35bc7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"090fb558925ff12714f920f9967e585612674398\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:19:19+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-ptp-operator-m58j2-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:19:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\",\n                    \"image-digest\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/rhoai-konflux/alpine' and commit '149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/rhoai-konflux/alpine\",\n              \"digest\": {\n                \"sha256\": \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/rhoai-konflux/alpine\"\n    material.digest.sha1 == \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:05:06+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:46Z\",\n                \"finishedOn\": \"2025-08-27T20:22:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:8bb311e95a187638c1fcb1ca9b38422f8a86763fcf4e447da092af125faa87f9\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:c7909d4d234c744060d8f2e245f40ba80b623a4282aad7d7be90f4ed7581effa\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201@sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a44f2f924cad726d295f576a4761d9d10715106a98b3a22bdc6cbb014e5cea16\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:00Z\",\n                \"finishedOn\": \"2025-08-20T16:27:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:12:08+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-40e9556030d42926f047426c8b651ff09-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:12:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"image-digest\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\":\\\"sha256:8de22cde4c025fa5a2280aae23bfba29affb99c85c1a55ee86278f162e653c58\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\":\\\"sha256:2dea4572abe98b008cfecd7794c81976a05e0e757a538043a3090722c91a5e44\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\":\\\"sha256:1b468490de5adda615f836950610ee8c2191c2fb0c74ade4e2713a570f69fdcd\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\":\\\"sha256:0836df554e3319b95f52f20b89cc6ded3f9debdf61148c4d022dcd92ee2cd56e\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:51+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git' and commit '19a01971a39db7e50c40e6db8405dfa957eec70b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-v2-24-on-schedule-5sgsl|odh-operator-v2-24-on-schedule-5sgsl> - 2025-08-28T18:02:36\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:02:32Z\",\n                \"finishedOn\": \"2025-08-28T18:02:37Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:02:38Z\",\n                \"finishedOn\": \"2025-08-28T18:02:43Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"d71ace743e1242424d1acc5ae04ea5c1293da095\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/rhods-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"d71ace743e1242424d1acc5ae04ea5c1293da095\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756404032\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"d71ace7\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/rhods-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:ac00b0e2e04c0aeb1050529a5e82ad87756b0e1613486def9bc9496f8dee80e4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:02:44Z\",\n                \"finishedOn\": \"2025-08-28T18:02:54Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:cfcfa921e148610916faa22d962bbe414cb12431e99347638c1e2d92076ef2e3\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:02:54Z\",\n                \"finishedOn\": \"2025-08-28T18:03:54Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-x86-64@sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:8677b6208188d42c75fdc20077a9bbddff07e09eb51c19a5a35f7052cd987a4a\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:03:54Z\",\n                \"finishedOn\": \"2025-08-28T18:05:31Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-ppc64le@sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:68ff579f00118c13d1f849db18be39861150a4c55d7942de8cfd47ce8c5f2cf8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:03:54Z\",\n                \"finishedOn\": \"2025-08-28T18:06:17Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-s390x@sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:e09a1c549ecce16027cf8d0f04764630fb4623aecaca944fb05d2ca561c75f74\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:03:54Z\",\n                \"finishedOn\": \"2025-08-28T18:09:37Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-m2xlarge-arm64@sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-m2xlarge-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:38c0bacb59020a18911e3c05d34e44334ced113945bf1d6378ce9d179464a863\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:03:54Z\",\n                \"finishedOn\": \"2025-08-28T18:10:32Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b, quay.io/rhoai/odh-rhel9-operator@sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc, quay.io/rhoai/odh-rhel9-operator@sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf, quay.io/rhoai/odh-rhel9-operator@sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24@sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:8b401756f0f28bc0ce3aaa5557b76435a09f8f4282c3abd901e754154f8496d9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:42Z\",\n                \"finishedOn\": \"2025-08-28T18:10:58Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-rhel9-operator:sha256-aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05.src\\\", \\\"image_digest\\\": \\\"sha256:e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:sha256-aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05.src@sha256:e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:sha256-aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:40Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:13+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:15Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:17+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:28:20Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:09+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:10Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\":\\\"sha256:c3b730b7fa2b7268029170878a200287c70bd0b7516aae9d19142ded3290cf1c\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\":\\\"sha256:e875d09bd5e4d936d09c9f32cbb3b203864c6e621c7d321ba643d7be4aa47bd2\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\":\\\"sha256:81c5a04c66b19dbf35ff40398f8d8ba5675564d8002a10ad896b0ae0b39e4b03\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\":\\\"sha256:fd591941c94f0a17e87d1736bfda4f04f5c91fdccce3e76f73088807857df839\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:12:16+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:12:17Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756404727\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:12:27Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:16+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:18Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756404804\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:13:28Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-28T18:11:00Z\",\n                \"finishedOn\": \"2025-08-28T18:11:08Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:d6fe888c9e548191454fdc5bc66e31c00b9db1aeb2f48ec116682058e9e06b1e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:07Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\", \\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\", \\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\", \\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\", \\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:06+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:07Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-28T18:28:20Z\",\n                \"finishedOn\": \"2025-08-28T18:28:25Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-28T18:28:25Z\",\n                \"finishedOn\": \"2025-08-28T18:28:33Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n    material.digest.sha1 == \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439, quay.io/rhoai/odh-model-controller-rhel9@sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d, quay.io/rhoai/odh-model-controller-rhel9@sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859, quay.io/rhoai/odh-model-controller-rhel9@sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24@sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:7bdc50f68edc2df3da352f90c146580a83351643f3eb1171442b9da6bd41c2ef\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:05Z\",\n                \"finishedOn\": \"2025-08-27T18:47:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"d10e457ed421f3c7bc22d8df89068c9b7ac317c2\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"IMAGES\": [\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64@sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-ppc64le@sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-s390x@sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-m2xlarge-arm64@sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'prefetch-dependencies' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:42+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:302828e9d7abc72b8a44fb2b9be068f86c982d8e5f4550b8bf654571d6361ee8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'push-dockerfile' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:82436859839d816c9e368ae2154e6f8fe0affe44ecca52048e9494a3ccafdc21\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:8ad28b7783837a24acbc9a8494c935e796e591ce476085ad5899bebd7e53f077\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:25+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:44Z\",\n                \"finishedOn\": \"2025-11-19T18:07:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:873a0cbcf9d1533b4d9c1b3de2c47451f8b5a10aa0c3e17bfc45f6b439042854\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:23112147958e0b86932d12e16208081a8aff6ccb099194f2346842dc3d0f96c6\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:893ffa3ce26b061e21bb4d8db9ef7ed4ddd4044fe7aa5451ef391034da3ff759\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\":\\\"sha256:694760dead804ad826dfc25279a542d53fc1629e73e77ae15c7f9dd3e377e0cd\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\":\\\"sha256:9767a1d4d363d89910484a3c5945ce3055508503d388b319c6fc440c4907cce3\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\":\\\"sha256:ace46765225fc1b73c1b9394d4488946b8769139fdefbc1a07165ce714014b8e\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\":\\\"sha256:0798febc2dd74578550ac5a1778666453af6707187e8a744c992c902057338ec\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:07:05+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:07:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/rhoai-konflux/alpine' and commit '149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/rhoai-konflux/alpine\",\n              \"digest\": {\n                \"sha256\": \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/rhoai-konflux/alpine\"\n    material.digest.sha1 == \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:462ecbf94ec44a8b770d6ef8838955f91f57ee79795e5c18bdc0fcb0df593742\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a@sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5cea1c3f55f83a338d6fbef56e445fd4dbf05533eb2fb8d065019c592e3b49d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:40Z\",\n                \"finishedOn\": \"2025-05-08T20:26:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\",\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:29Z\",\n                \"finishedOn\": \"2025-08-20T16:10:34Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"44617ca\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:35Z\",\n                \"finishedOn\": \"2025-08-20T16:10:43Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:43Z\",\n                \"finishedOn\": \"2025-08-20T16:10:51Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3603ebb13fb7baad990d03ff10e4fad8405e81c683fbd1f316584477637ba9c9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:12:26Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0f1fc10e6c369fb87d812088ca9d9230698c95504fbc146455efa0e1a378644c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:18:03Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:37e3a1a0586a921d9b04c32ebe771d90a9815b29e7622f650b715b27b4fd307c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:26:59Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2e463c5ebcd6d4ea1cc1b8fefe35706dcec0a38699ed1d2be11640ab2124d5a2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:16:47Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201@sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a44f2f924cad726d295f576a4761d9d10715106a98b3a22bdc6cbb014e5cea16\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:00Z\",\n                \"finishedOn\": \"2025-08-20T16:27:15Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:24+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:25Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:26+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:28Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:24Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:21Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:28:15+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:a0fef942d6e2cb389682022787d04793e8c91641158f3ee79714e0a0afd9e6be\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2f141d7a86810552598b39ad161836d01d51d32e8f6aa5667c29ff76d4279f42\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:28:20Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:08+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:28:20Z\",\n                \"finishedOn\": \"2025-08-20T16:29:09Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:58+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-cluster-nfd-operator-84plm-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:30:00Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:30:00Z\",\n                \"finishedOn\": \"2025-08-20T16:30:07Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:08+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4c4ac56711dd174d94f58757f584e40f9-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:29:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\",\n                    \"image-digest\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:07Z\",\n                \"finishedOn\": \"2025-08-28T18:30:14Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'prefetch-dependencies' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:1f6e2c9beba52d21c562ba1dea55f579f67e33b80099615bfd2043864896284d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:2dc676423439af7d423310e3374fc94b606809ada67893590906536109614efc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:1b0d61ee77524d80b519e7afc9f897c4167bc833786bd70628a9d887b5c2abf9\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:30:01Z\",\n                \"finishedOn\": \"2025-06-10T04:31:30Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:0ca59eda137e229be4ca03be8d742fdfcc35e58747c48168b47a9379aa4e9139\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:462ecbf94ec44a8b770d6ef8838955f91f57ee79795e5c18bdc0fcb0df593742\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a@sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5cea1c3f55f83a338d6fbef56e445fd4dbf05533eb2fb8d065019c592e3b49d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:40Z\",\n                \"finishedOn\": \"2025-05-08T20:26:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\",\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'deprecated-base-image-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:53+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:55Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/rhoai-konflux/alpine' and commit '149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/rhoai-konflux/alpine\",\n              \"digest\": {\n                \"sha256\": \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/rhoai-konflux/alpine\"\n    material.digest.sha1 == \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\", \\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\", \\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\", \\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\", \\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:18:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:24Z\",\n                \"finishedOn\": \"2025-08-20T16:12:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:68a8fe28527c4469243119a449e2b3a6655f2acac589c069ea6433242da8ed4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\":\\\"sha256:e0d0adf148dff15572a04ce4b6460b554d03f42b09b57ea14358ced4d23acd55\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\":\\\"sha256:76a6956e29a5c71dbf068910bfe68159d3023cf9742b6d08c70f3d640709af4a\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\":\\\"sha256:8dfada9f7864c5e3d48eecb585f195ee321dbbfa71cfb62f26cd137b5f4fce7d\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":9,\\\"medium\\\":21,\\\"low\\\":21,\\\"unknown\\\":12}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:38+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'show-sbom' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:1c6f673fe100a49f58aaef62580c8adf0c397790964f4e7bac7fcd3f4d07c92e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"release-1.3\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:7e7446e238976c3832d1e26feee86f92a43836808a7153a587cf22804a0e2e8a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-28T14:20:58Z\",\n                \"finishedOn\": \"2025-08-28T14:21:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"rhoai-2.24-ec79b74a364e0ce075d4c6074e9aa4a62c32b66f\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:47+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T19:04:44Z\",\n                \"finishedOn\": \"2025-08-27T19:04:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:sha256-38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347.src\\\", \\\"image_digest\\\": \\\"sha256:6e8b20cf07b5b718aa540bd41dc55cd5765d67e95cc3d988dcf80ac480f24639\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347.src@sha256:6e8b20cf07b5b718aa540bd41dc55cd5765d67e95cc3d988dcf80ac480f24639\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6e8b20cf07b5b718aa540bd41dc55cd5765d67e95cc3d988dcf80ac480f24639\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:58Z\",\n                \"finishedOn\": \"2025-08-28T14:21:45Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:8901482c90f5fe9fc413df7ca2d47f2142ab481794182e0a4220eb25e31348f6\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:89197c6c3e5686b5dca8b4c6e1e604d575197ca61ef21765630ed8d32fd4085f\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:844e87596d4e75733b5863f5343a9fcb8ee28ba04835390e7a298a55da13303e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:23Z\",\n                \"finishedOn\": \"2025-09-04T07:17:38Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-container'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-oci-ta:0.4@sha256:c9ef8d723f5c3d65ec910d6fdb74607332620289ab083d6c97c602226fe7a8d2\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e@sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:f137fff6ca7db41b5b8d75d60aaa71df1c946bd536b4a64266d7dddee5783c63\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:16Z\",\n                \"finishedOn\": \"2025-09-04T10:11:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"af380340b19d316a235576db78456f3f087b279e\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile.bundle\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-container\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git' and commit '19a01971a39db7e50c40e6db8405dfa957eec70b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-bundle-v2-24-on-schedule-vqxk9|odh-operator-bundle-v2-24-on-schedule-vqxk9> - 2025-08-28T18:30:06\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:00Z\",\n                \"finishedOn\": \"2025-08-28T18:30:06Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:07Z\",\n                \"finishedOn\": \"2025-08-28T18:30:14Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756405785\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575f\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:43Z\",\n                \"finishedOn\": \"2025-08-28T18:30:52Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:52Z\",\n                \"finishedOn\": \"2025-08-28T18:30:59Z\"\n              },\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24@sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:62807ed275ab2095195c390d662896e2e383a0cba6aecc96a1432c38ae461354\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:59Z\",\n                \"finishedOn\": \"2025-08-28T18:31:26Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:26Z\",\n                \"finishedOn\": \"2025-08-28T18:31:32Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": false, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/rhoai/odh-operator-bundle:sha256-eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c.src\\\", \\\"image_digest\\\": \\\"sha256:93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c.src@sha256:93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:46Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:53+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:58Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:45+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:48:49Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check success: No base images to check.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:39Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\":\\\"sha256:f4b62c4f4a7f816b42d47cbe077109e127461e2e13774398adbcf8ecb8f15240\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:43Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:32:11+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:32:13Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:44+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta success: Snyk code test found zero supported files.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:33Z\",\n                \"finishedOn\": \"2025-08-28T18:31:45Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756405912\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:55Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:41Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:12b985bec985945a920297c6951e8590493c735e33d40e73e919bbcb7f7443dc\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:33Z\",\n                \"finishedOn\": \"2025-08-28T18:31:47Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:51+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:33Z\",\n                \"finishedOn\": \"2025-08-28T18:31:52Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-28T18:48:49Z\",\n                \"finishedOn\": \"2025-08-28T18:48:56Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-28T18:48:56Z\",\n                \"finishedOn\": \"2025-08-28T18:49:02Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n    material.digest.sha1 == \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:59094118aa07d5b0199565c4e0b2d0f4feb9a4741877c8716877572e2c4804f9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746732213\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970431\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:36+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:41+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:05:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970376\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:569165278e3c85e3b897abad9f6d714d76be4b061f44f5f7614ed1c83ad117b4\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:36Z\",\n                \"finishedOn\": \"2025-11-12T05:17:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:1c6f673fe100a49f58aaef62580c8adf0c397790964f4e7bac7fcd3f4d07c92e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"release-1.3\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:df185dbe4e2852668f9c46f938dd752e90ea9c79696363378435a6499596c319\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:31+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:e371aa09c65ab309138b4aeae9ea4dd93f83119c5cc61e9f2057fe5bb518fbe9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:13+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:18:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'rhoai-init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\",\n                  \"params\": [\n                    {\n                      \"name\": \"url\",\n                      \"value\": \"https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n                    },\n                    {\n                      \"name\": \"revision\",\n                      \"value\": \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n                    },\n                    {\n                      \"name\": \"pathInRepo\",\n                      \"value\": \"konflux-tekton-tasks/rhoai-init/0.1/rhoai-init.yaml\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-bundle-v2-24-on-schedule-vqxk9|odh-operator-bundle-v2-24-on-schedule-vqxk9> - 2025-08-28T18:30:06\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:00Z\",\n                \"finishedOn\": \"2025-08-28T18:30:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"expected-cluster\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rhoai-init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"9f30f610f27f49c16b415291d0c31294984b311b7baa61c620428c12d7f60f4b\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:278f84550844c1c050a65536799f4b54e7c203e0ac51393aa75379dd974c82e9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:6b3ac50656ff1380a59dbaf04852be5c453fcfbd792b849fe54a4560c5655bf1\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGE_DIGEST\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:386c8c3395b44f6eb927dbad72382808b0ae42008f183064ca77cb4cad998442\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749530486\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:46:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:50Z\",\n                \"finishedOn\": \"2025-05-08T19:54:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit 'aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\\\", \\\"image_digest\\\": \\\"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src@sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:00Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3273b1883893dcaa12df6d9f1904b78da6f43ac4fa723d5279a4ff2a026d3ee3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:48:59Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cc5391bbb1e432ba267919dedab3374870ff07da4a24544b508cb909953abde4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:05:32Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:88dc05570ba02c7008aedc0bd3a520f6d381aa091ea85264aade670945148ed7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:15:58Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:697d9b9ad7439f2d7254cbe712d3600d6ce0431cfdea8a5b7e5929e052e61dc2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:53:16Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:381987bc72b77393d3ddba058d4e2816bda0d0d5ac5dbec7aba1d2d04223098d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:59Z\",\n                \"finishedOn\": \"2025-08-20T16:16:15Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:25+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:16Z\",\n                \"finishedOn\": \"2025-08-20T16:16:27Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:26+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:25Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:25Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:17:19+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c5da01347483e5b6b126711755b05466a5c0e6dd7b91f74113be220552619d93\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:b00c593d5664fe8a012a6740f28d61970552ae4e4572aacc9e21e6587c5e3c4a\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:16Z\",\n                \"finishedOn\": \"2025-08-20T16:17:25Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:18:12+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:17:25Z\",\n                \"finishedOn\": \"2025-08-20T16:18:14Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:20:38+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4bc9ae76a0fbf4007c76523772379720c-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:20:39Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:20:39Z\",\n                \"finishedOn\": \"2025-08-20T16:20:47Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:09+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:10Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970431\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release\",\n            \"digest\": {\n              \"sha256\": \"3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release\",\n            \"digest\": {\n              \"sha256\": \"16573c9130c583d548cb80cfb444537fc5767b3647cb042d5513551f98b91221\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:8f73fd977807d4e3dc322814b7f8d7c4b66da457ddb664a4f91c21244b91df9d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:29:10Z\",\n                \"finishedOn\": \"2025-08-20T16:29:17Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:ecd33669676b3a193ff4c2c6223cb912cc1b0cf5cc36e080eaec7718500272cf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:26+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:22290579c9fe0b5c1689bb9023b3eddec73c285b680226d9f460346ae849a2cb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:8901482c90f5fe9fc413df7ca2d47f2142ab481794182e0a4220eb25e31348f6\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:89197c6c3e5686b5dca8b4c6e1e604d575197ca61ef21765630ed8d32fd4085f\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:12:17Z\",\n                \"finishedOn\": \"2025-08-28T14:13:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:12d79388558f7c27c782638657b9b65318d0dc8a1e0f2098fed20e3129ccfde7\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"{\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:05:06+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:46Z\",\n                \"finishedOn\": \"2025-08-27T20:22:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:8bb311e95a187638c1fcb1ca9b38422f8a86763fcf4e447da092af125faa87f9\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:c7909d4d234c744060d8f2e245f40ba80b623a4282aad7d7be90f4ed7581effa\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24@sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:c48af8bccc664777d2560fe0bd635a50fa00fa7e240de7c38c94e02c703704c0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:48:56Z\",\n                \"finishedOn\": \"2025-08-27T17:49:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"5963a6cc76fa32879f860e9b2df35fa9428106a0\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"IMAGES\": [\n                      \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clone-repository' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"841e003b8c398ccebffee99100db698a83b77667:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-gcp-filestore-csi-driver-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"841e003b8c398ccebffee99100db698a83b77667\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:68a8fe28527c4469243119a449e2b3a6655f2acac589c069ea6433242da8ed4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\":\\\"sha256:e0d0adf148dff15572a04ce4b6460b554d03f42b09b57ea14358ced4d23acd55\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\":\\\"sha256:76a6956e29a5c71dbf068910bfe68159d3023cf9742b6d08c70f3d640709af4a\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\":\\\"sha256:8dfada9f7864c5e3d48eecb585f195ee321dbbfa71cfb62f26cd137b5f4fce7d\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":9,\\\"medium\\\":21,\\\"low\\\":21,\\\"unknown\\\":12}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'deprecated-base-image-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:ecd33669676b3a193ff4c2c6223cb912cc1b0cf5cc36e080eaec7718500272cf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:31Z\",\n                \"finishedOn\": \"2025-08-20T16:11:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all tasks with status 'Succeeded'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:00Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3273b1883893dcaa12df6d9f1904b78da6f43ac4fa723d5279a4ff2a026d3ee3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:48:59Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cc5391bbb1e432ba267919dedab3374870ff07da4a24544b508cb909953abde4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:05:32Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:88dc05570ba02c7008aedc0bd3a520f6d381aa091ea85264aade670945148ed7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:15:58Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:697d9b9ad7439f2d7254cbe712d3600d6ce0431cfdea8a5b7e5929e052e61dc2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:53:16Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:381987bc72b77393d3ddba058d4e2816bda0d0d5ac5dbec7aba1d2d04223098d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:59Z\",\n                \"finishedOn\": \"2025-08-20T16:16:15Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:25+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:16Z\",\n                \"finishedOn\": \"2025-08-20T16:16:27Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:26+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:25Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:25Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:17:19+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c5da01347483e5b6b126711755b05466a5c0e6dd7b91f74113be220552619d93\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:b00c593d5664fe8a012a6740f28d61970552ae4e4572aacc9e21e6587c5e3c4a\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:16Z\",\n                \"finishedOn\": \"2025-08-20T16:17:25Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:18:12+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:17:25Z\",\n                \"finishedOn\": \"2025-08-20T16:18:14Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:20:38+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4bc9ae76a0fbf4007c76523772379720c-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:20:39Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:20:39Z\",\n                \"finishedOn\": \"2025-08-20T16:20:47Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "tasks_with_status := [task |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.status == \"Succeeded\"\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:09Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:2e2d1bafb57422191e4a181d2b365689dcf9c0786df355ca748c5ffb0632357a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:04:07Z\",\n                \"finishedOn\": \"2025-09-04T07:07:38Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:01bb6fd842fa4f3630f797161c4b0389e932fc8995c2cf1cdf62c17526f16f50\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:08:09Z\",\n                \"finishedOn\": \"2025-09-04T07:13:39Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:30fabdd7a3a66780e8ae4c4da0b97b5ce4812918c9a7cfd245e9b46b0e4f359d\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:09:09Z\",\n                \"finishedOn\": \"2025-09-04T07:15:22Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:606dd5b32ee93a3b733de7343e05cd910473425e24a808918fd8f977ac1358cd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:03:07Z\",\n                \"finishedOn\": \"2025-09-04T07:10:15Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:844e87596d4e75733b5863f5343a9fcb8ee28ba04835390e7a298a55da13303e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:23Z\",\n                \"finishedOn\": \"2025-09-04T07:17:38Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:47+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:48Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\":\\\"sha256:9f280cc0d2093d95dfba3a0a050fc39ed9977c7d829e6e389f08d6dcfad1f478\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\":\\\"sha256:28eaabd9496b4451a73b82ebd4106e9b5c856eaeb460244501650e361e4c66ef\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\":\\\"sha256:b4993c129faaf7ba0dcaf0aeeb7598ca6099ae3ff51087689875d65dc5086f41\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\":\\\"sha256:3f33e229bd14925b2b180d5c06e8301a134a7ab6ebf38c16c722ce100619d782\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:54+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:55Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970431\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:39Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\"\n              },\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:45+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:46Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:02Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:47Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:08f0413958c10027ce982f1d120c2377f7f0740643245567430226ac0bed6312\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:54Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\", \\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\", \\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\", \\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\", \\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:48+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:49Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:21:36Z\",\n                \"finishedOn\": \"2025-09-04T07:21:42Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'coverity-availability-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:36+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'rhoai-init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\",\n                  \"params\": [\n                    {\n                      \"name\": \"url\",\n                      \"value\": \"https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n                    },\n                    {\n                      \"name\": \"revision\",\n                      \"value\": \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n                    },\n                    {\n                      \"name\": \"pathInRepo\",\n                      \"value\": \"konflux-tekton-tasks/rhoai-init/0.1/rhoai-init.yaml\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-model-controller-v2-24-on-push-6gkdw|odh-model-controller-v2-24-on-push-6gkdw> - 2025-08-28T14:12:02\\nStatus: Failed :failed:\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:11:56Z\",\n                \"finishedOn\": \"2025-08-28T14:12:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"expected-cluster\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rhoai-init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:8ecf57d5a6697ce709bee65b62781efe79a10b0c2b95e05576442b67fbd61744\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709479\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b95197\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:55Z\",\n                \"finishedOn\": \"2025-05-08T19:55:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/quipucords/quipucords\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:26+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:322c86ad5ee252c04440184d9f5046d276415148cb6bfaf571be1b102101786b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:40+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:0da734a811d57810f80202cceb2d79051d1de150f39f7689c5415f655598d62f\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:298c8a06c501915e7038d45aa91d7172815d0a00d538785401504f90bc82ca8d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:b6dc1948778552a53b863682f8d42dcdda8b25348b5a3b97efb2398ba17f290d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:00+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:818e582f4c8457fbbe9ede7b2075a1284be5fe240f2527278453df64bfda9030\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:28:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'd2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:42+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:59094118aa07d5b0199565c4e0b2d0f4feb9a4741877c8716877572e2c4804f9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:23:55Z\",\n                \"finishedOn\": \"2025-08-27T20:24:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:ecd33669676b3a193ff4c2c6223cb912cc1b0cf5cc36e080eaec7718500272cf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:57b3262138eb06186ae7375f84ca53788bba2a66cfd03d39cb82c78df050aba5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201@sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a44f2f924cad726d295f576a4761d9d10715106a98b3a22bdc6cbb014e5cea16\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:00Z\",\n                \"finishedOn\": \"2025-08-20T16:27:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'clair-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\":\\\"sha256:d76c0eedd258d81cbcd9f7d6a2a76d351a266ed9a6936d6f40cc9e39f8c49c5d\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\":\\\"sha256:13c25e0934b40db9282eca16363c7683f7b9c20445400a47d39759688a12235c\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\":\\\"sha256:f5f55d8bfbba90a8694e95caf8191f9bd31e8e9e63f867ea5a5d6f87c334392d\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\":\\\"sha256:4bfa9df3c03380734e8daa664e6dd0c708ab0b0a70449dfeeba89ef3956f19c5\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:94d959e3f06ef88c1e9e661ddbea557e178b56d45e38cc49508655f94be54414\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476@sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:d9156385290597ab7b708b991065a908c56181023f50276e2d8c2b5bfce8636b\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:03:01Z\",\n                \"finishedOn\": \"2025-11-19T18:06:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:873a0cbcf9d1533b4d9c1b3de2c47451f8b5a10aa0c3e17bfc45f6b439042854\",\n                    \"COMMIT_SHA\": \"001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"CONTEXT\": \"images/git\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"default/Containerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"IMAGE_APPEND_PLATFORM\": \"false\",\n                    \"IMAGE_EXPIRES_AFTER\": \"5d\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"true\",\n                    \"PLATFORM\": \"linux/arm64\",\n                    \"PREFETCH_INPUT\": \"[{\\\"type\\\":\\\"rpm\\\",\\\"path\\\":\\\"images/git/default/rpms\\\",\\\"options\\\":{\\\"dnf\\\":{\\\"hummingbird\\\":{\\\"gpgcheck\\\":\\\"0\\\"},\\\"hummingbird-source\\\":{\\\"gpgcheck\\\":\\\"0\\\"}}}}]\",\n                    \"PRIVILEGED_NESTED\": \"true\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"caching-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"true\",\n                    \"SBOM_SKIP_VALIDATION\": \"true\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"true\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:23112147958e0b86932d12e16208081a8aff6ccb099194f2346842dc3d0f96c6\",\n                    \"SOURCE_DATE_EPOCH\": \"1763544424\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:b6dc1948778552a53b863682f8d42dcdda8b25348b5a3b97efb2398ba17f290d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:00+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:818e582f4c8457fbbe9ede7b2075a1284be5fe240f2527278453df64bfda9030\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:28:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:53+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:55Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:06Z\",\n                \"finishedOn\": \"2025-05-08T19:13:12Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords-ui\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709408\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords-ui\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:f87c0cccd5a5906aab86b966a42847362c57198cf2e4c2e49b9376e65932b240\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:12Z\",\n                \"finishedOn\": \"2025-05-08T19:13:22Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:23Z\",\n                \"finishedOn\": \"2025-05-08T19:13:34Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:22Z\",\n                \"finishedOn\": \"2025-05-08T19:13:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:12efa4ba2a16013318256c9275308637a8f7375552fdf944b4514aa251eeafa5\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:50Z\",\n                \"finishedOn\": \"2025-05-08T19:15:26Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:ea2bf4de2bc002139fc1f430d6f994a61e04b6358043aee63b633911ebdc4da5\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:50Z\",\n                \"finishedOn\": \"2025-05-08T19:20:51Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755@sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:976058e10b643ac4df6aa99e1090a74ba305e11dd660d4336d6f2710f53c7ff0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:20:51Z\",\n                \"finishedOn\": \"2025-05-08T19:21:13Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\\\", \\\"image_digest\\\": \\\"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src@sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:22:20Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:22+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:23Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\":\\\"sha256:d0af342fc5f40e968e180cf7e1fa127968d92060cd33270c86eb8fa511da61c8\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\":\\\"sha256:baa7690ba743163a9a77694894dbf63d8ebcf93bd5220e1af2bc77c8b107c009\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":582,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:23:04+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:05Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746732115\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:57Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:41+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:43Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746732213\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:36Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:30+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:31+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:22Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:6b3ac50656ff1380a59dbaf04852be5c453fcfbd792b849fe54a4560c5655bf1\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:20Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T19:23:36Z\",\n                \"finishedOn\": \"2025-05-08T19:23:44Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:8ecf57d5a6697ce709bee65b62781efe79a10b0c2b95e05576442b67fbd61744\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1749529764\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:43Z\",\n                \"finishedOn\": \"2025-06-10T04:29:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift/file-integrity-operator\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:c5e56643c0f5e19409e86c8fd4de4348413b6f10456aa0875498d5c63bf6ef0e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:94d959e3f06ef88c1e9e661ddbea557e178b56d45e38cc49508655f94be54414\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476@sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:d9156385290597ab7b708b991065a908c56181023f50276e2d8c2b5bfce8636b\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:03:01Z\",\n                \"finishedOn\": \"2025-11-19T18:06:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:873a0cbcf9d1533b4d9c1b3de2c47451f8b5a10aa0c3e17bfc45f6b439042854\",\n                    \"COMMIT_SHA\": \"001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"CONTEXT\": \"images/git\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"default/Containerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"IMAGE_APPEND_PLATFORM\": \"false\",\n                    \"IMAGE_EXPIRES_AFTER\": \"5d\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"true\",\n                    \"PLATFORM\": \"linux/arm64\",\n                    \"PREFETCH_INPUT\": \"[{\\\"type\\\":\\\"rpm\\\",\\\"path\\\":\\\"images/git/default/rpms\\\",\\\"options\\\":{\\\"dnf\\\":{\\\"hummingbird\\\":{\\\"gpgcheck\\\":\\\"0\\\"},\\\"hummingbird-source\\\":{\\\"gpgcheck\\\":\\\"0\\\"}}}}]\",\n                    \"PRIVILEGED_NESTED\": \"true\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"caching-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"true\",\n                    \"SBOM_SKIP_VALIDATION\": \"true\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"true\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:23112147958e0b86932d12e16208081a8aff6ccb099194f2346842dc3d0f96c6\",\n                    \"SOURCE_DATE_EPOCH\": \"1763544424\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:462ecbf94ec44a8b770d6ef8838955f91f57ee79795e5c18bdc0fcb0df593742\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755@sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:976058e10b643ac4df6aa99e1090a74ba305e11dd660d4336d6f2710f53c7ff0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:20:51Z\",\n                \"finishedOn\": \"2025-05-08T19:21:13Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\",\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:21:36Z\",\n                \"finishedOn\": \"2025-09-04T07:21:42Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:53+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:82436859839d816c9e368ae2154e6f8fe0affe44ecca52048e9494a3ccafdc21\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:d0ee13ab3d9564f7ee806a8ceaced934db493a3a40e11ff6db3a912b8bbace95\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"build/Dockerfile.openshift\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:9c95b1fe17db091ae364344ba2006af46648e08486eef1f6fe1b9e3f10866875\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336@sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:5ac20d525495a4d6d449da38763187a47edb291acd70efa1dbbd8a14f75d8048\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:39Z\",\n                \"finishedOn\": \"2025-06-10T04:39:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\",\n                      \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\",\n                      \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:45+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:48:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:24:34Z\",\n                \"finishedOn\": \"2025-08-20T16:24:42Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main\",\n            \"digest\": {\n              \"sha256\": \"f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main\",\n            \"digest\": {\n              \"sha256\": \"720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main\",\n            \"digest\": {\n              \"sha256\": \"c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main\",\n            \"digest\": {\n              \"sha256\": \"b2c7030cb6001d87e7c481849c69c2aff64ad3bf6f8fda456880815378e74ce8\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:45+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:5d0d9cc31381c5ef4093c7800e0528cda1d07d5db2d7ae733132e54870bb2dbc\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:893ffa3ce26b061e21bb4d8db9ef7ed4ddd4044fe7aa5451ef391034da3ff759\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\",\\\"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\":\\\"sha256:a6665a626fa8faa6c82aaa5a6eb869ebe575338b26d585e45b693070a19ad251\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":3,\\\"medium\\\":15,\\\"low\\\":37,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\",\n                    \"image-url\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'pipeline-success-indicator'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-27T19:04:39Z\",\n                \"finishedOn\": \"2025-08-27T19:04:44Z\",\n                \"invocation\": {\n                  \"parameters\": {}\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"pipeline-success-indicator\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'clamav-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970294\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:e206be2ffdfec6787d6a8284c98236a4820493131055509ee7a15a8646ba2189\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:22Z\",\n                \"finishedOn\": \"2025-09-04T07:16:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'rpms-signature-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:31Z\",\n                \"finishedOn\": \"2025-08-20T16:11:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T20:42:10Z\",\n                \"finishedOn\": \"2025-08-27T20:42:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:57b3262138eb06186ae7375f84ca53788bba2a66cfd03d39cb82c78df050aba5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:d48c621ae828a3cbca162e12ec166210d2d77a7ba23b0e5d60c4a1b94491adeb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:04Z\",\n                \"finishedOn\": \"2025-05-08T19:56:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"pip\\\", \\\"requirements_files\\\": [\\\"lockfiles/requirements.txt\\\"], \\\"requirements_build_files\\\": [\\\"lockfiles/requirements-build.txt\\\"]}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"lockfiles\\\"}, {\\\"type\\\": \\\"generic\\\", \\\"path\\\": \\\"lockfiles\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:31294d9b2cc4f1f608ac5f9b194b9488616cade52836f28ba611604c724375f6\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:18Z\",\n                \"finishedOn\": \"2025-08-20T15:48:56Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bbcb490945b612c00359b666ec4dc94fab1f4e767c6922a3b4a4ab57d3301d30\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:70881c97a4c51ee1f4d023fa1110e0bdfcfd2f51d9a261fa543c3862b9a4eee9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:21Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"ocp__4.17__ose-cluster-nfd-rhel9-operator\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:24Z\",\n                \"finishedOn\": \"2025-08-20T16:12:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:d6fe888c9e548191454fdc5bc66e31c00b9db1aeb2f48ec116682058e9e06b1e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Dockerfiles/Dockerfile.konflux\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"IMAGE_DIGEST\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\", \\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\", \\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\", \\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\", \\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:18:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T10:12:02+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:54Z\",\n                \"finishedOn\": \"2025-09-04T10:12:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:31Z\",\n                \"finishedOn\": \"2025-08-20T16:11:37Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"78f88369280abadef5251ec5434ffc59c84aca41\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"78f88369280abadef5251ec5434ffc59c84aca41\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"78f8836\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:38Z\",\n                \"finishedOn\": \"2025-08-20T16:11:46Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:46Z\",\n                \"finishedOn\": \"2025-08-20T16:11:52Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:165466d072eb611cd5306982785ef6f6e646fb0e18c70c19e7d78cd49cd1867f\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:52Z\",\n                \"finishedOn\": \"2025-08-20T16:13:32Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d5a05221ef3554f3b85d896f87727711a5277bc84d44949088fec982c193bc22\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:52Z\",\n                \"finishedOn\": \"2025-08-20T16:20:33Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c9b10f133f9674b38e7205744243a269cff4e188569676874b25cdd8d097919e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:52Z\",\n                \"finishedOn\": \"2025-08-20T16:24:43Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:69156445cece3a86b28e7b979ac0152a1e5c9209182c7847f922deba558eed9a\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:52Z\",\n                \"finishedOn\": \"2025-08-20T16:17:49Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201@sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:abf744d9b5502fbb05bc850e0ef69f9aab70131e8fe825cfc20cc5a9e223201c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:24:43Z\",\n                \"finishedOn\": \"2025-08-20T16:25:00Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:11+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:25:12Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:11+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:25:13Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\\\",\\\"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\\\",\\\"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\\\",\\\"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\\\",\\\"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:10+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:25:11Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:25:01Z\",\n                \"finishedOn\": \"2025-08-20T16:25:09Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\\\",\\\"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\\\",\\\"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\\\",\\\"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\\\",\\\"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:17+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:950cab6287ccfc60977aefb0e0ffffa6ff0eab2e5b72834566eabe9662597cc7\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:92bebb791041a4ad47e6f4f62784640dee258690076667c590707eeebac32851\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:26:23Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\", \\\"digests\\\": [\\\"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\\\",\\\"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\\\",\\\"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\\\",\\\"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\\\",\\\"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:08+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:24Z\",\n                \"finishedOn\": \"2025-08-20T16:27:09Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\\\",\\\"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\\\",\\\"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\\\",\\\"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\\\",\\\"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:33+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-41f380b8b18dfc660625bcbe6732775d9-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:01Z\",\n                \"finishedOn\": \"2025-08-20T16:27:34Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:27:34Z\",\n                \"finishedOn\": \"2025-08-20T16:27:42Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:50Z\",\n                \"finishedOn\": \"2025-05-08T19:54:54Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709479\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b95197\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:55Z\",\n                \"finishedOn\": \"2025-05-08T19:55:03Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:03Z\",\n                \"finishedOn\": \"2025-05-08T19:55:12Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:04Z\",\n                \"finishedOn\": \"2025-05-08T19:56:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:97ce660c7e669825a36bbc967def6b22e9c37dc9fbc12316bc9c080847a0c285\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:11:23Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:292b23d18b4c0f7cd0a60f78f0acfd6ede9805bfee1ad5541b0a0b30adf32318\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:26:40Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a@sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5cea1c3f55f83a338d6fbef56e445fd4dbf05533eb2fb8d065019c592e3b49d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:40Z\",\n                \"finishedOn\": \"2025-05-08T20:26:53Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\\\", \\\"image_digest\\\": \\\"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src@sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:02+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\":\\\"sha256:f9c280b76b78d6087165b22334b64642cb3778f312374fc2ea1b637c649bd683\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\":\\\"sha256:f161671b511f21dcd29853f57d7362b4984e792630c977ffdc674f717779ba72\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":127,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:32:58Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746736497\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:34:58Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-05-08T20:33:03+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":12,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:05Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:40+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:55Z\",\n                \"finishedOn\": \"2025-05-08T20:27:42Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:bd21f15d03f95d4df19f858d9df59cb089e012bfdd8d55d66bf71a77c05adc3d\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:01Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:38:31Z\",\n                \"finishedOn\": \"2025-05-08T20:38:39Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:6851c7f701a40a63193431a3dbda2095accdc40e03ecb66a6b1cebf8851f337b\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:58:04Z\",\n                \"finishedOn\": \"2025-09-04T07:01:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:57:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:08Z\",\n                \"finishedOn\": \"2025-08-20T15:47:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'sast-unicode-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:57+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:30Z\",\n                \"finishedOn\": \"2025-09-04T07:16:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\":\\\"sha256:d76c0eedd258d81cbcd9f7d6a2a76d351a266ed9a6936d6f40cc9e39f8c49c5d\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\":\\\"sha256:13c25e0934b40db9282eca16363c7683f7b9c20445400a47d39759688a12235c\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\":\\\"sha256:f5f55d8bfbba90a8694e95caf8191f9bd31e8e9e63f867ea5a5d6f87c334392d\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\":\\\"sha256:4bfa9df3c03380734e8daa664e6dd0c708ab0b0a70449dfeeba89ef3956f19c5\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\", \\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\", \\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:06:51+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:05:00+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:05:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:8bb311e95a187638c1fcb1ca9b38422f8a86763fcf4e447da092af125faa87f9\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:c7909d4d234c744060d8f2e245f40ba80b623a4282aad7d7be90f4ed7581effa\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b\\\",\\\"sha256:1d416eaa1ef456e4243d3372dc25a4c8820654a0a2b517edba4aecf9474489be\\\",\\\"sha256:8ddf267b9c37170a06465f93443f600bf470239e03c47f2c096d0f6d6e6e0d63\\\",\\\"sha256:d1cf2dc47b1c139e39bd1c34edd8c33d03ffbc42638526c8f48429294934555e\\\",\\\"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756390908\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:58Z\",\n                \"finishedOn\": \"2025-08-28T14:21:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:7c73e2beca9b8306387efeaf775831440ec799b05a5f5c008a65bb941a1e91f6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\":\\\"sha256:f9c280b76b78d6087165b22334b64642cb3778f312374fc2ea1b637c649bd683\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\":\\\"sha256:f161671b511f21dcd29853f57d7362b4984e792630c977ffdc674f717779ba72\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":127,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:32:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:cc8aa3bf9aa8c30f43bc52dae31ebcbcbe03f7364fe12dd0943e3c8fb584773a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:15Z\",\n                \"finishedOn\": \"2025-09-04T07:16:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:cd9ef1eb119700a6883edcf93fd7c71dc33ee43467f3c2728b2a002c77915e8d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-x86-64@sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:8677b6208188d42c75fdc20077a9bbddff07e09eb51c19a5a35f7052cd987a4a\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:03:54Z\",\n                \"finishedOn\": \"2025-08-28T18:05:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:cfcfa921e148610916faa22d962bbe414cb12431e99347638c1e2d92076ef2e3\",\n                    \"COMMIT_SHA\": \"d71ace743e1242424d1acc5ae04ea5c1293da095\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Dockerfiles/Dockerfile.konflux\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [\n                      \"version=v2.24.0\",\n                      \"io.openshift.tags=odh-operator\",\n                      \"url=https://github.com/red-hat-data-services/rhods-operator\",\n                      \"release=1756404032\",\n                      \"git.url=https://github.com/red-hat-data-services/rhods-operator\",\n                      \"git.commit=d71ace743e1242424d1acc5ae04ea5c1293da095\"\n                    ],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"{\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}\\n\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:216200a63475889d9ca17ef331322335f77ff17655add588b8b04c240297dc89\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:27+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:28:03Z\",\n                \"finishedOn\": \"2025-11-12T05:28:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:17+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:28:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:cfcfa921e148610916faa22d962bbe414cb12431e99347638c1e2d92076ef2e3\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'rhoai-init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\",\n                  \"params\": [\n                    {\n                      \"name\": \"url\",\n                      \"value\": \"https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n                    },\n                    {\n                      \"name\": \"revision\",\n                      \"value\": \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n                    },\n                    {\n                      \"name\": \"pathInRepo\",\n                      \"value\": \"konflux-tekton-tasks/rhoai-init/0.1/rhoai-init.yaml\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-model-controller-v2-24-on-push-6c64x|odh-model-controller-v2-24-on-push-6c64x> - 2025-08-27T18:37:11\\nStatus: Failed :failed:\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:07Z\",\n                \"finishedOn\": \"2025-08-27T18:37:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"expected-cluster\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rhoai-init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:09Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:2e2d1bafb57422191e4a181d2b365689dcf9c0786df355ca748c5ffb0632357a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:04:07Z\",\n                \"finishedOn\": \"2025-09-04T07:07:38Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:01bb6fd842fa4f3630f797161c4b0389e932fc8995c2cf1cdf62c17526f16f50\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:08:09Z\",\n                \"finishedOn\": \"2025-09-04T07:13:39Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:30fabdd7a3a66780e8ae4c4da0b97b5ce4812918c9a7cfd245e9b46b0e4f359d\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:09:09Z\",\n                \"finishedOn\": \"2025-09-04T07:15:22Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:606dd5b32ee93a3b733de7343e05cd910473425e24a808918fd8f977ac1358cd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:03:07Z\",\n                \"finishedOn\": \"2025-09-04T07:10:15Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:844e87596d4e75733b5863f5343a9fcb8ee28ba04835390e7a298a55da13303e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:23Z\",\n                \"finishedOn\": \"2025-09-04T07:17:38Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:47+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:48Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\":\\\"sha256:9f280cc0d2093d95dfba3a0a050fc39ed9977c7d829e6e389f08d6dcfad1f478\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\":\\\"sha256:28eaabd9496b4451a73b82ebd4106e9b5c856eaeb460244501650e361e4c66ef\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\":\\\"sha256:b4993c129faaf7ba0dcaf0aeeb7598ca6099ae3ff51087689875d65dc5086f41\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\":\\\"sha256:3f33e229bd14925b2b180d5c06e8301a134a7ab6ebf38c16c722ce100619d782\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:54+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:55Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970431\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:39Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\"\n              },\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:45+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:46Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:02Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:47Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:08f0413958c10027ce982f1d120c2377f7f0740643245567430226ac0bed6312\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:54Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\", \\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\", \\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\", \\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\", \\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:48+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:49Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:21:36Z\",\n                \"finishedOn\": \"2025-09-04T07:21:42Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T10:11:54Z\",\n                \"finishedOn\": \"2025-09-04T10:12:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:49Z\",\n                \"finishedOn\": \"2025-09-04T10:11:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"false\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"af380340b19d316a235576db78456f3f087b279e\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e@sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:8ecf57d5a6697ce709bee65b62781efe79a10b0c2b95e05576442b67fbd61744\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1749529764\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:43Z\",\n                \"finishedOn\": \"2025-06-10T04:29:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift/file-integrity-operator\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:844e87596d4e75733b5863f5343a9fcb8ee28ba04835390e7a298a55da13303e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:23Z\",\n                \"finishedOn\": \"2025-09-04T07:17:38Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"bb936a5\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:14Z\",\n                \"finishedOn\": \"2025-08-20T16:12:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-secrets-store-csi-driver-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:41:33Z\",\n                \"finishedOn\": \"2025-06-10T04:41:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'ecosystem-cert-preflight-checks' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:302828e9d7abc72b8a44fb2b9be068f86c982d8e5f4550b8bf654571d6361ee8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:33:25+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:33:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:47+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'sast-unicode-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:57:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:47+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:cfeeef2f4ab25b121afdf44eecc394ed67f3534a1bd14bef9e7beef2ee654b8e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:15214d7736224455f1f2782c05df3239d0145f5e7e900e9a1055ee421e31d62d\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:34:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"COMMIT_SHA\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"build/Dockerfile.openshift\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"LABELS\": [],\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:3411aeecdf045f8e61532abb88c28b7479cb8372420ac713f1f6756aa8fa843a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ef0c365378e0382400cfe0294fce5f2537b5eb934ebe67fc8addf45f67bc8a5c\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:36Z\",\n                \"finishedOn\": \"2025-11-12T05:26:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-arm64@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-ppc64le@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-s390x@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:57:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:04:53+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:04:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:20:39Z\",\n                \"finishedOn\": \"2025-08-20T16:20:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:386c8c3395b44f6eb927dbad72382808b0ae42008f183064ca77cb4cad998442\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749530486\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003b8c398ccebffee99100db698a83b77667\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"841e003\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"841e003b8c398ccebffee99100db698a83b77667:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-gcp-filestore-csi-driver-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"841e003b8c398ccebffee99100db698a83b77667\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970300\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'd2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:09Z\",\n                \"finishedOn\": \"2025-08-20T15:47:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'fbc-target-index-pruning-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:216200a63475889d9ca17ef331322335f77ff17655add588b8b04c240297dc89\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:27+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:28:03Z\",\n                \"finishedOn\": \"2025-11-12T05:28:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:cd9ef1eb119700a6883edcf93fd7c71dc33ee43467f3c2728b2a002c77915e8d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:609bf6cc9b31b872439a97dbf0172be95b88bfc1fb3572695863c91b77dae9b4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:47:19Z\",\n                \"finishedOn\": \"2025-08-27T17:48:56Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\",\n                    \"COMMIT_SHA\": \"5963a6cc76fa32879f860e9b2df35fa9428106a0\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Dockerfile.konflux\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [\n                      \"version=v2.24.0\",\n                      \"io.openshift.tags=odh-llm-d-inference-scheduler\",\n                      \"url=https://github.com/red-hat-data-services/llm-d-inference-scheduler\",\n                      \"release=1756315065\",\n                      \"git.url=https://github.com/red-hat-data-services/llm-d-inference-scheduler\",\n                      \"git.commit=5963a6cc76fa32879f860e9b2df35fa9428106a0\"\n                    ],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[\\n  {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"},\\n  {\\\"path\\\": \\\".\\\", \\\"type\\\": \\\"generic\\\"},\\n  {\\n    \\\"type\\\": \\\"rpm\\\",\\n    \\\"path\\\": \\\".\\\",\\n    \\\"include_summary_in_sbom\\\": true,\\n    \\\"options\\\": {\\n      \\\"dnf\\\": {\\n        \\\"epel\\\": {\\n          \\\"gpgcheck\\\": \\\"0\\\"\\n        }\\n      }\\n    }\\n  }\\n]\\n\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\\\",\\\"sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\\\",\\\"sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\\\",\\\"sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\\\",\\\"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:38+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8f6857c2c07792c823b8a9888ebaabd234066593a44c8aa5fb515946dc407199\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:4c62fdf3aad435bcf9dc3cab1bdda084454533ea132e7b46bf3b07b19b8503e9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:09:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:70881c97a4c51ee1f4d023fa1110e0bdfcfd2f51d9a261fa543c3862b9a4eee9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"ocp__4.17__ose-local-storage-rhel9-operator\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:02:33+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:02:35Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24@sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:c48af8bccc664777d2560fe0bd635a50fa00fa7e240de7c38c94e02c703704c0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:48:56Z\",\n                \"finishedOn\": \"2025-08-27T17:49:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"5963a6cc76fa32879f860e9b2df35fa9428106a0\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"IMAGES\": [\n                      \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'show-sbom' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:29:10Z\",\n                \"finishedOn\": \"2025-08-20T16:29:17Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:08+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4c4ac56711dd174d94f58757f584e40f9-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:29:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\",\n                    \"image-digest\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:3f89ba89cacf8547261b5ce064acce81bfe470c8ace127794d0e90aebc8c347d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"latest\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:eb8136b543147b4a3e88ca3cc661ca6a11e303f35f0db44059f69151beea8496\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:22+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:80a4562d5f86eb6812f00d4e30e94c1ad27ec937735dc29f5a63e9335676b3dc\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:32:55+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:56Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:eb8136b543147b4a3e88ca3cc661ca6a11e303f35f0db44059f69151beea8496\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:02+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:569165278e3c85e3b897abad9f6d714d76be4b061f44f5f7614ed1c83ad117b4\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:36Z\",\n                \"finishedOn\": \"2025-11-12T05:17:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'apply-tags' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:1f6e2c9beba52d21c562ba1dea55f579f67e33b80099615bfd2043864896284d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'prefetch-dependencies' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:d48c621ae828a3cbca162e12ec166210d2d77a7ba23b0e5d60c4a1b94491adeb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:22Z\",\n                \"finishedOn\": \"2025-05-08T19:13:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:f87c0cccd5a5906aab86b966a42847362c57198cf2e4c2e49b9376e65932b240\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"{\\\"type\\\": \\\"npm\\\"}\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:01+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:28:07Z\",\n                \"finishedOn\": \"2025-08-20T16:29:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:4bbacb8c18e9f13dd198b0e457b0737ad156e1dc53fb8b646745fb386e27283c\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:12:08Z\",\n                \"finishedOn\": \"2025-08-20T16:12:14Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:33Z\",\n                \"finishedOn\": \"2025-06-10T04:29:44Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1749529764\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:0ca59eda137e229be4ca03be8d742fdfcc35e58747c48168b47a9379aa4e9139\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:44Z\",\n                \"finishedOn\": \"2025-06-10T04:30:00Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:2dc676423439af7d423310e3374fc94b606809ada67893590906536109614efc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:1b0d61ee77524d80b519e7afc9f897c4167bc833786bd70628a9d887b5c2abf9\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:30:01Z\",\n                \"finishedOn\": \"2025-06-10T04:31:30Z\"\n              },\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336@sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:f9b033053bc51b15a705c52d94308c50b2a9d21bc57cdeb75ac14212eb8bd2f2\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:31:30Z\",\n                \"finishedOn\": \"2025-06-10T04:32:29Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:29Z\",\n                \"finishedOn\": \"2025-06-10T04:32:47Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": false, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:sha256-3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335.src\\\", \\\"image_digest\\\": \\\"sha256:16573c9130c583d548cb80cfb444537fc5767b3647cb042d5513551f98b91221\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:sha256-3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335.src@sha256:16573c9130c583d548cb80cfb444537fc5767b3647cb042d5513551f98b91221\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:16573c9130c583d548cb80cfb444537fc5767b3647cb042d5513551f98b91221\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:sha256-3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:33:08Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:32:54+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:32:54Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\":\\\"sha256:6c553e4b7971b4a358040f8590e28aea0b713d7824646cd03415783334a4ffc8\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:32:58Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:33:25+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:33:27Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:32:59+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:33:00Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749529986\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:33:09Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:57Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:bced27c2e2670c7139bd8b1cf8fda441ea4fce9048b7ad623062995df9cbde83\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:57Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:32:55+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:56Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:33:27Z\",\n                \"finishedOn\": \"2025-06-10T04:33:34Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:462ecbf94ec44a8b770d6ef8838955f91f57ee79795e5c18bdc0fcb0df593742\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755@sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:976058e10b643ac4df6aa99e1090a74ba305e11dd660d4336d6f2710f53c7ff0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:20:51Z\",\n                \"finishedOn\": \"2025-05-08T19:21:13Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\",\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"cb97d5cc085827e8c70da890248b8c8044886ddbbfeddca6ad391172f913f6cb\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:80a4562d5f86eb6812f00d4e30e94c1ad27ec937735dc29f5a63e9335676b3dc\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\", \\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\", \\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\", \\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 329, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:19+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:25:21Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:08Z\",\n                \"finishedOn\": \"2025-08-20T15:47:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:9c95b1fe17db091ae364344ba2006af46648e08486eef1f6fe1b9e3f10866875\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336@sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:5ac20d525495a4d6d449da38763187a47edb291acd70efa1dbbd8a14f75d8048\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:39Z\",\n                \"finishedOn\": \"2025-06-10T04:39:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\",\n                      \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\",\n                      \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:46:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:18+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:25:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:dea8d9b4bec3e99d612d799798acf132df48276164b5193ea68f9f3c25ae425b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746736497\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:34:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:46:59Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad213d00cdcff677600177ba5ce759582a9e\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad213d00cdcff677600177ba5ce759582a9e\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad2\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:00Z\",\n                \"finishedOn\": \"2025-08-20T15:47:08Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:09Z\",\n                \"finishedOn\": \"2025-08-20T15:47:15Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cc04739e04597e94b2875bc33b1b73c57327c13f0c08ec17b2abfdc4ae7a0381\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:48:57Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:407cc022f795b6ce1fa97742f7b20d907d03fae9539007a546bf01aee2854fa5\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:57:18Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:80f8063b46942befb866456d4e4bb81d1ab4f8eb053e5ee4ebfb21ffc57e6952\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T16:05:11Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d222a6ca86763263a6d927d9e76716a40360f8ba20506d075adb1d660495b1e8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:53:17Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201@sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:242ee6754755392a4268ee306a4a744f0522364261e4bf0c24db4f27c7da55ce\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:12Z\",\n                \"finishedOn\": \"2025-08-20T16:05:30Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:41+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:05:43Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:41+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:05:44Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:05:39Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:05:38Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:06:49+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f68dae6edc2eea0c5c3f32f45d6c543f11773f9310f795a9d76b4470ad3df240\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c50a84a71b96609cc39cfa33e6e5c1379b47cf9be3a756ba28c1aa8049a7ca2d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:06:53Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:07:42+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:06:54Z\",\n                \"finishedOn\": \"2025-08-20T16:07:43Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:10:40+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-sriov-network-operator-bfph6-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:10:41Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:10:41Z\",\n                \"finishedOn\": \"2025-08-20T16:10:48Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:31Z\",\n                \"finishedOn\": \"2025-08-20T16:11:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:165466d072eb611cd5306982785ef6f6e646fb0e18c70c19e7d78cd49cd1867f\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:52Z\",\n                \"finishedOn\": \"2025-08-20T16:13:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"78f88369280abadef5251ec5434ffc59c84aca41\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:07:42+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:06:54Z\",\n                \"finishedOn\": \"2025-08-20T16:07:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:c50a84a71b96609cc39cfa33e6e5c1379b47cf9be3a756ba28c1aa8049a7ca2d\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970300\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src\\\", \\\"image_digest\\\": \\\"sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src@sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:sha256-9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:e206be2ffdfec6787d6a8284c98236a4820493131055509ee7a15a8646ba2189\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:22Z\",\n                \"finishedOn\": \"2025-09-04T07:16:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:04:53+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:04:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:ade0bf9c2e9c169f588fbfe71fb489c2f7053fe41884e7969f270b317d9eb548\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:50Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:11+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:25:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'build-source-image' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:05+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:38Z\",\n                \"finishedOn\": \"2025-09-04T07:17:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\", \\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\", \\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\", \\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\", \\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970376\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:36+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:cd9ef1eb119700a6883edcf93fd7c71dc33ee43467f3c2728b2a002c77915e8d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64@sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:1121616d63bfb4a0e095da229e9678f28eaf2dec4c092d2f0f202b83a8d4093e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:13:44Z\",\n                \"finishedOn\": \"2025-08-28T14:15:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:8901482c90f5fe9fc413df7ca2d47f2142ab481794182e0a4220eb25e31348f6\",\n                    \"COMMIT_SHA\": \"ec79b74a364e0ce075d4c6074e9aa4a62c32b66f\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Dockerfile.konflux\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [\n                      \"version=v2.24.0\",\n                      \"io.openshift.tags=odh-model-controller\",\n                      \"url=https://github.com/red-hat-data-services/odh-model-controller\",\n                      \"release=1756390301\",\n                      \"git.url=https://github.com/red-hat-data-services/odh-model-controller\",\n                      \"git.commit=ec79b74a364e0ce075d4c6074e9aa4a62c32b66f\"\n                    ],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"{\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:89197c6c3e5686b5dca8b4c6e1e604d575197ca61ef21765630ed8d32fd4085f\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:cc8aa3bf9aa8c30f43bc52dae31ebcbcbe03f7364fe12dd0943e3c8fb584773a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:15Z\",\n                \"finishedOn\": \"2025-09-04T07:16:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'sast-unicode-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:11:23+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:24Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:10:40+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-sriov-network-operator-bfph6-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:10:41Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\",\n                    \"image-digest\": \"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'git+https://github.com/red-hat-data-services/konflux-central.git' and commit '3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"git+https://github.com/red-hat-data-services/konflux-central.git\",\n              \"digest\": {\n                \"sha1\": \"3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/konflux-central.git\"\n    material.digest.sha1 == \"3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:28:15+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:a0fef942d6e2cb389682022787d04793e8c91641158f3ee79714e0a0afd9e6be\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2f141d7a86810552598b39ad161836d01d51d32e8f6aa5667c29ff76d4279f42\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:28:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:404f3bb83d250b75d7246db21a6bb8f09ba9f307ba781d448ac6825baae1ad4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:04+00:00\\\",\\\"note\\\":\\\"Task coo-fbc-v4-20-on-push-m26gh-fbc-fips-check-oci-ta failed: Could not render unreleased bundle image: registry.redhat.io/cluster-observability-operator/cluster-observability-operator-bundle@sha256:04d900c45998f21ccf96af1ba6b8c7485d13c676ca365d70b491f7dcc48974ac. Make sure the image is accessible or a mirror is provided for the same in images-mirror-set.yaml\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:58Z\",\n                \"finishedOn\": \"2025-11-12T05:28:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"image-digest\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\", \\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\", \\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\", \\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\", \\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T14:21:12+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:58Z\",\n                \"finishedOn\": \"2025-08-28T14:38:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:8901482c90f5fe9fc413df7ca2d47f2142ab481794182e0a4220eb25e31348f6\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:89197c6c3e5686b5dca8b4c6e1e604d575197ca61ef21765630ed8d32fd4085f\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:165466d072eb611cd5306982785ef6f6e646fb0e18c70c19e7d78cd49cd1867f\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:52Z\",\n                \"finishedOn\": \"2025-08-20T16:13:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"78f88369280abadef5251ec5434ffc59c84aca41\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:70881c97a4c51ee1f4d023fa1110e0bdfcfd2f51d9a261fa543c3862b9a4eee9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:25:01Z\",\n                \"finishedOn\": \"2025-08-20T16:25:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"ocp__4.17__ose-vertical-pod-autoscaler-rhel9-operator\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:08:46+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:08:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bbcb490945b612c00359b666ec4dc94fab1f4e767c6922a3b4a4ab57d3301d30\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:02:33+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:02:35Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:9a6ec5575f80668552d861e64414e736c85af772c272ca653a6fd1ec841d2627\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List tasks with status 'Succeeded'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:11Z\",\n                \"finishedOn\": \"2025-08-20T16:10:17Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:18Z\",\n                \"finishedOn\": \"2025-08-20T16:10:27Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:27Z\",\n                \"finishedOn\": \"2025-08-20T16:10:33Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:61155ff6bed089dac26df0ce1e1a781dc87329901bb2365c9d753110cd7b980d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:12:08Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5faec9d73b9403e7e121c89506a574e6c4fa245a030c92f4632b3e6fca91e5e0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:17:26Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1f06919168bb568caa5b6af9551ff9df3220f8c06df7d4df08e98f12013d8148\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:26:25Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:45df64587108fc9760add8e916599c10966183fdb59c10420bb1f1cc691ed513\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:16:30Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201@sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fec028d5a057d15cfe62ed95ff25942f005b4c025f4641061b37a351db95945c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:26Z\",\n                \"finishedOn\": \"2025-08-20T16:26:43Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:53+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:55Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:53+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:55Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:05+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:27:06Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:26:50Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:28:04+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:27372c86dc682a07262abf62e2747bdbc60ca983e431d585058ac864c3543ebd\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:4bbacb8c18e9f13dd198b0e457b0737ad156e1dc53fb8b646745fb386e27283c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:28:07Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:01+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:28:07Z\",\n                \"finishedOn\": \"2025-08-20T16:29:02Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:08+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4c4ac56711dd174d94f58757f584e40f9-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:29:09Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:29:10Z\",\n                \"finishedOn\": \"2025-08-20T16:29:17Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "tasks_with_status := [task |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.status == \"Succeeded\"\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:10Z\",\n                \"finishedOn\": \"2025-09-04T10:11:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:3f89ba89cacf8547261b5ce064acce81bfe470c8ace127794d0e90aebc8c347d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"latest\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:56fa2cbfc04bad4765b7fe1fa8022587f4042d4e8533bb5f65311d46b43226ee\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\\\", \\\"image_digest\\\": \\\"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src@sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:22:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:26+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'coverity-availability-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:45+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:20:38+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4bc9ae76a0fbf4007c76523772379720c-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:20:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0aa298cea5d3d7361eaf5e61c2bbe49bd3bf75c3c62cc9ffbc83746707a71ef8\",\n                    \"image-digest\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3603ebb13fb7baad990d03ff10e4fad8405e81c683fbd1f316584477637ba9c9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:12:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:61155ff6bed089dac26df0ce1e1a781dc87329901bb2365c9d753110cd7b980d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:34Z\",\n                \"finishedOn\": \"2025-08-20T16:12:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\", \\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\", \\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\", \\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\", \\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:48+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'prefetch-dependencies' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:569165278e3c85e3b897abad9f6d714d76be4b061f44f5f7614ed1c83ad117b4\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:36Z\",\n                \"finishedOn\": \"2025-11-12T05:17:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:302828e9d7abc72b8a44fb2b9be068f86c982d8e5f4550b8bf654571d6361ee8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:4c2b0a2d2904108f8d19edfa878df6cd49ed19aab73ab6fc6a435fba0265f771\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:eb8136b543147b4a3e88ca3cc661ca6a11e303f35f0db44059f69151beea8496\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:02+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:42+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:e371aa09c65ab309138b4aeae9ea4dd93f83119c5cc61e9f2057fe5bb518fbe9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:3411aeecdf045f8e61532abb88c28b7479cb8372420ac713f1f6756aa8fa843a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ef0c365378e0382400cfe0294fce5f2537b5eb934ebe67fc8addf45f67bc8a5c\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:36Z\",\n                \"finishedOn\": \"2025-11-12T05:26:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-arm64@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-ppc64le@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-s390x@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e03db91ca0204e1e227a0213b2831ce8a6739cb2eef6d249f63a1ead72042b3'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e03db91ca0204e1e227a0213b2831ce8a6739cb2eef6d249f63a1ead72042b3\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e03db91ca0204e1e227a0213b2831ce8a6739cb2eef6d249f63a1ead72042b3\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:22:23+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:edd8c34cca5f98da6079eed090a2c2c3981cd5b576add4fce8c37e8515026c53\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0150cab600b59e5382cb28b1e6c1c130c7638b319b3cc8c43f07801daec0bf5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:22:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:11+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:25:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\\\",\\\"sha256:9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\\\",\\\"sha256:8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\\\",\\\"sha256:57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\\\",\\\"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3dbcca8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bbcb490945b612c00359b666ec4dc94fab1f4e767c6922a3b4a4ab57d3301d30\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:59Z\",\n                \"finishedOn\": \"2025-08-20T15:47:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-aws-efs-csi-driver-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:cd9ef1eb119700a6883edcf93fd7c71dc33ee43467f3c2728b2a002c77915e8d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64@sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:609bf6cc9b31b872439a97dbf0172be95b88bfc1fb3572695863c91b77dae9b4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:47:19Z\",\n                \"finishedOn\": \"2025-08-27T17:48:56Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\",\n                    \"COMMIT_SHA\": \"5963a6cc76fa32879f860e9b2df35fa9428106a0\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Dockerfile.konflux\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [\n                      \"version=v2.24.0\",\n                      \"io.openshift.tags=odh-llm-d-inference-scheduler\",\n                      \"url=https://github.com/red-hat-data-services/llm-d-inference-scheduler\",\n                      \"release=1756315065\",\n                      \"git.url=https://github.com/red-hat-data-services/llm-d-inference-scheduler\",\n                      \"git.commit=5963a6cc76fa32879f860e9b2df35fa9428106a0\"\n                    ],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[\\n  {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"},\\n  {\\\"path\\\": \\\".\\\", \\\"type\\\": \\\"generic\\\"},\\n  {\\n    \\\"type\\\": \\\"rpm\\\",\\n    \\\"path\\\": \\\".\\\",\\n    \\\"include_summary_in_sbom\\\": true,\\n    \\\"options\\\": {\\n      \\\"dnf\\\": {\\n        \\\"epel\\\": {\\n          \\\"gpgcheck\\\": \\\"0\\\"\\n        }\\n      }\\n    }\\n  }\\n]\\n\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clair-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\":\\\"sha256:d76c0eedd258d81cbcd9f7d6a2a76d351a266ed9a6936d6f40cc9e39f8c49c5d\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\":\\\"sha256:13c25e0934b40db9282eca16363c7683f7b9c20445400a47d39759688a12235c\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\":\\\"sha256:f5f55d8bfbba90a8694e95caf8191f9bd31e8e9e63f867ea5a5d6f87c334392d\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\":\\\"sha256:4bfa9df3c03380734e8daa664e6dd0c708ab0b0a70449dfeeba89ef3956f19c5\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T10:12:02+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:54Z\",\n                \"finishedOn\": \"2025-09-04T10:12:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:49+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:39Z\",\n                \"finishedOn\": \"2025-08-20T16:16:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:22290579c9fe0b5c1689bb9023b3eddec73c285b680226d9f460346ae849a2cb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:52Z\",\n                \"finishedOn\": \"2025-08-28T18:30:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:50Z\",\n                \"finishedOn\": \"2025-05-08T19:54:54Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709479\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b95197\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:55Z\",\n                \"finishedOn\": \"2025-05-08T19:55:03Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:03Z\",\n                \"finishedOn\": \"2025-05-08T19:55:12Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:04Z\",\n                \"finishedOn\": \"2025-05-08T19:56:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:97ce660c7e669825a36bbc967def6b22e9c37dc9fbc12316bc9c080847a0c285\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:11:23Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:292b23d18b4c0f7cd0a60f78f0acfd6ede9805bfee1ad5541b0a0b30adf32318\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:26:40Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a@sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5cea1c3f55f83a338d6fbef56e445fd4dbf05533eb2fb8d065019c592e3b49d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:40Z\",\n                \"finishedOn\": \"2025-05-08T20:26:53Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\\\", \\\"image_digest\\\": \\\"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src@sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:02+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\":\\\"sha256:f9c280b76b78d6087165b22334b64642cb3778f312374fc2ea1b637c649bd683\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\":\\\"sha256:f161671b511f21dcd29853f57d7362b4984e792630c977ffdc674f717779ba72\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":127,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:32:58Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746736497\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:34:58Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-05-08T20:33:03+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":12,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:05Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:40+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:55Z\",\n                \"finishedOn\": \"2025-05-08T20:27:42Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:bd21f15d03f95d4df19f858d9df59cb089e012bfdd8d55d66bf71a77c05adc3d\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:01Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:38:31Z\",\n                \"finishedOn\": \"2025-05-08T20:38:39Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:12:08Z\",\n                \"finishedOn\": \"2025-08-20T16:12:14Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:8f73fd977807d4e3dc322814b7f8d7c4b66da457ddb664a4f91c21244b91df9d\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:46:59Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a2b365ba325033f584af47d21d30570270\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a2b365ba325033f584af47d21d30570270\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:09Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:11Z\",\n                \"finishedOn\": \"2025-08-20T15:47:18Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aa7dbc99bc11ba86e8723415cdc22d5b65b472b19bc8ccf16414facf73df224c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:48:56Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:59f574be8f47c105edda9ee78ba2bd93fd74e760bf9d5249ec38e4ff323fc358\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:07:41Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:09360843ae1870edd46c130067ba6eb02f8bfa3b9556d43735f38d3a216c7412\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T16:20:56Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3638aafc7f3d46baf90e241674a41bb4ebfd33ec0d5ede91afac11d767039c23\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:53:16Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3929cb325ba4f300236ba8ae08080c21b42e21107c03f8ec34d11eb7a04d92ad\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:20:56Z\",\n                \"finishedOn\": \"2025-08-20T16:21:13Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:24+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:14Z\",\n                \"finishedOn\": \"2025-08-20T16:21:25Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:24+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:26Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:38+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:39Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:19Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:22:22+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:36728f08e76b74e554cddc19750e6150b04705b4b7f4f31f2eaa31a3326d2a89\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2b5ace1b5ec0e701a1436a8d52c38f4da58abb5e5a07322337e621e405559c28\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:22:28Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:23:14+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:22:29Z\",\n                \"finishedOn\": \"2025-08-20T16:23:16Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:12+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-498ed3ee079b788233f6e21fc8ea128a1-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:25:13Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:25:13Z\",\n                \"finishedOn\": \"2025-08-20T16:25:21Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:52Z\",\n                \"finishedOn\": \"2025-08-20T15:46:58Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d692\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:59Z\",\n                \"finishedOn\": \"2025-08-20T15:47:07Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:08Z\",\n                \"finishedOn\": \"2025-08-20T15:47:15Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aa344aaa6ba1be9a1c0053107f30da40cd04d7609627948789ce5c43b7ffeef4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:48:54Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aff428f2069bfeded72e06af53b07797d038e3b84158e695f0ac9c11549232fa\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:57:46Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0979f1ba1040d38c21e11f3829216c51113e1e580605830a0f637bf8e22e9d22\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T16:15:16Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:77544ebfc96829087a087e8f565dd4c24e3bfdba721cfdbe40583a254f166221\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:53:11Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201@sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f1caf0f8195b2db72f5451315a5ab0cf45b1aaf0cc4e2d7704ca6db7c6b944f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:16Z\",\n                \"finishedOn\": \"2025-08-20T16:15:33Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:42+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:44Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:43+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:45Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:42+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:43Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:42Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:52+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c94e55805faf1bcac2916f9f044cb0ae3b98c33f0248e1de0397d6560a418d0e\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0f42ac97c44f0f0b4c704f64e26b6d1390de485a62bb48aba051de4d72e81f4c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:16:57Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:17:41+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:57Z\",\n                \"finishedOn\": \"2025-08-20T16:17:42Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:19:19+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-ptp-operator-m58j2-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:19:20Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:19:20Z\",\n                \"finishedOn\": \"2025-08-20T16:19:28Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:50Z\",\n                \"finishedOn\": \"2025-05-08T19:54:54Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709479\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b95197\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:55Z\",\n                \"finishedOn\": \"2025-05-08T19:55:03Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:03Z\",\n                \"finishedOn\": \"2025-05-08T19:55:12Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:04Z\",\n                \"finishedOn\": \"2025-05-08T19:56:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:97ce660c7e669825a36bbc967def6b22e9c37dc9fbc12316bc9c080847a0c285\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:11:23Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:292b23d18b4c0f7cd0a60f78f0acfd6ede9805bfee1ad5541b0a0b30adf32318\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:26:40Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a@sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5cea1c3f55f83a338d6fbef56e445fd4dbf05533eb2fb8d065019c592e3b49d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:40Z\",\n                \"finishedOn\": \"2025-05-08T20:26:53Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\\\", \\\"image_digest\\\": \\\"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src@sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:02+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\":\\\"sha256:f9c280b76b78d6087165b22334b64642cb3778f312374fc2ea1b637c649bd683\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\":\\\"sha256:f161671b511f21dcd29853f57d7362b4984e792630c977ffdc674f717779ba72\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":127,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:32:58Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746736497\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:34:58Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-05-08T20:33:03+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":12,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:05Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:40+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:55Z\",\n                \"finishedOn\": \"2025-05-08T20:27:42Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:bd21f15d03f95d4df19f858d9df59cb089e012bfdd8d55d66bf71a77c05adc3d\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:01Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:38:31Z\",\n                \"finishedOn\": \"2025-05-08T20:38:39Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:3411aeecdf045f8e61532abb88c28b7479cb8372420ac713f1f6756aa8fa843a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a, quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:ef0c365378e0382400cfe0294fce5f2537b5eb934ebe67fc8addf45f67bc8a5c\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:36Z\",\n                \"finishedOn\": \"2025-11-12T05:26:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-arm64@sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-ppc64le@sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\",\n                      \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-s390x@sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:dea8d9b4bec3e99d612d799798acf132df48276164b5193ea68f9f3c25ae425b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746732115\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:70881c97a4c51ee1f4d023fa1110e0bdfcfd2f51d9a261fa543c3862b9a4eee9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"ocp__4.17__ingress-node-firewall-rhel9-operator\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:30:00Z\",\n                \"finishedOn\": \"2025-08-20T16:30:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'd2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:08Z\",\n                \"finishedOn\": \"2025-08-20T16:12:14Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:10:40+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:09:58Z\",\n                \"finishedOn\": \"2025-08-20T16:10:41Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:97a415fdb87e02d927c380da3cf0062c9be50185e37235ac6e0bdfd41583a01e\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:7e7446e238976c3832d1e26feee86f92a43836808a7153a587cf22804a0e2e8a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"rhoai-2.24-a20675aa9508dd931c05a0d76d221916c737e85a\",\n                      \"rhoai-2.24-nightly\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:3f89ba89cacf8547261b5ce064acce81bfe470c8ace127794d0e90aebc8c347d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"latest\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:ea64f5b99202621e78ed3d74b00df5750cbf572c391e6da1956396f5945e4e11\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://gitlab.com/redhat/hummingbird/containers\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1763544424\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"001e77d\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://gitlab.com/redhat/hummingbird/containers\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:464282534bb5c2384429cca983cdae44b8a53d1b96e02cc055e85cbd6b240ee5\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:01:02Z\",\n                \"finishedOn\": \"2025-11-19T18:01:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"5d\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodule\": \"true\",\n                    \"submodulePaths\": \"\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://gitlab.com/redhat/hummingbird/containers\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:846e52e4a14da403fa0cbd0251eab8248ab9230372c96f0566068ed1ccac5c66\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:97ce660c7e669825a36bbc967def6b22e9c37dc9fbc12316bc9c080847a0c285\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:11:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \".tekton/downstream-build-arguments.conf\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"COMMIT_SHA\": \"3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"LABELS\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ],\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[{\\\"type\\\": \\\"pip\\\", \\\"requirements_files\\\": [\\\"lockfiles/requirements.txt\\\"], \\\"requirements_build_files\\\": [\\\"lockfiles/requirements-build.txt\\\"]}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"lockfiles\\\"}, {\\\"type\\\": \\\"generic\\\", \\\"path\\\": \\\"lockfiles\\\"}]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:ecd33669676b3a193ff4c2c6223cb912cc1b0cf5cc36e080eaec7718500272cf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:03+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:13+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:cfcfa921e148610916faa22d962bbe414cb12431e99347638c1e2d92076ef2e3\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T19:23:36Z\",\n                \"finishedOn\": \"2025-05-08T19:23:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:57b3262138eb06186ae7375f84ca53788bba2a66cfd03d39cb82c78df050aba5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:31294d9b2cc4f1f608ac5f9b194b9488616cade52836f28ba611604c724375f6\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:18Z\",\n                \"finishedOn\": \"2025-08-20T15:48:56Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bbcb490945b612c00359b666ec4dc94fab1f4e767c6922a3b4a4ab57d3301d30\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aa7dbc99bc11ba86e8723415cdc22d5b65b472b19bc8ccf16414facf73df224c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:48:56Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"0df535a2b365ba325033f584af47d21d30570270\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'sast-shell-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:5d0d9cc31381c5ef4093c7800e0528cda1d07d5db2d7ae733132e54870bb2dbc\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src\\\", \\\"image_digest\\\": \\\"sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src@sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:381987bc72b77393d3ddba058d4e2816bda0d0d5ac5dbec7aba1d2d04223098d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:59Z\",\n                \"finishedOn\": \"2025-08-20T16:16:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"841e003b8c398ccebffee99100db698a83b77667\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:2e2d1bafb57422191e4a181d2b365689dcf9c0786df355ca748c5ffb0632357a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:04:07Z\",\n                \"finishedOn\": \"2025-09-04T07:07:38Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"manager/Containerfile.manager\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:22290579c9fe0b5c1689bb9023b3eddec73c285b680226d9f460346ae849a2cb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:cfcfa921e148610916faa22d962bbe414cb12431e99347638c1e2d92076ef2e3\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:02:54Z\",\n                \"finishedOn\": \"2025-08-28T18:03:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:ac00b0e2e04c0aeb1050529a5e82ad87756b0e1613486def9bc9496f8dee80e4\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"{\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}\\n\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b, quay.io/rhoai/odh-model-controller-rhel9@sha256:1d416eaa1ef456e4243d3372dc25a4c8820654a0a2b517edba4aecf9474489be, quay.io/rhoai/odh-model-controller-rhel9@sha256:8ddf267b9c37170a06465f93443f600bf470239e03c47f2c096d0f6d6e6e0d63, quay.io/rhoai/odh-model-controller-rhel9@sha256:d1cf2dc47b1c139e39bd1c34edd8c33d03ffbc42638526c8f48429294934555e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24@sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:00d3cbee63dc0a7f1a1d3d9bf7ef01466fb17ab02ae3f2bd7c9aecc3fbf46251\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:42Z\",\n                \"finishedOn\": \"2025-08-28T14:20:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"ec79b74a364e0ce075d4c6074e9aa4a62c32b66f\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"IMAGES\": [\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64@sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-ppc64le@sha256:1d416eaa1ef456e4243d3372dc25a4c8820654a0a2b517edba4aecf9474489be\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-s390x@sha256:8ddf267b9c37170a06465f93443f600bf470239e03c47f2c096d0f6d6e6e0d63\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-m2xlarge-arm64@sha256:d1cf2dc47b1c139e39bd1c34edd8c33d03ffbc42638526c8f48429294934555e\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:36+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5444626147a79bf9c621ec72e18a9eea5dcbaaaac35059063a71a5edfbf2c406\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:19Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'generate-version-labels' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:23Z\",\n                \"finishedOn\": \"2025-05-08T19:13:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:f87c0cccd5a5906aab86b966a42847362c57198cf2e4c2e49b9376e65932b240\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"generate-version-labels\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:6b42b39c3854c5bb9555c0c36c41e4295ee4dd403a4fbc08d72fb91f4657b9f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:33:27Z\",\n                \"finishedOn\": \"2025-06-10T04:33:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'rpms-signature-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\", \\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\", \\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\", \\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\", \\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:18:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:404f3bb83d250b75d7246db21a6bb8f09ba9f307ba781d448ac6825baae1ad4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:04+00:00\\\",\\\"note\\\":\\\"Task coo-fbc-v4-20-on-push-m26gh-fbc-fips-check-oci-ta failed: Could not render unreleased bundle image: registry.redhat.io/cluster-observability-operator/cluster-observability-operator-bundle@sha256:04d900c45998f21ccf96af1ba6b8c7485d13c676ca365d70b491f7dcc48974ac. Make sure the image is accessible or a mirror is provided for the same in images-mirror-set.yaml\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:58Z\",\n                \"finishedOn\": \"2025-11-12T05:28:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"image-digest\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:893ffa3ce26b061e21bb4d8db9ef7ed4ddd4044fe7aa5451ef391034da3ff759\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\":\\\"sha256:c3b730b7fa2b7268029170878a200287c70bd0b7516aae9d19142ded3290cf1c\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\":\\\"sha256:e875d09bd5e4d936d09c9f32cbb3b203864c6e621c7d321ba643d7be4aa47bd2\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\":\\\"sha256:81c5a04c66b19dbf35ff40398f8d8ba5675564d8002a10ad896b0ae0b39e4b03\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\":\\\"sha256:fd591941c94f0a17e87d1736bfda4f04f5c91fdccce3e76f73088807857df839\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:12:16+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:12:17Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:46Z\",\n                \"finishedOn\": \"2025-08-20T16:11:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-bundle-v2-24-on-schedule-vqxk9|odh-operator-bundle-v2-24-on-schedule-vqxk9> - 2025-08-28T18:30:06\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:00Z\",\n                \"finishedOn\": \"2025-08-28T18:30:06Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:07Z\",\n                \"finishedOn\": \"2025-08-28T18:30:14Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756405785\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575f\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:43Z\",\n                \"finishedOn\": \"2025-08-28T18:30:52Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:52Z\",\n                \"finishedOn\": \"2025-08-28T18:30:59Z\"\n              },\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24@sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:62807ed275ab2095195c390d662896e2e383a0cba6aecc96a1432c38ae461354\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:59Z\",\n                \"finishedOn\": \"2025-08-28T18:31:26Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:26Z\",\n                \"finishedOn\": \"2025-08-28T18:31:32Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": false, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/rhoai/odh-operator-bundle:sha256-eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c.src\\\", \\\"image_digest\\\": \\\"sha256:93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c.src@sha256:93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:46Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:53+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:58Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:45+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:48:49Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check success: No base images to check.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:39Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\":\\\"sha256:f4b62c4f4a7f816b42d47cbe077109e127461e2e13774398adbcf8ecb8f15240\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:43Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:32:11+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:32:13Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:44+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta success: Snyk code test found zero supported files.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:33Z\",\n                \"finishedOn\": \"2025-08-28T18:31:45Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756405912\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:55Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:41Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:12b985bec985945a920297c6951e8590493c735e33d40e73e919bbcb7f7443dc\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:33Z\",\n                \"finishedOn\": \"2025-08-28T18:31:47Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:51+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:33Z\",\n                \"finishedOn\": \"2025-08-28T18:31:52Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-28T18:48:49Z\",\n                \"finishedOn\": \"2025-08-28T18:48:56Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-28T18:48:56Z\",\n                \"finishedOn\": \"2025-08-28T18:49:02Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:59094118aa07d5b0199565c4e0b2d0f4feb9a4741877c8716877572e2c4804f9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746732213\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:sha256-38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347.src\\\", \\\"image_digest\\\": \\\"sha256:6e8b20cf07b5b718aa540bd41dc55cd5765d67e95cc3d988dcf80ac480f24639\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347.src@sha256:6e8b20cf07b5b718aa540bd41dc55cd5765d67e95cc3d988dcf80ac480f24639\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6e8b20cf07b5b718aa540bd41dc55cd5765d67e95cc3d988dcf80ac480f24639\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:58Z\",\n                \"finishedOn\": \"2025-08-28T14:21:45Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:8901482c90f5fe9fc413df7ca2d47f2142ab481794182e0a4220eb25e31348f6\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:89197c6c3e5686b5dca8b4c6e1e604d575197ca61ef21765630ed8d32fd4085f\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:e371aa09c65ab309138b4aeae9ea4dd93f83119c5cc61e9f2057fe5bb518fbe9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:3f89ba89cacf8547261b5ce064acce81bfe470c8ace127794d0e90aebc8c347d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"latest\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:21:36Z\",\n                \"finishedOn\": \"2025-09-04T07:21:42Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:2e2d1bafb57422191e4a181d2b365689dcf9c0786df355ca748c5ffb0632357a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:04:07Z\",\n                \"finishedOn\": \"2025-09-04T07:07:38Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"manager/Containerfile.manager\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:56fa2cbfc04bad4765b7fe1fa8022587f4042d4e8533bb5f65311d46b43226ee\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\\\", \\\"image_digest\\\": \\\"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src@sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:35+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T19:04:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:0da734a811d57810f80202cceb2d79051d1de150f39f7689c5415f655598d62f\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:298c8a06c501915e7038d45aa91d7172815d0a00d538785401504f90bc82ca8d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"9553a0254dbab514fe775a168d48aef8f0cd26d0\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"9553a0254dbab514fe775a168d48aef8f0cd26d0\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"9553a02\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:02Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:12Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2c34868bb9c35b85a64500dec9fefc4fba3e7be1f9ce0afdd14ec8e88d8f0d0c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:21Z\",\n                \"finishedOn\": \"2025-08-20T15:49:05Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:657186b77054955672f83e64c692c83ba482b32c1356851f70241751513b9c78\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T15:59:04Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:54f721e8889b41f8fa596baa4744bcd6ce97e302c6177f2dbe7840579e298818\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T16:02:07Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fe457235261444e878cc9708fa5325de018ffbf4da0cf6b76e5af57f1cd209fb\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T15:53:50Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201@sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:654d1f24c1be3d27a25e1e649a24ea5afbc96096a11c912bc310206451a6f979\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:07Z\",\n                \"finishedOn\": \"2025-08-20T16:02:23Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:02:33+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:02:35Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:02:34+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:02:37Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:02:32+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:02:33Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:02:30Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:03:55+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:90d1fffc3be16350cfa31d671a4fdfc8b1664728196a603920033669e870732b\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f2260146ed573a6dbf4fb5d45f75ef567744a7d7785835547b705b9e5a6cf357\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:24Z\",\n                \"finishedOn\": \"2025-08-20T16:04:00Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:04:56+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:04:00Z\",\n                \"finishedOn\": \"2025-08-20T16:04:57Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:22+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-dpu-operator-9rmqb-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:05:23Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:05:23Z\",\n                \"finishedOn\": \"2025-08-20T16:05:30Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git' and commit '19a01971a39db7e50c40e6db8405dfa957eec70b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-v2-24-on-schedule-sps5p|odh-operator-v2-24-on-schedule-sps5p> - 2025-08-27T19:56:02\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:55:58Z\",\n                \"finishedOn\": \"2025-08-27T19:56:03Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:56:03Z\",\n                \"finishedOn\": \"2025-08-27T19:56:08Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"632adedacf538382e56cc272c6986beb3c8925e2\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/rhods-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"632adedacf538382e56cc272c6986beb3c8925e2\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756324494\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"632aded\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/rhods-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:646a873620f805bac8968cd56bea08b24b2a98b258d27607644f988c56235ec8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:56:09Z\",\n                \"finishedOn\": \"2025-08-27T19:56:18Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:8bb311e95a187638c1fcb1ca9b38422f8a86763fcf4e447da092af125faa87f9\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:c7909d4d234c744060d8f2e245f40ba80b623a4282aad7d7be90f4ed7581effa\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:56:19Z\",\n                \"finishedOn\": \"2025-08-27T19:57:16Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-x86-64@sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:0d79ae0c7a0b5749d2a99f0e13a4a7dfe91a0097d80ef76f1ef411ed892e7258\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:57:16Z\",\n                \"finishedOn\": \"2025-08-27T19:59:02Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-ppc64le@sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:45d1f889954116720114852bddebd5a8ee70a58b03cc57be73455f7ccba5ddb6\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:57:16Z\",\n                \"finishedOn\": \"2025-08-27T20:04:25Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-s390x@sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:f7a3e8b2edf7f46dd9c234afdfcc04ba4c69b61ebb0cf1001a0ff3f51523b989\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:57:16Z\",\n                \"finishedOn\": \"2025-08-27T20:04:28Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-m2xlarge-arm64@sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24-linux-m2xlarge-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:c22d9e24722692219c0ba63c7a3609b306b73a8a744d764e662ea53698484689\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:57:16Z\",\n                \"finishedOn\": \"2025-08-27T20:04:03Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31, quay.io/rhoai/odh-rhel9-operator@sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1, quay.io/rhoai/odh-rhel9-operator@sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18, quay.io/rhoai/odh-rhel9-operator@sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24@sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:72260cabff4384565768ec2eaa1f56a0088762baf4d1dd9b70f8cc166713afb1\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:28Z\",\n                \"finishedOn\": \"2025-08-27T20:04:45Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-rhel9-operator:sha256-2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9.src\\\", \\\"image_digest\\\": \\\"sha256:cb97d5cc085827e8c70da890248b8c8044886ddbbfeddca6ad391172f913f6cb\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:sha256-2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9.src@sha256:cb97d5cc085827e8c70da890248b8c8044886ddbbfeddca6ad391172f913f6cb\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:cb97d5cc085827e8c70da890248b8c8044886ddbbfeddca6ad391172f913f6cb\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:sha256-2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:05:31Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:05:00+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:05:01Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:05:06+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:46Z\",\n                \"finishedOn\": \"2025-08-27T20:22:09Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:04:53+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:04:54Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\":\\\"sha256:694760dead804ad826dfc25279a542d53fc1629e73e77ae15c7f9dd3e377e0cd\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\":\\\"sha256:9767a1d4d363d89910484a3c5945ce3055508503d388b319c6fc440c4907cce3\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\":\\\"sha256:ace46765225fc1b73c1b9394d4488946b8769139fdefbc1a07165ce714014b8e\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\":\\\"sha256:0798febc2dd74578550ac5a1778666453af6707187e8a744c992c902057338ec\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:07:05+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:07:06Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756325154\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:06:14Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:06:03+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:06:10Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756325256\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:07:39Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:04:53Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:70e44f7770701bea3073199b77fe3e90f0f1839a6e1f4cbfd8808756be90d8fa\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:04:54Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\", \\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\", \\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\", \\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\", \\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:05:45+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:05:46Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-27T20:22:10Z\",\n                \"finishedOn\": \"2025-08-27T20:22:16Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T20:22:17Z\",\n                \"finishedOn\": \"2025-08-27T20:22:24Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n    material.digest.sha1 == \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'rhoai-init' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\",\n                  \"params\": [\n                    {\n                      \"name\": \"url\",\n                      \"value\": \"https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n                    },\n                    {\n                      \"name\": \"revision\",\n                      \"value\": \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n                    },\n                    {\n                      \"name\": \"pathInRepo\",\n                      \"value\": \"konflux-tekton-tasks/rhoai-init/0.1/rhoai-init.yaml\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-v2-24-on-schedule-sps5p|odh-operator-v2-24-on-schedule-sps5p> - 2025-08-27T19:56:02\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:55:58Z\",\n                \"finishedOn\": \"2025-08-27T19:56:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"expected-cluster\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rhoai-init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:7e7446e238976c3832d1e26feee86f92a43836808a7153a587cf22804a0e2e8a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:41Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"rhoai-2.24-adf575fd0fcaaf93708eb372d2f68313384e4e4a\",\n                      \"rhoai-2.24-nightly\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"42bb327\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f124f5de413288760182956867d4ffdb9d0ed497937d642515fcdaa771d8661\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:18Z\",\n                \"finishedOn\": \"2025-08-20T16:10:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-clusterresourceoverride-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"42bb327726b23c2cfbccf051bbc27e79ce23dbca\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:04+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:59094118aa07d5b0199565c4e0b2d0f4feb9a4741877c8716877572e2c4804f9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:4c2b0a2d2904108f8d19edfa878df6cd49ed19aab73ab6fc6a435fba0265f771\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:8469fa35edcc772bb5dc4a6907044ca0940f0c297177524c344d5fe5a236fca5\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:30Z\",\n                \"finishedOn\": \"2025-08-20T16:14:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all tasks that have status 'Succeeded'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:50Z\",\n                \"finishedOn\": \"2025-05-08T19:54:54Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709479\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b95197\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:55Z\",\n                \"finishedOn\": \"2025-05-08T19:55:03Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:03Z\",\n                \"finishedOn\": \"2025-05-08T19:55:12Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:04Z\",\n                \"finishedOn\": \"2025-05-08T19:56:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:97ce660c7e669825a36bbc967def6b22e9c37dc9fbc12316bc9c080847a0c285\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:11:23Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:292b23d18b4c0f7cd0a60f78f0acfd6ede9805bfee1ad5541b0a0b30adf32318\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:26:40Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a@sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5cea1c3f55f83a338d6fbef56e445fd4dbf05533eb2fb8d065019c592e3b49d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:40Z\",\n                \"finishedOn\": \"2025-05-08T20:26:53Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\\\", \\\"image_digest\\\": \\\"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src@sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:02+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\":\\\"sha256:f9c280b76b78d6087165b22334b64642cb3778f312374fc2ea1b637c649bd683\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\":\\\"sha256:f161671b511f21dcd29853f57d7362b4984e792630c977ffdc674f717779ba72\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":127,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:32:58Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746736497\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:34:58Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-05-08T20:33:03+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":12,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:05Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:40+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:55Z\",\n                \"finishedOn\": \"2025-05-08T20:27:42Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:bd21f15d03f95d4df19f858d9df59cb089e012bfdd8d55d66bf71a77c05adc3d\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:01Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:38:31Z\",\n                \"finishedOn\": \"2025-05-08T20:38:39Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "tasks_with_status := [task |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.status == \"Succeeded\"\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:6b42b39c3854c5bb9555c0c36c41e4295ee4dd403a4fbc08d72fb91f4657b9f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:22:22+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:36728f08e76b74e554cddc19750e6150b04705b4b7f4f31f2eaa31a3326d2a89\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2b5ace1b5ec0e701a1436a8d52c38f4da58abb5e5a07322337e621e405559c28\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:22:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"58e6512b6dc3ca99e1f8674b1cd8a68039754a6f\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"58e6512b6dc3ca99e1f8674b1cd8a68039754a6f\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"58e6512\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:02Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:12Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b30d58fc0d923907b368b4d8518d9f6623ed51aaf756d94dfa723d26dc29c604\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:21Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:97bed8fb7e498a57dc4f0a2d05ec314cc066ff8fe67eab9a7efbfe7fd97ee081\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:22Z\",\n                \"finishedOn\": \"2025-08-20T16:08:36Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4c23ff8c543f2c29c1cd00e3f52246f5e4d6a5df8320b427e9f05a8a19b2dd33\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:22Z\",\n                \"finishedOn\": \"2025-08-20T15:56:56Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:155b6e5a4dd16df74505895afb61828f41cf0de55dbd2ce54e89c8b6b43a6f04\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:22Z\",\n                \"finishedOn\": \"2025-08-20T15:53:17Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201@sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0e43287bbde8605979a62e6a4fcc669cd6d2233c68f27c6034fc488428e4c566\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:36Z\",\n                \"finishedOn\": \"2025-08-20T16:08:53Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:03+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:05Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:04+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:07Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:25Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:01Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:53+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:41cfad0c1444c574f43cbddcbcce2c8ef78c3a34d94aa9c6574f22f8b54694ed\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:97a415fdb87e02d927c380da3cf0062c9be50185e37235ac6e0bdfd41583a01e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:58Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:10:40+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:09:58Z\",\n                \"finishedOn\": \"2025-08-20T16:10:41Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:12:08+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-40e9556030d42926f047426c8b651ff09-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:12:08Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:12:08Z\",\n                \"finishedOn\": \"2025-08-20T16:12:14Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'git+https://github.com/red-hat-data-services/konflux-central.git' and commit 'f2b2d6050b2b632c5eb551d0f58026b0cd932866'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"git+https://github.com/red-hat-data-services/konflux-central.git\",\n              \"digest\": {\n                \"sha1\": \"f2b2d6050b2b632c5eb551d0f58026b0cd932866\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/konflux-central.git\"\n    material.digest.sha1 == \"f2b2d6050b2b632c5eb551d0f58026b0cd932866\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:12:08+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-40e9556030d42926f047426c8b651ff09-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:12:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"image-digest\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970300\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:82436859839d816c9e368ae2154e6f8fe0affe44ecca52048e9494a3ccafdc21\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:24Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:df185dbe4e2852668f9c46f938dd752e90ea9c79696363378435a6499596c319\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:40+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:55Z\",\n                \"finishedOn\": \"2025-05-08T20:27:42Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all task names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:50Z\",\n                \"finishedOn\": \"2025-05-08T19:54:54Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709479\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3b95197\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:54:55Z\",\n                \"finishedOn\": \"2025-05-08T19:55:03Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:03Z\",\n                \"finishedOn\": \"2025-05-08T19:55:12Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:04Z\",\n                \"finishedOn\": \"2025-05-08T19:56:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:97ce660c7e669825a36bbc967def6b22e9c37dc9fbc12316bc9c080847a0c285\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:11:23Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:292b23d18b4c0f7cd0a60f78f0acfd6ede9805bfee1ad5541b0a0b30adf32318\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:56:49Z\",\n                \"finishedOn\": \"2025-05-08T20:26:40Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a@sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5cea1c3f55f83a338d6fbef56e445fd4dbf05533eb2fb8d065019c592e3b49d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:40Z\",\n                \"finishedOn\": \"2025-05-08T20:26:53Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\\\", \\\"image_digest\\\": \\\"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src@sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:sha256-81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:02+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\":\\\"sha256:f9c280b76b78d6087165b22334b64642cb3778f312374fc2ea1b637c649bd683\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\":\\\"sha256:f161671b511f21dcd29853f57d7362b4984e792630c977ffdc674f717779ba72\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":127,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:32:58Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746736497\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:34:58Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-05-08T20:33:03+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":12,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:33:05Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:40+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:55Z\",\n                \"finishedOn\": \"2025-05-08T20:27:42Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:bd21f15d03f95d4df19f858d9df59cb089e012bfdd8d55d66bf71a77c05adc3d\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:01Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T20:38:31Z\",\n                \"finishedOn\": \"2025-05-08T20:38:39Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:01+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:28:07Z\",\n                \"finishedOn\": \"2025-08-20T16:29:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:4bbacb8c18e9f13dd198b0e457b0737ad156e1dc53fb8b646745fb386e27283c\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:30Z\",\n                \"finishedOn\": \"2025-08-20T15:47:37Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:38Z\",\n                \"finishedOn\": \"2025-08-20T15:47:52Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:53Z\",\n                \"finishedOn\": \"2025-08-20T15:47:59Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4c559731abfb9cc6e6ff3b1ac6a1678ad689b7d3c2bdbcc550c465ca96bfd989\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:59Z\",\n                \"finishedOn\": \"2025-08-20T15:49:38Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:583918f6944c273a948a5ce07066d0ad6a06d01ae0ef341900fb2c2304e6c2cb\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:59Z\",\n                \"finishedOn\": \"2025-08-20T16:05:56Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4421588adcd31d50883741623f04ab948489b6d08dfb45dd542520dedb346c18\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:59Z\",\n                \"finishedOn\": \"2025-08-20T16:21:00Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1dc9ca11ebc6d71edc04713b7409a73beedccd6f0410644160b3e74b93d753ff\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:59Z\",\n                \"finishedOn\": \"2025-08-20T15:53:56Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201@sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4d1b4c4f0531ddfa238a8d025cdd936b34ec111aa79e0d247ae0d490f65d3d2b\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:01Z\",\n                \"finishedOn\": \"2025-08-20T16:21:17Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:43+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:45Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:27+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:26+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:27Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:21:25Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:22:23+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:edd8c34cca5f98da6079eed090a2c2c3981cd5b576add4fce8c37e8515026c53\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0150cab600b59e5382cb28b1e6c1c130c7638b319b3cc8c43f07801daec0bf5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:22:32Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:23:15+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:22:32Z\",\n                \"finishedOn\": \"2025-08-20T16:23:17Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:24:33+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-local-storage-operator-xlh5c-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:17Z\",\n                \"finishedOn\": \"2025-08-20T16:24:34Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:24:34Z\",\n                \"finishedOn\": \"2025-08-20T16:24:42Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\", \\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\", \\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\", \\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\", \\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:19:45Z\",\n                \"finishedOn\": \"2025-09-04T07:19:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\\\",\\\"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\\\",\\\"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\\\",\\\"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\\\",\\\"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:33+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-41f380b8b18dfc660625bcbe6732775d9-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:01Z\",\n                \"finishedOn\": \"2025-08-20T16:27:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\",\n                    \"image-digest\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server\",\n            \"digest\": {\n              \"sha256\": \"1f07e72c1b0295497eeda51257c93879fd2ba8efd5b2f2d76df7e3c835440702\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:f289abe0fb4f64dcd09b8f7cbae89da11a64db1f123b7fb8a9986dafe31e6bdd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T06:59:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:6851c7f701a40a63193431a3dbda2095accdc40e03ecb66a6b1cebf8851f337b\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:58:04Z\",\n                \"finishedOn\": \"2025-09-04T07:01:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:36+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:08bba4a659ecd48f871bef00b80af58954e5a09fcbb28a1783ddd640c4f6535e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:d279d2994a70e37364c3011481d5b7ab742c27360b21bfe4255acc35239dbd93\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \"images/git\",\n                    \"DOCKERFILE\": \"default/Containerfile\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"IMAGE_DIGEST\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:23112147958e0b86932d12e16208081a8aff6ccb099194f2346842dc3d0f96c6\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:29Z\",\n                \"finishedOn\": \"2025-08-20T16:10:34Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"44617ca\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:35Z\",\n                \"finishedOn\": \"2025-08-20T16:10:43Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:43Z\",\n                \"finishedOn\": \"2025-08-20T16:10:51Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3603ebb13fb7baad990d03ff10e4fad8405e81c683fbd1f316584477637ba9c9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:12:26Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0f1fc10e6c369fb87d812088ca9d9230698c95504fbc146455efa0e1a378644c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:18:03Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:37e3a1a0586a921d9b04c32ebe771d90a9815b29e7622f650b715b27b4fd307c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:26:59Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2e463c5ebcd6d4ea1cc1b8fefe35706dcec0a38699ed1d2be11640ab2124d5a2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:16:47Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201@sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a44f2f924cad726d295f576a4761d9d10715106a98b3a22bdc6cbb014e5cea16\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:00Z\",\n                \"finishedOn\": \"2025-08-20T16:27:15Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:24+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:25Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:26+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:28Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:24Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:21Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:28:15+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:a0fef942d6e2cb389682022787d04793e8c91641158f3ee79714e0a0afd9e6be\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2f141d7a86810552598b39ad161836d01d51d32e8f6aa5667c29ff76d4279f42\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:28:20Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:08+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:28:20Z\",\n                \"finishedOn\": \"2025-08-20T16:29:09Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\\\",\\\"sha256:7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\\\",\\\"sha256:49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\\\",\\\"sha256:f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\\\",\\\"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:29:58+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-cluster-nfd-operator-84plm-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:30:00Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:30:00Z\",\n                \"finishedOn\": \"2025-08-20T16:30:07Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"384764ca9fa3c808d36a23e6f00f3103835752092bc35862ab56030307fd6f4c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"9bdbda22c5f5d633c7149ec9f58131495dbf6a2392aa84438f9193d1f0d5043d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"8f589ccf429d86fa52fd67d1d0a3ea4e3eb839f3187c075ae83456a7e94ea446\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"57fd3706acb7188f0b76a0e61c4190c50793e02350316b12624b8e8bc035da89\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"5c54553998e6a80dd93b12f495959ce72551343888b58e115d0300a9d0865fab\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:52Z\",\n                \"finishedOn\": \"2025-08-20T15:46:58Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d692\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:59Z\",\n                \"finishedOn\": \"2025-08-20T15:47:07Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:08Z\",\n                \"finishedOn\": \"2025-08-20T15:47:15Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aa344aaa6ba1be9a1c0053107f30da40cd04d7609627948789ce5c43b7ffeef4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:48:54Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aff428f2069bfeded72e06af53b07797d038e3b84158e695f0ac9c11549232fa\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:57:46Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0979f1ba1040d38c21e11f3829216c51113e1e580605830a0f637bf8e22e9d22\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T16:15:16Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:77544ebfc96829087a087e8f565dd4c24e3bfdba721cfdbe40583a254f166221\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:53:11Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201@sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f1caf0f8195b2db72f5451315a5ab0cf45b1aaf0cc4e2d7704ca6db7c6b944f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:16Z\",\n                \"finishedOn\": \"2025-08-20T16:15:33Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:42+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:44Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:43+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:45Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:15:42+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:43Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:42Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:52+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c94e55805faf1bcac2916f9f044cb0ae3b98c33f0248e1de0397d6560a418d0e\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0f42ac97c44f0f0b4c704f64e26b6d1390de485a62bb48aba051de4d72e81f4c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:16:57Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:17:41+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:57Z\",\n                \"finishedOn\": \"2025-08-20T16:17:42Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:19:19+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-ptp-operator-m58j2-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:19:20Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:19:20Z\",\n                \"finishedOn\": \"2025-08-20T16:19:28Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:386c8c3395b44f6eb927dbad72382808b0ae42008f183064ca77cb4cad998442\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749529986\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:33:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"44617ca\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:35Z\",\n                \"finishedOn\": \"2025-08-20T16:10:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"44617caa4d2149b19ae3129e4d61195d93f4212b:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-cluster-nfd-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\", \\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\", \\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\", \\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\", \\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:48+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:56fa2cbfc04bad4765b7fe1fa8022587f4042d4e8533bb5f65311d46b43226ee\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\\\", \\\"image_digest\\\": \\\"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src@sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:22:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"033ccaa\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e7ceca31e36d2d43a0f1ca6d2941ed52ce57226cdc259f9d8cf53957537703ba\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:10Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-metallb-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-metallb-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"033ccaa21dbaadc6af1590e3296cd10a384d4165\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:3dc39eae48745a96097c07c577b944d6203a91c35d3f71d9ed5feab41d327a6a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1762924605\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:26Z\",\n                \"finishedOn\": \"2025-11-12T05:17:35Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodulePaths\": \"\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/rhobs/konflux-coo-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:56fa2cbfc04bad4765b7fe1fa8022587f4042d4e8533bb5f65311d46b43226ee\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\\\", \\\"image_digest\\\": \\\"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src@sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:22:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:32:11+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:32:13Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\":\\\"sha256:8de22cde4c025fa5a2280aae23bfba29affb99c85c1a55ee86278f162e653c58\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\":\\\"sha256:2dea4572abe98b008cfecd7794c81976a05e0e757a538043a3090722c91a5e44\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\":\\\"sha256:1b468490de5adda615f836950610ee8c2191c2fb0c74ade4e2713a570f69fdcd\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\":\\\"sha256:0836df554e3319b95f52f20b89cc6ded3f9debdf61148c4d022dcd92ee2cd56e\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:51+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all task names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:57:31Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:f289abe0fb4f64dcd09b8f7cbae89da11a64db1f123b7fb8a9986dafe31e6bdd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T06:59:47Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:5fb0e147903778a49e235a5f68ecf1436869d10de094b19db06aa5204317a252\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T07:01:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:de1f448719fa12f0f000f49cb83cab41d83a66e2a64f13503264dfdf1ac6e5d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T07:01:58Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:bdb3e5d18b7acfdfb42e51a1dee06611122068234d9b5e78fd40e61aedbe65c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:01:34Z\",\n                \"finishedOn\": \"2025-09-04T07:06:20Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:e206be2ffdfec6787d6a8284c98236a4820493131055509ee7a15a8646ba2189\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:22Z\",\n                \"finishedOn\": \"2025-09-04T07:16:36Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\\\", \\\"image_digest\\\": \\\"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src@sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\":\\\"sha256:8de22cde4c025fa5a2280aae23bfba29affb99c85c1a55ee86278f162e653c58\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\":\\\"sha256:2dea4572abe98b008cfecd7794c81976a05e0e757a538043a3090722c91a5e44\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\":\\\"sha256:1b468490de5adda615f836950610ee8c2191c2fb0c74ade4e2713a570f69fdcd\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\":\\\"sha256:0836df554e3319b95f52f20b89cc6ded3f9debdf61148c4d022dcd92ee2cd56e\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:51+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:52Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:57+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:38Z\",\n                \"finishedOn\": \"2025-09-04T07:18:58Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970376\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:39Z\"\n              },\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:42+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:43Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:02+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:03Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:05+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:38Z\",\n                \"finishedOn\": \"2025-09-04T07:17:07Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:44Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:6b42b39c3854c5bb9555c0c36c41e4295ee4dd403a4fbc08d72fb91f4657b9f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:49Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\", \\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\", \\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\", \\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\", \\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:18:47Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:19:52Z\",\n                \"finishedOn\": \"2025-09-04T07:19:58Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:8f73fd977807d4e3dc322814b7f8d7c4b66da457ddb664a4f91c21244b91df9d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all task names from the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:46:59Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"3dbcca8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bbcb490945b612c00359b666ec4dc94fab1f4e767c6922a3b4a4ab57d3301d30\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:59Z\",\n                \"finishedOn\": \"2025-08-20T15:47:08Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bbcb490945b612c00359b666ec4dc94fab1f4e767c6922a3b4a4ab57d3301d30\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:09Z\",\n                \"finishedOn\": \"2025-08-20T15:47:16Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:31294d9b2cc4f1f608ac5f9b194b9488616cade52836f28ba611604c724375f6\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:18Z\",\n                \"finishedOn\": \"2025-08-20T15:48:56Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4eb98d5718cf367cc8dfc131a7c008a80c1b5ed888e7d42920e0decc9858b2c8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:18Z\",\n                \"finishedOn\": \"2025-08-20T16:08:03Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:34b81bf8c2dbcfc0fbf647c67e1b0626a682f87e55d65893ecf59efced8c1513\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:18Z\",\n                \"finishedOn\": \"2025-08-20T16:07:22Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:76694df9a981dcbde24153f86759f64fe72b0a841a593d89ce4a157477a25dd4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:18Z\",\n                \"finishedOn\": \"2025-08-20T15:53:16Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bf43aebb011b72d681f53e361dc07e92446614ca44718c3cb98fb84e7c5862c4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:04Z\",\n                \"finishedOn\": \"2025-08-20T16:08:21Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:08:46+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:08:48Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:08:31+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:08:33Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"ERROR\\\",\\\"timestamp\\\":\\\"2025-08-20T16:08:28+00:00\\\",\\\"note\\\":\\\"Unexpected error: Script errored at command: cosign download sbom $arch_imageanddigest > ${SBOM_FILE_PATH}.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:08:28Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:08:28Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\\\",\\\"sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\\\",\\\"sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\\\",\\\"sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\\\",\\\"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:38+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8f6857c2c07792c823b8a9888ebaabd234066593a44c8aa5fb515946dc407199\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:4c62fdf3aad435bcf9dc3cab1bdda084454533ea132e7b46bf3b07b19b8503e9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:09:43Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\\\", \\\"digests\\\": [\\\"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\\\",\\\"sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\\\",\\\"sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\\\",\\\"sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\\\",\\\"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:10:28+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:09:43Z\",\n                \"finishedOn\": \"2025-08-20T16:10:29Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\\\",\\\"sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\\\",\\\"sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\\\",\\\"sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\\\",\\\"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:12:50+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4851eda6b49395387f4e919627b2a8b43-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":7,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:21Z\",\n                \"finishedOn\": \"2025-08-20T16:12:52Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:12:52Z\",\n                \"finishedOn\": \"2025-08-20T16:12:59Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'deprecated-base-image-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:11:07+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:05:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\\\", \\\"image_digest\\\": \\\"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src@sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'prefetch-dependencies' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:24Z\",\n                \"finishedOn\": \"2025-08-20T16:12:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'generate-version-labels'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:03Z\",\n                \"finishedOn\": \"2025-05-08T19:55:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"generate-version-labels\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:3dc39eae48745a96097c07c577b944d6203a91c35d3f71d9ed5feab41d327a6a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1762924605\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:26Z\",\n                \"finishedOn\": \"2025-11-12T05:17:35Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodulePaths\": \"\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/rhobs/konflux-coo-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:9dbb38efdfca525b00dc502acf44723ac4a6c413bb2ab97459a13cd3a6056f17\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:873a0cbcf9d1533b4d9c1b3de2c47451f8b5a10aa0c3e17bfc45f6b439042854\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:23112147958e0b86932d12e16208081a8aff6ccb099194f2346842dc3d0f96c6\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:01:24Z\",\n                \"finishedOn\": \"2025-11-19T18:03:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:464282534bb5c2384429cca983cdae44b8a53d1b96e02cc055e85cbd6b240ee5\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"---\\nrequests_timeout: 600\\nsubprocess_timeout: 3600\\n\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[{\\\"type\\\":\\\"rpm\\\",\\\"path\\\":\\\"images/git/default/rpms\\\",\\\"options\\\":{\\\"dnf\\\":{\\\"hummingbird\\\":{\\\"gpgcheck\\\":\\\"0\\\"},\\\"hummingbird-source\\\":{\\\"gpgcheck\\\":\\\"0\\\"}}}}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"5d\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-08-20T16:12:17+00:00\\\",\\\"note\\\":\\\"Step extract-and-validate failed (1): Could not fetch related images. Make sure you have catalog.yaml or catalog.json formatted correctly in your file-based catalog (FBC) fragment image.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":8,\\\"failures\\\":1,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:63cc9fef3ac927c93ad7ffe9c1eff75eb4afc9ad9804ac37840754bd211f59b0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:12:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:3f89ba89cacf8547261b5ce064acce81bfe470c8ace127794d0e90aebc8c347d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"latest\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a2b365ba325033f584af47d21d30570270\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a2b365ba325033f584af47d21d30570270\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"0df535a2b365ba325033f584af47d21d30570270:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-smb-csi-driver-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"0df535a2b365ba325033f584af47d21d30570270\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-model-controller-v2-24-on-push-6c64x|odh-model-controller-v2-24-on-push-6c64x> - 2025-08-27T18:37:11\\nStatus: Failed :failed:\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:07Z\",\n                \"finishedOn\": \"2025-08-27T18:37:12Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:13Z\",\n                \"finishedOn\": \"2025-08-27T18:37:18Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"d10e457ed421f3c7bc22d8df89068c9b7ac317c2\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/odh-model-controller\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"d10e457ed421f3c7bc22d8df89068c9b7ac317c2\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756319813\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"d10e457\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/odh-model-controller\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:046ae40ba1cc75413badcaa1c80ee91709c784772c8abba8b2c627635392fa4a\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:19Z\",\n                \"finishedOn\": \"2025-08-27T18:37:27Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:0da734a811d57810f80202cceb2d79051d1de150f39f7689c5415f655598d62f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:298c8a06c501915e7038d45aa91d7172815d0a00d538785401504f90bc82ca8d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:28Z\",\n                \"finishedOn\": \"2025-08-27T18:38:41Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64@sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:7fd71c00ad9b7098f0d794deb1703b0062c07b81693282c50552e9e4b16c4237\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:40:31Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-ppc64le@sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:cb75c372bdb33bd17b8be23aed5598a6306f1c4752503902ba0ffeec613b2ca9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:45:40Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-s390x@sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:b66893c8784ff73cbfa1a52b305a34c0e47f904cbfbe9f93e0e2a019e7823542\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:47:04Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-m2xlarge-arm64@sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-m2xlarge-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:3d180cdc9845b7d1681fad09a7674cc544a6ee45805dad9dd1d716b672e7d2d5\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:45:30Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439, quay.io/rhoai/odh-model-controller-rhel9@sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d, quay.io/rhoai/odh-model-controller-rhel9@sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859, quay.io/rhoai/odh-model-controller-rhel9@sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24@sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:7bdc50f68edc2df3da352f90c146580a83351643f3eb1171442b9da6bd41c2ef\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:05Z\",\n                \"finishedOn\": \"2025-08-27T18:47:20Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:sha256-40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b.src\\\", \\\"image_digest\\\": \\\"sha256:9f30f610f27f49c16b415291d0c31294984b311b7baa61c620428c12d7f60f4b\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b.src@sha256:9f30f610f27f49c16b415291d0c31294984b311b7baa61c620428c12d7f60f4b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9f30f610f27f49c16b415291d0c31294984b311b7baa61c620428c12d7f60f4b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:22Z\",\n                \"finishedOn\": \"2025-08-27T18:48:12Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:35+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:37Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:35+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T19:04:39Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:30+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:31Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\":\\\"sha256:f8f32d494e7d1cba9974140d9aa382d4aa804130b61067266d146f4061ad9658\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\":\\\"sha256:466edc9b3248e9e4a76d9244d938a220ddba28be021c9aa4848fb35e1b472e66\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\":\\\"sha256:964e591259d0e6099dc68278534972c13028ffd864d4db43d72fb02c62eb06ad\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\":\\\"sha256:01c6e4cb3745aba81532939378217bc8069a9260fafcfdd9e9e6ef566817dfbe\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":76,\\\"low\\\":151,\\\"unknown\\\":8}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:48:34+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:48:35Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756320491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:48:17Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:40+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:43Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756320563\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:49:27Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:28Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:0880f37248eb31ebc81c9b48369c36a6c795d5be65fa04935a18613345aa24e4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:29Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\", \\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\", \\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\", \\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\", \\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:30+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:30Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-27T19:04:39Z\",\n                \"finishedOn\": \"2025-08-27T19:04:44Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T19:04:44Z\",\n                \"finishedOn\": \"2025-08-27T19:04:51Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"af380340b19d316a235576db78456f3f087b279e\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub-operator-bundle\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"af380340b19d316a235576db78456f3f087b279e\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756980643\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"af38034\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub-operator-bundle\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:02Z\",\n                \"finishedOn\": \"2025-09-04T10:11:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"af380340b19d316a235576db78456f3f087b279e\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub-operator-bundle\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\":\\\"sha256:d76c0eedd258d81cbcd9f7d6a2a76d351a266ed9a6936d6f40cc9e39f8c49c5d\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\":\\\"sha256:13c25e0934b40db9282eca16363c7683f7b9c20445400a47d39759688a12235c\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\":\\\"sha256:f5f55d8bfbba90a8694e95caf8191f9bd31e8e9e63f867ea5a5d6f87c334392d\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\":\\\"sha256:4bfa9df3c03380734e8daa664e6dd0c708ab0b0a70449dfeeba89ef3956f19c5\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui\",\n            \"digest\": {\n              \"sha256\": \"c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:53Z\",\n                \"finishedOn\": \"2025-08-20T15:47:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:893ffa3ce26b061e21bb4d8db9ef7ed4ddd4044fe7aa5451ef391034da3ff759\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\\\":\\\"sha256:f4b62c4f4a7f816b42d47cbe077109e127461e2e13774398adbcf8ecb8f15240\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:31:43+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:32Z\",\n                \"finishedOn\": \"2025-08-28T18:31:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad213d00cdcff677600177ba5ce759582a9e\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad213d00cdcff677600177ba5ce759582a9e\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad2\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:00Z\",\n                \"finishedOn\": \"2025-08-20T15:47:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"aacdad213d00cdcff677600177ba5ce759582a9e:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-sriov-network-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"aacdad213d00cdcff677600177ba5ce759582a9e\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970300\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:e371aa09c65ab309138b4aeae9ea4dd93f83119c5cc61e9f2057fe5bb518fbe9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'd2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1749529764\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:43Z\",\n                \"finishedOn\": \"2025-06-10T04:29:58Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:15214d7736224455f1f2782c05df3239d0145f5e7e900e9a1055ee421e31d62d\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:34:34Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:3b9b1fa1081a50d3e1ec754351f0780b2a867433a73569c1e9573ee7c2653d5a\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:35:55Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:ac2de036a80ebc574f2711bc803c19927040e45caf779bf59dfa58b725ac4f47\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:39:39Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336@sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:5ac20d525495a4d6d449da38763187a47edb291acd70efa1dbbd8a14f75d8048\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:39Z\",\n                \"finishedOn\": \"2025-06-10T04:39:54Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\":\\\"sha256:e0d0adf148dff15572a04ce4b6460b554d03f42b09b57ea14358ced4d23acd55\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\":\\\"sha256:76a6956e29a5c71dbf068910bfe68159d3023cf9742b6d08c70f3d640709af4a\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\":\\\"sha256:8dfada9f7864c5e3d48eecb585f195ee321dbbfa71cfb62f26cd137b5f4fce7d\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":9,\\\"medium\\\":21,\\\"low\\\":21,\\\"unknown\\\":12}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:39Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749530486\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:28Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\", \\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\", \\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\", \\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 329, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:47Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:41:33Z\",\n                \"finishedOn\": \"2025-06-10T04:41:40Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:cfeeef2f4ab25b121afdf44eecc394ed67f3534a1bd14bef9e7beef2ee654b8e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:15214d7736224455f1f2782c05df3239d0145f5e7e900e9a1055ee421e31d62d\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:34:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"COMMIT_SHA\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"build/Dockerfile.openshift\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"LABELS\": [],\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:f289abe0fb4f64dcd09b8f7cbae89da11a64db1f123b7fb8a9986dafe31e6bdd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T06:59:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'git+https://github.com/red-hat-data-services/konflux-central.git' and commit 'f2b2d6050b2b632c5eb551d0f58026b0cd932866'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"git+https://github.com/red-hat-data-services/konflux-central.git\",\n              \"digest\": {\n                \"sha1\": \"f2b2d6050b2b632c5eb551d0f58026b0cd932866\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/konflux-central.git\"\n    material.digest.sha1 == \"f2b2d6050b2b632c5eb551d0f58026b0cd932866\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:3603ebb13fb7baad990d03ff10e4fad8405e81c683fbd1f316584477637ba9c9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:51Z\",\n                \"finishedOn\": \"2025-08-20T16:12:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"44617caa4d2149b19ae3129e4d61195d93f4212b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:19:19+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-ptp-operator-m58j2-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:19:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\",\n                    \"image-digest\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970431\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:03:55+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:90d1fffc3be16350cfa31d671a4fdfc8b1664728196a603920033669e870732b\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f2260146ed573a6dbf4fb5d45f75ef567744a7d7785835547b705b9e5a6cf357\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:24Z\",\n                \"finishedOn\": \"2025-08-20T16:04:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\\\", \\\"image_digest\\\": \\\"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src@sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:1f6e2c9beba52d21c562ba1dea55f579f67e33b80099615bfd2043864896284d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:19+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:25:21Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:57b3262138eb06186ae7375f84ca53788bba2a66cfd03d39cb82c78df050aba5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'sast-snyk-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:9a6ec5575f80668552d861e64414e736c85af772c272ca653a6fd1ec841d2627\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'deprecated-base-image-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\",\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\",\\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:33+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:07:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'generate-version-labels'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:23Z\",\n                \"finishedOn\": \"2025-05-08T19:13:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:f87c0cccd5a5906aab86b966a42847362c57198cf2e4c2e49b9376e65932b240\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"generate-version-labels\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:ca3432ceab4ba81dd4c349304f5050995417deabeee9b7c25c0cd529a2d740ef\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:55Z\",\n                \"finishedOn\": \"2025-09-04T10:12:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile.bundle\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\",\n                    \"IMAGE_DIGEST\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:06Z\",\n                \"finishedOn\": \"2025-05-08T19:13:12Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords-ui\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709408\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords-ui\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:f87c0cccd5a5906aab86b966a42847362c57198cf2e4c2e49b9376e65932b240\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:12Z\",\n                \"finishedOn\": \"2025-05-08T19:13:22Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:23Z\",\n                \"finishedOn\": \"2025-05-08T19:13:34Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:22Z\",\n                \"finishedOn\": \"2025-05-08T19:13:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:12efa4ba2a16013318256c9275308637a8f7375552fdf944b4514aa251eeafa5\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:50Z\",\n                \"finishedOn\": \"2025-05-08T19:15:26Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:ea2bf4de2bc002139fc1f430d6f994a61e04b6358043aee63b633911ebdc4da5\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:50Z\",\n                \"finishedOn\": \"2025-05-08T19:20:51Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755@sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:976058e10b643ac4df6aa99e1090a74ba305e11dd660d4336d6f2710f53c7ff0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:20:51Z\",\n                \"finishedOn\": \"2025-05-08T19:21:13Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\\\", \\\"image_digest\\\": \\\"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src@sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:22:20Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:22+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:23Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\":\\\"sha256:d0af342fc5f40e968e180cf7e1fa127968d92060cd33270c86eb8fa511da61c8\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\":\\\"sha256:baa7690ba743163a9a77694894dbf63d8ebcf93bd5220e1af2bc77c8b107c009\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":582,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:23:04+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:05Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746732115\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:57Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:41+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:43Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746732213\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:36Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:30+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:31+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:22Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:6b3ac50656ff1380a59dbaf04852be5c453fcfbd792b849fe54a4560c5655bf1\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:20Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T19:23:36Z\",\n                \"finishedOn\": \"2025-05-08T19:23:44Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-rhel9-operator:sha256-aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05.src\\\", \\\"image_digest\\\": \\\"sha256:e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:sha256-aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05.src@sha256:e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator:sha256-aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:cfcfa921e148610916faa22d962bbe414cb12431e99347638c1e2d92076ef2e3\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:82436859839d816c9e368ae2154e6f8fe0affe44ecca52048e9494a3ccafdc21\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:7c73e2beca9b8306387efeaf775831440ec799b05a5f5c008a65bb941a1e91f6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\":\\\"sha256:d0af342fc5f40e968e180cf7e1fa127968d92060cd33270c86eb8fa511da61c8\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\":\\\"sha256:baa7690ba743163a9a77694894dbf63d8ebcf93bd5220e1af2bc77c8b107c009\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":582,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:23:04+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'fbc-fips-check-oci-ta' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:15a388f3b75ae01ccbfe6c9a75d73dce7cc05fe33b75e29ff78870dcde102bf6\\\",\\\"sha256:a80246344f6baf96207257075ae769d8d9db768c0e31fed71337850f404e1fb0\\\",\\\"sha256:cb0a8ac55231405ed6da87685f2a8d87db57bffa5c4615a712687dc59b7b9c39\\\",\\\"sha256:e76862e24a76caf956d69898e77474a21e0b9139aa7920b6eb1895475f82ae24\\\",\\\"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:12+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-498ed3ee079b788233f6e21fc8ea128a1-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:25:13Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\",\n                    \"image-digest\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:36d40d4009cd527f0beab5c7584356b4fb9c5baf001a7e83d8733f9a6757c818\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756326313\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'git+https://github.com/red-hat-data-services/konflux-central.git' and commit '3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"git+https://github.com/red-hat-data-services/konflux-central.git\",\n              \"digest\": {\n                \"sha1\": \"3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/konflux-central.git\"\n    material.digest.sha1 == \"3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:dc0be087e4876af0a34dc063d4fbe8c020c2360aaac168212faed3e249a01b5d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bf43aebb011b72d681f53e361dc07e92446614ca44718c3cb98fb84e7c5862c4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:04Z\",\n                \"finishedOn\": \"2025-08-20T16:08:21Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:d904421e9cb106c941eb1d863627d4c8aa8754006fde7024412fe3e991c53ef3\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:af6afc61bd6cbedda478787dea4003f1572787129a349349cdfc9eb38ab54838\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:859640189ee30ae6d5bb97c21a5462fa50c2e10965081b70fc0fe62483ca4b4b\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:7c73e2beca9b8306387efeaf775831440ec799b05a5f5c008a65bb941a1e91f6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\":\\\"sha256:f9c280b76b78d6087165b22334b64642cb3778f312374fc2ea1b637c649bd683\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\":\\\"sha256:f161671b511f21dcd29853f57d7362b4984e792630c977ffdc674f717779ba72\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":127,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:32:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'apply-tags' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:3f89ba89cacf8547261b5ce064acce81bfe470c8ace127794d0e90aebc8c347d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"latest\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git' and commit '19a01971a39db7e50c40e6db8405dfa957eec70b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-model-controller-v2-24-on-push-6c64x|odh-model-controller-v2-24-on-push-6c64x> - 2025-08-27T18:37:11\\nStatus: Failed :failed:\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:07Z\",\n                \"finishedOn\": \"2025-08-27T18:37:12Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:13Z\",\n                \"finishedOn\": \"2025-08-27T18:37:18Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"d10e457ed421f3c7bc22d8df89068c9b7ac317c2\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/odh-model-controller\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"d10e457ed421f3c7bc22d8df89068c9b7ac317c2\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756319813\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"d10e457\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/odh-model-controller\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:046ae40ba1cc75413badcaa1c80ee91709c784772c8abba8b2c627635392fa4a\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:19Z\",\n                \"finishedOn\": \"2025-08-27T18:37:27Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:0da734a811d57810f80202cceb2d79051d1de150f39f7689c5415f655598d62f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:298c8a06c501915e7038d45aa91d7172815d0a00d538785401504f90bc82ca8d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:37:28Z\",\n                \"finishedOn\": \"2025-08-27T18:38:41Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64@sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:7fd71c00ad9b7098f0d794deb1703b0062c07b81693282c50552e9e4b16c4237\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:40:31Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-ppc64le@sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:cb75c372bdb33bd17b8be23aed5598a6306f1c4752503902ba0ffeec613b2ca9\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:45:40Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-s390x@sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:b66893c8784ff73cbfa1a52b305a34c0e47f904cbfbe9f93e0e2a019e7823542\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:47:04Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-m2xlarge-arm64@sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-m2xlarge-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:3d180cdc9845b7d1681fad09a7674cc544a6ee45805dad9dd1d716b672e7d2d5\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:38:41Z\",\n                \"finishedOn\": \"2025-08-27T18:45:30Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439, quay.io/rhoai/odh-model-controller-rhel9@sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d, quay.io/rhoai/odh-model-controller-rhel9@sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859, quay.io/rhoai/odh-model-controller-rhel9@sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24@sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:7bdc50f68edc2df3da352f90c146580a83351643f3eb1171442b9da6bd41c2ef\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:05Z\",\n                \"finishedOn\": \"2025-08-27T18:47:20Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:sha256-40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b.src\\\", \\\"image_digest\\\": \\\"sha256:9f30f610f27f49c16b415291d0c31294984b311b7baa61c620428c12d7f60f4b\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b.src@sha256:9f30f610f27f49c16b415291d0c31294984b311b7baa61c620428c12d7f60f4b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:9f30f610f27f49c16b415291d0c31294984b311b7baa61c620428c12d7f60f4b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:sha256-40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:22Z\",\n                \"finishedOn\": \"2025-08-27T18:48:12Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:35+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:37Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:35+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T19:04:39Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:30+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:31Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\":\\\"sha256:f8f32d494e7d1cba9974140d9aa382d4aa804130b61067266d146f4061ad9658\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\":\\\"sha256:466edc9b3248e9e4a76d9244d938a220ddba28be021c9aa4848fb35e1b472e66\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\":\\\"sha256:964e591259d0e6099dc68278534972c13028ffd864d4db43d72fb02c62eb06ad\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\":\\\"sha256:01c6e4cb3745aba81532939378217bc8069a9260fafcfdd9e9e6ef566817dfbe\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":76,\\\"low\\\":151,\\\"unknown\\\":8}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:48:34+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:48:35Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756320491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:48:17Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:40+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:43Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756320563\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:49:27Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:28Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:0880f37248eb31ebc81c9b48369c36a6c795d5be65fa04935a18613345aa24e4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:29Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\", \\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\", \\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\", \\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\", \\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:30+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:30Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-27T19:04:39Z\",\n                \"finishedOn\": \"2025-08-27T19:04:44Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T19:04:44Z\",\n                \"finishedOn\": \"2025-08-27T19:04:51Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n    material.digest.sha1 == \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'coverity-availability-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T10:11:59+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:54Z\",\n                \"finishedOn\": \"2025-09-04T10:12:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:f3d2d179cddcc07d0228d9f52959a233037a3afa2619d0a8b2effbb467db80c3\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\",\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\",\\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1763575625\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:44Z\",\n                \"finishedOn\": \"2025-11-19T18:07:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:09Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:2e2d1bafb57422191e4a181d2b365689dcf9c0786df355ca748c5ffb0632357a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:04:07Z\",\n                \"finishedOn\": \"2025-09-04T07:07:38Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:01bb6fd842fa4f3630f797161c4b0389e932fc8995c2cf1cdf62c17526f16f50\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:08:09Z\",\n                \"finishedOn\": \"2025-09-04T07:13:39Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:30fabdd7a3a66780e8ae4c4da0b97b5ce4812918c9a7cfd245e9b46b0e4f359d\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:09:09Z\",\n                \"finishedOn\": \"2025-09-04T07:15:22Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:606dd5b32ee93a3b733de7343e05cd910473425e24a808918fd8f977ac1358cd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:03:07Z\",\n                \"finishedOn\": \"2025-09-04T07:10:15Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:844e87596d4e75733b5863f5343a9fcb8ee28ba04835390e7a298a55da13303e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:23Z\",\n                \"finishedOn\": \"2025-09-04T07:17:38Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:47+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:48Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\":\\\"sha256:9f280cc0d2093d95dfba3a0a050fc39ed9977c7d829e6e389f08d6dcfad1f478\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\":\\\"sha256:28eaabd9496b4451a73b82ebd4106e9b5c856eaeb460244501650e361e4c66ef\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\":\\\"sha256:b4993c129faaf7ba0dcaf0aeeb7598ca6099ae3ff51087689875d65dc5086f41\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\":\\\"sha256:3f33e229bd14925b2b180d5c06e8301a134a7ab6ebf38c16c722ce100619d782\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:54+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:55Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970431\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:39Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\"\n              },\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:45+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:46Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:02Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:47Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:08f0413958c10027ce982f1d120c2377f7f0740643245567430226ac0bed6312\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:54Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\", \\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\", \\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\", \\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\", \\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:48+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:49Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:21:36Z\",\n                \"finishedOn\": \"2025-09-04T07:21:42Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:4c2b0a2d2904108f8d19edfa878df6cd49ed19aab73ab6fc6a435fba0265f771\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\", \\\"digests\\\": [\\\"sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\\\",\\\"sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\\\",\\\"sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\\\",\\\"sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\\\",\\\"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:23:15+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:22:32Z\",\n                \"finishedOn\": \"2025-08-20T16:23:17Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:0150cab600b59e5382cb28b1e6c1c130c7638b319b3cc8c43f07801daec0bf5e\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:1f6e2c9beba52d21c562ba1dea55f579f67e33b80099615bfd2043864896284d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970294\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit 'aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b, quay.io/rhoai/odh-model-controller-rhel9@sha256:1d416eaa1ef456e4243d3372dc25a4c8820654a0a2b517edba4aecf9474489be, quay.io/rhoai/odh-model-controller-rhel9@sha256:8ddf267b9c37170a06465f93443f600bf470239e03c47f2c096d0f6d6e6e0d63, quay.io/rhoai/odh-model-controller-rhel9@sha256:d1cf2dc47b1c139e39bd1c34edd8c33d03ffbc42638526c8f48429294934555e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24@sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:00d3cbee63dc0a7f1a1d3d9bf7ef01466fb17ab02ae3f2bd7c9aecc3fbf46251\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:42Z\",\n                \"finishedOn\": \"2025-08-28T14:20:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"ec79b74a364e0ce075d4c6074e9aa4a62c32b66f\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"IMAGES\": [\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-x86-64@sha256:1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-ppc64le@sha256:1d416eaa1ef456e4243d3372dc25a4c8820654a0a2b517edba4aecf9474489be\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-s390x@sha256:8ddf267b9c37170a06465f93443f600bf470239e03c47f2c096d0f6d6e6e0d63\",\n                      \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24-linux-m2xlarge-arm64@sha256:d1cf2dc47b1c139e39bd1c34edd8c33d03ffbc42638526c8f48429294934555e\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"55338cfbe69f4c9b431ff8b1db14890a5a5bd352a94ed2f181ea5820282e0d59\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"7fbb3e77a957d95a869904c849ff3a3615732e1831ceb663aabca31b938a5c44\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"49596800ba5409748f4a7d93d9be8962bf12b330bba1d176bc5461f7d54cd9cd\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"f582ff2e505f3b12bf8152e957b056b22cca38101d779dc4241fac4c5efc1f18\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:11Z\",\n                \"finishedOn\": \"2025-08-20T16:10:17Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:7e7446e238976c3832d1e26feee86f92a43836808a7153a587cf22804a0e2e8a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:16Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"rhoai-2.24-5963a6cc76fa32879f860e9b2df35fa9428106a0\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:59094118aa07d5b0199565c4e0b2d0f4feb9a4741877c8716877572e2c4804f9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\",\\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\",\\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746736708\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:38:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"632adedacf538382e56cc272c6986beb3c8925e2\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/rhods-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"632adedacf538382e56cc272c6986beb3c8925e2\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756324494\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"632aded\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/rhods-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:646a873620f805bac8968cd56bea08b24b2a98b258d27607644f988c56235ec8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:56:09Z\",\n                \"finishedOn\": \"2025-08-27T19:56:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"632adedacf538382e56cc272c6986beb3c8925e2\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/red-hat-data-services/rhods-operator\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:002f7c8c1d2f9e09904035da414aba1188ae091df0ea9532cd997be05e73d594\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:41:33Z\",\n                \"finishedOn\": \"2025-06-10T04:41:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:569165278e3c85e3b897abad9f6d714d76be4b061f44f5f7614ed1c83ad117b4\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:36Z\",\n                \"finishedOn\": \"2025-11-12T05:17:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"30ced5ced31a297b33161899650f6f5e3b092bb5759ff816cf23b3b3f7e00da3\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:19:45Z\",\n                \"finishedOn\": \"2025-09-04T07:19:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:02+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'validate-fbc' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:5ad28ce898a5b4bcaaf3b17d80f30fb377e7229f43219076bb2579c52e241bdb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\\\",\\\"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\\\",\\\"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\\\",\\\"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\\\",\\\"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:21+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:fb6072b3f89b63ef55625fc149ee6bfdd3ae069effbacf959b7d978b4a4a5e97\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d50469e258b29064b58e5f153fac246306c4959c8b58930aad3dec91662d59a2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:26:24Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:4c2b0a2d2904108f8d19edfa878df6cd49ed19aab73ab6fc6a435fba0265f771\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:cc8aa3bf9aa8c30f43bc52dae31ebcbcbe03f7364fe12dd0943e3c8fb584773a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:15Z\",\n                \"finishedOn\": \"2025-09-04T07:16:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\",\n                      \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:06Z\",\n                \"finishedOn\": \"2025-05-08T19:13:12Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords-ui\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1746709408\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"142abbe\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/quipucords/quipucords-ui\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:f87c0cccd5a5906aab86b966a42847362c57198cf2e4c2e49b9376e65932b240\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:12Z\",\n                \"finishedOn\": \"2025-05-08T19:13:22Z\"\n              },\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:23Z\",\n                \"finishedOn\": \"2025-05-08T19:13:34Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:22Z\",\n                \"finishedOn\": \"2025-05-08T19:13:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:12efa4ba2a16013318256c9275308637a8f7375552fdf944b4514aa251eeafa5\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:50Z\",\n                \"finishedOn\": \"2025-05-08T19:15:26Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:ea2bf4de2bc002139fc1f430d6f994a61e04b6358043aee63b633911ebdc4da5\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:50Z\",\n                \"finishedOn\": \"2025-05-08T19:20:51Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755@sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:976058e10b643ac4df6aa99e1090a74ba305e11dd660d4336d6f2710f53c7ff0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:20:51Z\",\n                \"finishedOn\": \"2025-05-08T19:21:13Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\\\", \\\"image_digest\\\": \\\"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src@sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c0135c390faf6188b67b32ec42b350f23a114d8bf39ecbafa16ce11d455e050c\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:sha256-0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:22:20Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:22+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:23Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\":\\\"sha256:d0af342fc5f40e968e180cf7e1fa127968d92060cd33270c86eb8fa511da61c8\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\":\\\"sha256:baa7690ba743163a9a77694894dbf63d8ebcf93bd5220e1af2bc77c8b107c009\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":582,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:23:04+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:05Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"1746732115\\\",\\\"note\\\":\\\"Task preflight is a SUCCESS: Refer to Tekton task logs for more information\\\",\\\"successes\\\":16,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:57Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:41+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:43Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1746732213\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:36Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:30+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:31+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:22Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:6b3ac50656ff1380a59dbaf04852be5c453fcfbd792b849fe54a4560c5655bf1\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:20Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-05-08T19:23:36Z\",\n                \"finishedOn\": \"2025-05-08T19:23:44Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:19:52Z\",\n                \"finishedOn\": \"2025-09-04T07:19:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\", \\\"digests\\\": [\\\"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\\\",\\\"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\\\",\\\"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\\\",\\\"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\\\",\\\"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:58+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:24Z\",\n                \"finishedOn\": \"2025-08-20T16:26:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:d50469e258b29064b58e5f153fac246306c4959c8b58930aad3dec91662d59a2\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:21:36Z\",\n                \"finishedOn\": \"2025-09-04T07:21:42Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970300\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:3ca52e1d8885fc229bd9067275f44d5b21a9a609981d0324b525ddeca909bf10\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:15Z\",\n                \"finishedOn\": \"2025-11-12T05:17:22Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:c5e56643c0f5e19409e86c8fd4de4348413b6f10456aa0875498d5c63bf6ef0e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:e371aa09c65ab309138b4aeae9ea4dd93f83119c5cc61e9f2057fe5bb518fbe9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T10:13:05+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta success: Snyk code test found zero supported files.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:12:55Z\",\n                \"finishedOn\": \"2025-09-04T10:13:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:08f0413958c10027ce982f1d120c2377f7f0740643245567430226ac0bed6312\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"manager/Containerfile.manager\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:302828e9d7abc72b8a44fb2b9be068f86c982d8e5f4550b8bf654571d6361ee8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:7edb309beed3bb301afcb68baf304e32602f766013e6ac0b72648dd0da2ab627\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"bundle/Dockerfile\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"IMAGE_DIGEST\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:5d0d9cc31381c5ef4093c7800e0528cda1d07d5db2d7ae733132e54870bb2dbc\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1749529764\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:43Z\",\n                \"finishedOn\": \"2025-06-10T04:29:58Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:15214d7736224455f1f2782c05df3239d0145f5e7e900e9a1055ee421e31d62d\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:34:34Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:3b9b1fa1081a50d3e1ec754351f0780b2a867433a73569c1e9573ee7c2653d5a\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:35:55Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:ac2de036a80ebc574f2711bc803c19927040e45caf779bf59dfa58b725ac4f47\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:39:39Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336@sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:5ac20d525495a4d6d449da38763187a47edb291acd70efa1dbbd8a14f75d8048\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:39Z\",\n                \"finishedOn\": \"2025-06-10T04:39:54Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\":\\\"sha256:e0d0adf148dff15572a04ce4b6460b554d03f42b09b57ea14358ced4d23acd55\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\":\\\"sha256:76a6956e29a5c71dbf068910bfe68159d3023cf9742b6d08c70f3d640709af4a\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\":\\\"sha256:8dfada9f7864c5e3d48eecb585f195ee321dbbfa71cfb62f26cd137b5f4fce7d\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":9,\\\"medium\\\":21,\\\"low\\\":21,\\\"unknown\\\":12}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:39Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749530486\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:28Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\", \\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\", \\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\", \\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 329, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:47Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:41:33Z\",\n                \"finishedOn\": \"2025-06-10T04:41:40Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:57:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:18+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:25:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'sast-shell-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:57b3262138eb06186ae7375f84ca53788bba2a66cfd03d39cb82c78df050aba5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:30+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\\\",\\\"sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\\\",\\\"sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\\\",\\\"sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\\\",\\\"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:16:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:15Z\",\n                \"finishedOn\": \"2025-08-20T16:16:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:10:56Z\",\n                \"finishedOn\": \"2025-09-04T10:11:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:9a6ec5575f80668552d861e64414e736c85af772c272ca653a6fd1ec841d2627\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:1c6f673fe100a49f58aaef62580c8adf0c397790964f4e7bac7fcd3f4d07c92e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"release-1.3\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:b6dc1948778552a53b863682f8d42dcdda8b25348b5a3b97efb2398ba17f290d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:00+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:818e582f4c8457fbbe9ede7b2075a1284be5fe240f2527278453df64bfda9030\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:28:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit 'aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:42+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:d0ee13ab3d9564f7ee806a8ceaced934db493a3a40e11ff6db3a912b8bbace95\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"build/Dockerfile.openshift\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:57b3262138eb06186ae7375f84ca53788bba2a66cfd03d39cb82c78df050aba5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:36+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:57+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:30Z\",\n                \"finishedOn\": \"2025-09-04T07:16:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:23:55Z\",\n                \"finishedOn\": \"2025-08-27T20:24:01Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\\\",\\\"sha256:8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\\\",\\\"sha256:9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\\\",\\\"sha256:439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\\\",\\\"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:05+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:43Z\",\n                \"finishedOn\": \"2025-08-20T16:27:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:clusterresourceoverride-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'clone-repository' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad213d00cdcff677600177ba5ce759582a9e\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad213d00cdcff677600177ba5ce759582a9e\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"aacdad2\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:c1e5417d30e75e853a01051918326c31a9e19848a227dd8b7238fe206d8d2df0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:00Z\",\n                \"finishedOn\": \"2025-08-20T15:47:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"aacdad213d00cdcff677600177ba5ce759582a9e:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-sriov-network-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"aacdad213d00cdcff677600177ba5ce759582a9e\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/rhoai-konflux/alpine' and commit '149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/rhoai-konflux/alpine\",\n              \"digest\": {\n                \"sha256\": \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/rhoai-konflux/alpine\"\n    material.digest.sha1 == \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:70881c97a4c51ee1f4d023fa1110e0bdfcfd2f51d9a261fa543c3862b9a4eee9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:15:33Z\",\n                \"finishedOn\": \"2025-08-20T16:15:42Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"ocp__4.17__ose-ptp-rhel9-operator\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:3dc39eae48745a96097c07c577b944d6203a91c35d3f71d9ed5feab41d327a6a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1762924605\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"fcef9ef\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/rhobs/konflux-coo-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:26Z\",\n                \"finishedOn\": \"2025-11-12T05:17:35Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodulePaths\": \"\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/rhobs/konflux-coo-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-container'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-oci-ta:0.4@sha256:c9ef8d723f5c3d65ec910d6fdb74607332620289ab083d6c97c602226fe7a8d2\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e@sha256:ba40cc963224ed6a19ea4bde441d88335982aab5ecfcafaa1b1420a156f4284b\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:f137fff6ca7db41b5b8d75d60aaa71df1c946bd536b4a64266d7dddee5783c63\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T10:11:16Z\",\n                \"finishedOn\": \"2025-09-04T10:11:48Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"af380340b19d316a235576db78456f3f087b279e\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile.bundle\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5:af380340b19d316a235576db78456f3f087b279e\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-bundle-globalhub-1-5@sha256:3262259ea8a7970edbab398c5c13226711b780013d1360f2ce05c0e1f95ee28b\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-container\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:f289abe0fb4f64dcd09b8f7cbae89da11a64db1f123b7fb8a9986dafe31e6bdd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T06:59:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:06Z\",\n                \"finishedOn\": \"2025-05-08T19:13:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'd2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"d2f9cec0697dc8f20d0dc5b5793b60e809584877ddfef61e445aada3cf3abcf9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\\\", \\\"sha256:957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 106, \\\"8a3872bf3228467c\\\": 4, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:17+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\",\n                    \"image-url\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:8f73fd977807d4e3dc322814b7f8d7c4b66da457ddb664a4f91c21244b91df9d\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:ba7fbed5c4862968c1a77d6b90d5bdd497925ab1de41b859c027dd5c3069cd3e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:31:26Z\",\n                \"finishedOn\": \"2025-08-28T18:31:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"false\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"IMAGES\": [\n                      \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24@sha256:eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:9a6ec5575f80668552d861e64414e736c85af772c272ca653a6fd1ec841d2627\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"09a9e208d89aecf957559e7e841b72cabbda4bc24d07607e9403b6cb957f004b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:aa344aaa6ba1be9a1c0053107f30da40cd04d7609627948789ce5c43b7ffeef4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:16Z\",\n                \"finishedOn\": \"2025-08-20T15:48:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:13:42+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-43d404726e1e132cd7c0588f2a09e4953-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:13:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\",\n                    \"image-digest\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'fbc-target-index-pruning-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\", \\\"digests\\\": [\\\"sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\\\",\\\"sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\\\",\\\"sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\\\",\\\"sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\\\",\\\"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:17:41+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:16:57Z\",\n                \"finishedOn\": \"2025-08-20T16:17:42Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:0f42ac97c44f0f0b4c704f64e26b6d1390de485a62bb48aba051de4d72e81f4c\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T19:56:03Z\",\n                \"finishedOn\": \"2025-08-27T19:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'deprecated-base-image-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"1921d8a747b0df873401424c69e098b8295b0c6ca905ddf7325a9faa737b238b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"1d416eaa1ef456e4243d3372dc25a4c8820654a0a2b517edba4aecf9474489be\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"8ddf267b9c37170a06465f93443f600bf470239e03c47f2c096d0f6d6e6e0d63\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"d1cf2dc47b1c139e39bd1c34edd8c33d03ffbc42638526c8f48429294934555e\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-model-controller-rhel9\",\n            \"digest\": {\n              \"sha256\": \"6e8b20cf07b5b718aa540bd41dc55cd5765d67e95cc3d988dcf80ac480f24639\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clone-repository' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756405785\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"adf575f\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:8778fab3c5f7008b95d070c4eb3503fad30c657499cd6c59bf3f6799be10eea8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:30:43Z\",\n                \"finishedOn\": \"2025-08-28T18:30:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"adf575fd0fcaaf93708eb372d2f68313384e4e4a\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:49+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.2@sha256:e0de426d492e195f59c99d2ea1ca0df7bfb8c689f5d1468fe7f70eb8684b8d02\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all subject names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit 'aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:8f73fd977807d4e3dc322814b7f8d7c4b66da457ddb664a4f91c21244b91df9d\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970294\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:10Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b30d58fc0d923907b368b4d8518d9f6623ed51aaf756d94dfa723d26dc29c604\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:21Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"58e6512b6dc3ca99e1f8674b1cd8a68039754a6f\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a8c5e2a153be2469c8ae83b3f7e16b0004eeaa7212eed629b7799349f0c12dc8\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:b6dc1948778552a53b863682f8d42dcdda8b25348b5a3b97efb2398ba17f290d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:00+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:818e582f4c8457fbbe9ede7b2075a1284be5fe240f2527278453df64bfda9030\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:28:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:57+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:30Z\",\n                \"finishedOn\": \"2025-09-04T07:16:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756325154\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:06:14Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:cfeeef2f4ab25b121afdf44eecc394ed67f3534a1bd14bef9e7beef2ee654b8e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:15214d7736224455f1f2782c05df3239d0145f5e7e900e9a1055ee421e31d62d\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:34:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"COMMIT_SHA\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"build/Dockerfile.openshift\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"LABELS\": [],\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:27:26+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:27:15Z\",\n                \"finishedOn\": \"2025-08-20T16:27:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:07dcbe80302c99903bb5e9872ac9a63edd830f39a012f0505020229b73c525f3\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:d9423b0fc107405234be561a985b1daec645c20ec62efedaee7d4df2661463d9\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:cluster-nfd-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'sast-snyk-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:9a6ec5575f80668552d861e64414e736c85af772c272ca653a6fd1ec841d2627\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'build-images' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\", \\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\", \\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\", \\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\", \\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:18:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\",\\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\",\\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\",\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\",\\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756325154\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:06:14Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '4072de81ade0a75ad1eaa5449a7ff02bba84757064549a81b48c28fab3aeca59'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:00:56Z\",\n                \"finishedOn\": \"2025-11-19T18:01:02Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://gitlab.com/redhat/hummingbird/containers\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1763544424\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"001e77d\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://gitlab.com/redhat/hummingbird/containers\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:464282534bb5c2384429cca983cdae44b8a53d1b96e02cc055e85cbd6b240ee5\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:01:02Z\",\n                \"finishedOn\": \"2025-11-19T18:01:23Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:873a0cbcf9d1533b4d9c1b3de2c47451f8b5a10aa0c3e17bfc45f6b439042854\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:23112147958e0b86932d12e16208081a8aff6ccb099194f2346842dc3d0f96c6\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:01:24Z\",\n                \"finishedOn\": \"2025-11-19T18:03:01Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476@sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:d9156385290597ab7b708b991065a908c56181023f50276e2d8c2b5bfce8636b\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:03:01Z\",\n                \"finishedOn\": \"2025-11-19T18:06:28Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476@sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:66d49e29c39d9d4d53199cf03ba786b3a526aa2900a9efee136354e7e5ad83f6\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:03:01Z\",\n                \"finishedOn\": \"2025-11-19T18:05:22Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6, quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:347c70e22cd8aaf5d511a734ae857ca30c0f0d52cd3480106275407ddb45e8f4\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:28Z\",\n                \"finishedOn\": \"2025-11-19T18:06:43Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:sha256-c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a.src\\\", \\\"image_digest\\\": \\\"sha256:b2c7030cb6001d87e7c481849c69c2aff64ad3bf6f8fda456880815378e74ce8\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:sha256-c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a.src@sha256:b2c7030cb6001d87e7c481849c69c2aff64ad3bf6f8fda456880815378e74ce8\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:b2c7030cb6001d87e7c481849c69c2aff64ad3bf6f8fda456880815378e74ce8\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:sha256-c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:08:12Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\",\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\",\\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:33+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:07:34Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\",\\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\":\\\"sha256:80219b2b773bf64ac7daa459dd9ca7a8d2a674b459cae11b79153fa8526e949e\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:06:53+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:54Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\",\\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\":\\\"sha256:d2c51f77b8a276b13db5d77b93d41898a5d7093f0bbdff07fa6ca0a8f402c43f\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:06:53+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:53Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\",\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\",\\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"ERROR\\\",\\\"timestamp\\\":\\\"1763575620\\\",\\\"note\\\":\\\"Task preflight is a ERROR: Refer to Tekton task logs for more information\\\",\\\"successes\\\":8,\\\"failures\\\":6,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:07:01Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:25+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:44Z\",\n                \"finishedOn\": \"2025-11-19T18:07:26Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\",\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\",\\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1763575625\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:44Z\",\n                \"finishedOn\": \"2025-11-19T18:07:08Z\"\n              },\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:08+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:07:08Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:43+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:07:44Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:07:12+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:07:14Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:50Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main@sha256:d279d2994a70e37364c3011481d5b7ab742c27360b21bfe4255acc35239dbd93\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:53Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\", \\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\", \\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:06:51+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:52Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"4072de81ade0a75ad1eaa5449a7ff02bba84757064549a81b48c28fab3aeca59\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:02+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:11:31Z\",\n                \"finishedOn\": \"2025-08-20T16:11:37Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-bundle-v2-24-on-schedule-v25hr|odh-operator-bundle-v2-24-on-schedule-v25hr> - 2025-08-27T20:23:54\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:23:50Z\",\n                \"finishedOn\": \"2025-08-27T20:23:54Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:23:55Z\",\n                \"finishedOn\": \"2025-08-27T20:24:01Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"a20675aa9508dd931c05a0d76d221916c737e85a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"a20675aa9508dd931c05a0d76d221916c737e85a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756326217\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"a20675a\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:5d0d9cc31381c5ef4093c7800e0528cda1d07d5db2d7ae733132e54870bb2dbc\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:01Z\",\n                \"finishedOn\": \"2025-08-27T20:24:10Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:5d0d9cc31381c5ef4093c7800e0528cda1d07d5db2d7ae733132e54870bb2dbc\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:10Z\",\n                \"finishedOn\": \"2025-08-27T20:24:17Z\"\n              },\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24@sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:4d5f6d63f2f16fc0a678d782d5c7002434d6cd7d0c20e74c6dcefef7fcc228d8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:18Z\",\n                \"finishedOn\": \"2025-08-27T20:24:44Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:44Z\",\n                \"finishedOn\": \"2025-08-27T20:24:50Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": false, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/rhoai/odh-operator-bundle:sha256-1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca.src\\\", \\\"image_digest\\\": \\\"sha256:e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca.src@sha256:e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:02+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:42:05Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:24:58+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check success: No base images to check.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\":\\\"sha256:9f73523320f39da5c5bf5c0d0e3926036666bad2d3a1724168ce3065ae50f950\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:02+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:02Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:25+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:32Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:02+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta success: Snyk code test found zero supported files.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756326313\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:22Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:7edb309beed3bb301afcb68baf304e32602f766013e6ac0b72648dd0da2ab627\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:24:57+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:57Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-27T20:42:05Z\",\n                \"finishedOn\": \"2025-08-27T20:42:10Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T20:42:10Z\",\n                \"finishedOn\": \"2025-08-27T20:42:15Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:12:03Z\",\n                \"finishedOn\": \"2025-08-28T14:12:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:34Z\",\n                \"finishedOn\": \"2025-06-10T04:29:43Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1749529764\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"5b9f7b8\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift/file-integrity-operator\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:43Z\",\n                \"finishedOn\": \"2025-06-10T04:29:58Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:15214d7736224455f1f2782c05df3239d0145f5e7e900e9a1055ee421e31d62d\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:34:34Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:3b9b1fa1081a50d3e1ec754351f0780b2a867433a73569c1e9573ee7c2653d5a\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:35:55Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:ac2de036a80ebc574f2711bc803c19927040e45caf779bf59dfa58b725ac4f47\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:28Z\",\n                \"finishedOn\": \"2025-06-10T04:39:39Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704, quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336@sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:5ac20d525495a4d6d449da38763187a47edb291acd70efa1dbbd8a14f75d8048\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:39Z\",\n                \"finishedOn\": \"2025-06-10T04:39:54Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:03+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":2}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:03Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\":\\\"sha256:e0d0adf148dff15572a04ce4b6460b554d03f42b09b57ea14358ced4d23acd55\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\":\\\"sha256:76a6956e29a5c71dbf068910bfe68159d3023cf9742b6d08c70f3d640709af4a\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\":\\\"sha256:8dfada9f7864c5e3d48eecb585f195ee321dbbfa71cfb62f26cd137b5f4fce7d\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":9,\\\"medium\\\":21,\\\"low\\\":21,\\\"unknown\\\":12}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:38+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:39Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749530486\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:28Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:02Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\", \\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\", \\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\", \\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 329, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:47Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-06-10T04:41:33Z\",\n                \"finishedOn\": \"2025-06-10T04:41:40Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"66e90d31e1386bf516fb548cd3e3f0082b5d0234b8b90dbf9e0d4684b70dbe1a\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'validate-fbc' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:b6dc1948778552a53b863682f8d42dcdda8b25348b5a3b97efb2398ba17f290d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:00+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:818e582f4c8457fbbe9ede7b2075a1284be5fe240f2527278453df64bfda9030\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:28:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:13:22+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:20Z\",\n                \"finishedOn\": \"2025-08-20T16:13:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:63cc9fef3ac927c93ad7ffe9c1eff75eb4afc9ad9804ac37840754bd211f59b0\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git' and commit '19a01971a39db7e50c40e6db8405dfa957eec70b'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rhoai-init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"git\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"skip-slack-message\",\n                    \"type\": \"string\",\n                    \"value\": \"false\"\n                  },\n                  {\n                    \"name\": \"slack-message-failure-text\",\n                    \"type\": \"string\",\n                    \"value\": \":alert: <https://konflux-ui.apps.stone-prod-p02.hjvn.p1.openshiftapps.com/ns/rhoai-tenant/pipelinerun/odh-operator-bundle-v2-24-on-schedule-v25hr|odh-operator-bundle-v2-24-on-schedule-v25hr> - 2025-08-27T20:23:54\\nStatus: Failed :failed:\\nCC - <!subteam^S05B904NQ6L|openshift-ai-devops>\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:23:50Z\",\n                \"finishedOn\": \"2025-08-27T20:23:54Z\"\n              },\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:23:55Z\",\n                \"finishedOn\": \"2025-08-27T20:24:01Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"a20675aa9508dd931c05a0d76d221916c737e85a\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"a20675aa9508dd931c05a0d76d221916c737e85a\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756326217\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"a20675a\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/red-hat-data-services/RHOAI-Build-Config\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:5d0d9cc31381c5ef4093c7800e0528cda1d07d5db2d7ae733132e54870bb2dbc\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:01Z\",\n                \"finishedOn\": \"2025-08-27T20:24:10Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/rhoai/odh-operator-bundle@sha256:5d0d9cc31381c5ef4093c7800e0528cda1d07d5db2d7ae733132e54870bb2dbc\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:10Z\",\n                \"finishedOn\": \"2025-08-27T20:24:17Z\"\n              },\n              {\n                \"name\": \"build-container\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24@sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:4d5f6d63f2f16fc0a678d782d5c7002434d6cd7d0c20e74c6dcefef7fcc228d8\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:18Z\",\n                \"finishedOn\": \"2025-08-27T20:24:44Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:44Z\",\n                \"finishedOn\": \"2025-08-27T20:24:50Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": false, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/rhoai/odh-operator-bundle:sha256-1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca.src\\\", \\\"image_digest\\\": \\\"sha256:e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca.src@sha256:e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e8f666d0bf18f51ef7188079e7b307e35d4d0ffaa934d200f041dfc38539a697\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle:sha256-1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:01+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:02+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:42:05Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:24:58+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check success: No base images to check.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\":\\\"sha256:9f73523320f39da5c5bf5c0d0e3926036666bad2d3a1724168ce3065ae50f950\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:02+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:02Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:25+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:32Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:02+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta success: Snyk code test found zero supported files.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:51Z\",\n                \"finishedOn\": \"2025-08-27T20:25:03Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756326313\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:22Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-operator-bundle@sha256:7edb309beed3bb301afcb68baf304e32602f766013e6ac0b72648dd0da2ab627\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:58Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:24:57+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:24:57Z\"\n              },\n              {\n                \"name\": \"pipeline-success-indicator\",\n                \"status\": \"Succeeded\",\n                \"startedOn\": \"2025-08-27T20:42:05Z\",\n                \"finishedOn\": \"2025-08-27T20:42:10Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-27T20:42:10Z\",\n                \"finishedOn\": \"2025-08-27T20:42:15Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/rhoai-konflux-tasks.git\"\n    material.digest.sha1 == \"19a01971a39db7e50c40e6db8405dfa957eec70b\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:ca036c7232f63199824bc1a65126faad834bc3af030e5b8210cb057f4ae97d99\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:12Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:47:30+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":2,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:31Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\",\n                    \"IMAGE_URL\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:ac54d610a01f76d7994575d7eae30d03179483c64c2f2469b68bb49e1699846a\\\",\\\"sha256:ce84801e15385e996afd588bc64b19022346bc897fa41f4128a87e3a60c189f1\\\",\\\"sha256:73a0026a6e9a82a12287588140c3e26e5a7840ec8846f8110749e0237a62a0eb\\\",\\\"sha256:3d32ff3f08bca82137df7b9610a2a31e3de1008a50abf4d002aebb2141131505\\\",\\\"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:09:24+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:08:53Z\",\n                \"finishedOn\": \"2025-08-20T16:09:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:83458ad5050a48b9b279c6665d28907b301e46d77ef661e317055c34cff004a1\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:openshift-kubernetes-nmstate-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clone-repository' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c44d692\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:fa3ba947fecb9757e63793593f81597da85e587638d710d15b2e391b22c5660c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:59Z\",\n                \"finishedOn\": \"2025-08-20T15:47:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ptp-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:45+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:6851c7f701a40a63193431a3dbda2095accdc40e03ecb66a6b1cebf8851f337b\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:58:04Z\",\n                \"finishedOn\": \"2025-09-04T07:01:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\\\",\\\"sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\\\",\\\"sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\\\",\\\"sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\\\",\\\"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:10+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:25:11Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clamav-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970294\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:893ffa3ce26b061e21bb4d8db9ef7ed4ddd4044fe7aa5451ef391034da3ff759\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\\\":\\\"sha256:9f73523320f39da5c5bf5c0d0e3926036666bad2d3a1724168ce3065ae50f950\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:02+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:1d6db52319daf9fd5f883ddbd38ab9c8356b58c344f8f28433a1363113ed71ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a2b365ba325033f584af47d21d30570270\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a2b365ba325033f584af47d21d30570270\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"0df535a\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:01Z\",\n                \"finishedOn\": \"2025-08-20T15:47:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"0df535a2b365ba325033f584af47d21d30570270:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-ose-smb-csi-driver-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"0df535a2b365ba325033f584af47d21d30570270\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:25+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\",\n                    \"image-url\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src\\\", \\\"image_digest\\\": \\\"sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src@sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:707328df68589619ea5a45124a4f087f88e02dfe46c97dd48da74bc77adda7a2\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:sha256-ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.3@sha256:7a36cc284c5932c18e117fe5995f3246b5dcc11ec742b66a2f9ae710034b064f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\\\", \\\"image_digest\\\": \\\"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src@sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:sha256-921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:36Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"BINARY_IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:6e1707cc9cb00598e742cbe3bfe718b91fed10ac7ef95a6b47d8ae2f337be425\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:381987bc72b77393d3ddba058d4e2816bda0d0d5ac5dbec7aba1d2d04223098d\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:59Z\",\n                \"finishedOn\": \"2025-08-20T16:16:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"841e003b8c398ccebffee99100db698a83b77667\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b857c7224355a258789f6eb487173ae72b1fa70e4f1cf74eae05cab1eefe96e3\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:1282669abed78b6c11eb174802b91d2712db96377e371494acad6fd9eb69d556\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:5ceef5e9ab13e3899b57fc0eeb0f8269a9c67710eae02c1727a45e19b41ba739\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-gcp-filestore-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:cb6dff0d9bdd8a0fb165689014e68f264d95166a101ff216ef0fefd1ef7228ce\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:04:56+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:04:00Z\",\n                \"finishedOn\": \"2025-08-20T16:04:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:f2260146ed573a6dbf4fb5d45f75ef567744a7d7785835547b705b9e5a6cf357\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:24+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/build-trusted-artifacts' and commit '2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/build-trusted-artifacts\",\n              \"digest\": {\n                \"sha256\": \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/build-trusted-artifacts\"\n    material.digest.sha1 == \"2ef0d9c985dbbe2edc49f2847fc0f5cf3c0d843b3726c1f256b1c6b846e1f223\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:12:52Z\",\n                \"finishedOn\": \"2025-08-20T16:12:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:68a8fe28527c4469243119a449e2b3a6655f2acac589c069ea6433242da8ed4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\\\":\\\"sha256:6c553e4b7971b4a358040f8590e28aea0b713d7824646cd03415783334a4ffc8\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-06-10T04:32:58+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:47Z\",\n                \"finishedOn\": \"2025-06-10T04:32:58Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'push-dockerfile' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:278f84550844c1c050a65536799f4b54e7c203e0ac51393aa75379dd974c82e9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:6b3ac50656ff1380a59dbaf04852be5c453fcfbd792b849fe54a4560c5655bf1\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:20Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGE_DIGEST\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'deprecated-base-image-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:1d07d16810c26713f3d875083924d93697900147364360587ccb5a63f2c31012\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6383e8c961c957689d94da789267e28f69c955b83721b1ead6eebfee6ce3cb87\\\",\\\"sha256:12e73e668b6581321d242a1a6b8886fc5ac6081c602532794d83a56dfb5403e4\\\",\\\"sha256:f39e74557a34fde7457214f16b37baa47e7a0c24925e0f0f45e1410967311456\\\",\\\"sha256:4a99423e2b0bdeff7c342cc148ce391621542b78092229a4d1106cea4ebcf4f3\\\",\\\"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:39+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:05:30Z\",\n                \"finishedOn\": \"2025-08-20T16:05:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ac863d070bf4d14fb246a07867b0ac6ddacbb83346e6e92d734a3a98ef506a5e\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:846e52e4a14da403fa0cbd0251eab8248ab9230372c96f0566068ed1ccac5c66\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:12efa4ba2a16013318256c9275308637a8f7375552fdf944b4514aa251eeafa5\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:50Z\",\n                \"finishedOn\": \"2025-05-08T19:15:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \".tekton/downstream-build-arguments.conf\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"COMMIT_SHA\": \"142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Containerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"LABELS\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ],\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"{\\\"type\\\": \\\"npm\\\"}\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201@sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:abf744d9b5502fbb05bc850e0ef69f9aab70131e8fe825cfc20cc5a9e223201c\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:24:43Z\",\n                \"finishedOn\": \"2025-08-20T16:25:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"78f88369280abadef5251ec5434ffc59c84aca41\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:37f356d5e8c467aa491c407cf21ad9a20606fe7f43d08dd0f9f3a22ea44a493d\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:7c097592e530f0586cf99cc534d3b5e1c8a7d403c512238e657ff4ae5d9f35e4\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:77010d41ad2e68440ecd8625497e291dc8b4634bc0cf75b73e87f3e5cdc0285c\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:675ed33ca4ca7ed7eb63a94a408eec7247a93ff08be32b041c4e2d4f37222324\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.2@sha256:3f99dc4634a62e1530324cd565d12323ca82be3cfa8a031a36b210becfa7b552\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T17:49:25+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T18:06:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:f9e5de41b7014728d99c619c52decd58a0f716c3ff0204934fd101c47621a7c9\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9@sha256:d51070a3b8f9e9639db36c752f93448ea243d678d126c5197a02fd9f8b108c3c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"\",\n                    \"image-url\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:08Z\",\n                \"finishedOn\": \"2025-08-20T16:12:14Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"bb936a5\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:14Z\",\n                \"finishedOn\": \"2025-08-20T16:12:23Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2507faa738ab7f4469fd4c2982b61100cb6c37f435312b3e8d52ef8f22179845\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:24Z\",\n                \"finishedOn\": \"2025-08-20T16:12:29Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:8469fa35edcc772bb5dc4a6907044ca0940f0c297177524c344d5fe5a236fca5\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:30Z\",\n                \"finishedOn\": \"2025-08-20T16:14:06Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:a99321deb06a9f828fa6deffcab4ff56e1105dc73c6d443f32ecf4da7f722c32\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:30Z\",\n                \"finishedOn\": \"2025-08-20T16:16:15Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bd42fa64e2ed93de05294994dd60930527e651b3ce2b1799a63736e6f0b64eac\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:30Z\",\n                \"finishedOn\": \"2025-08-20T16:24:49Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:68357410c9d92fb6177862db9be52e5e458b5bcc8c14a0fbd5dfed1f974da503\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:30Z\",\n                \"finishedOn\": \"2025-08-20T16:18:25Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6db79e557b0a1326f64c7da65f62ebd954d30ee3d75e3812372d936685947b41\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:24:49Z\",\n                \"finishedOn\": \"2025-08-20T16:25:07Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:19+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:25:21Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:18+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:25:20Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\\\",\\\"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\\\",\\\"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\\\",\\\"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\\\",\\\"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:16+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:25:17Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:25:08Z\",\n                \"finishedOn\": \"2025-08-20T16:25:14Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\\\",\\\"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\\\",\\\"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\\\",\\\"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\\\",\\\"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:21+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":9,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:fb6072b3f89b63ef55625fc149ee6bfdd3ae069effbacf959b7d978b4a4a5e97\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d50469e258b29064b58e5f153fac246306c4959c8b58930aad3dec91662d59a2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:26:24Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\", \\\"digests\\\": [\\\"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\\\",\\\"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\\\",\\\"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\\\",\\\"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\\\",\\\"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:58+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:24Z\",\n                \"finishedOn\": \"2025-08-20T16:26:59Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\\\",\\\"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\\\",\\\"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\\\",\\\"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\\\",\\\"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:28:02+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-40d1586cc869e382d240fe0b4ddacdded-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":4,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:07Z\",\n                \"finishedOn\": \"2025-08-20T16:28:04Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:28:04Z\",\n                \"finishedOn\": \"2025-08-20T16:28:11Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\\\", \\\"digests\\\": [\\\"sha256:720a04c0729cd44f70db3e522c53079d91fdecb4120e8471a2ebf2528c250629\\\", \\\"sha256:f45b04f41083e21be9ecd4ae2e8e601d9b280eaaef10e78d48949088928c6de6\\\", \\\"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-19T18:06:51+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:06:43Z\",\n                \"finishedOn\": \"2025-11-19T18:06:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:c44b208d6d9c46bf384967c83d8e4545f07c48bf441d8db0c013ef24c6c2b00a\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6db79e557b0a1326f64c7da65f62ebd954d30ee3d75e3812372d936685947b41\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:24:49Z\",\n                \"finishedOn\": \"2025-08-20T16:25:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:22+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-dpu-operator-9rmqb-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:05:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\",\n                    \"image-digest\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:404f3bb83d250b75d7246db21a6bb8f09ba9f307ba781d448ac6825baae1ad4d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:04+00:00\\\",\\\"note\\\":\\\"Task coo-fbc-v4-20-on-push-m26gh-fbc-fips-check-oci-ta failed: Could not render unreleased bundle image: registry.redhat.io/cluster-observability-operator/cluster-observability-operator-bundle@sha256:04d900c45998f21ccf96af1ba6b8c7485d13c676ca365d70b491f7dcc48974ac. Make sure the image is accessible or a mirror is provided for the same in images-mirror-set.yaml\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:58Z\",\n                \"finishedOn\": \"2025-11-12T05:28:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"image-digest\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:d48c621ae828a3cbca162e12ec166210d2d77a7ba23b0e5d60c4a1b94491adeb\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:a71674cff30780dc10707ca87c8a2dd820fa2a26fc0c38ab08cca6a28a15be7f\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:f22e38f8a30ec25556717c420ddfd90f87df41c19125c2440caa1ec9a3d3ba5e\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:04Z\",\n                \"finishedOn\": \"2025-05-08T19:56:49Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"pip\\\", \\\"requirements_files\\\": [\\\"lockfiles/requirements.txt\\\"], \\\"requirements_build_files\\\": [\\\"lockfiles/requirements-build.txt\\\"]}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"lockfiles\\\"}, {\\\"type\\\": \\\"generic\\\", \\\"path\\\": \\\"lockfiles\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:e371aa09c65ab309138b4aeae9ea4dd93f83119c5cc61e9f2057fe5bb518fbe9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:52+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:40Z\",\n                \"finishedOn\": \"2025-09-04T07:20:53Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'fbc-target-index-pruning-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:13:22+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:20Z\",\n                \"finishedOn\": \"2025-08-20T16:13:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:63cc9fef3ac927c93ad7ffe9c1eff75eb4afc9ad9804ac37840754bd211f59b0\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'build-image-index' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201@sha256:61ea9d227ce07e7854114f4c0029f6a7836b4ec018aaf96050254649e5a2e553\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4d1b4c4f0531ddfa238a8d025cdd936b34ec111aa79e0d247ae0d490f65d3d2b\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:01Z\",\n                \"finishedOn\": \"2025-08-20T16:21:17Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:cfebc91d3880b8fc2773d133f9939ae0cad66f29cc9cc4bba72896f173672f10\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:39aa6ee3992d07788527388028abed0f236986fc6790cc8ce3c05aac6f155744\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:e667bc183ac9491888553fdd9e3c5029251621cd6ccb501ee10129096176522d\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:82a2c1bc4a0fc963fed5f88ddecf5b39160fb848410749a747a3582c8658a087\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List all task names in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:cb391e9cc8dba50e02588d5809b4c7f0ee0573b99a49b68bb0461972326d84d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:08Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:57:31Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:f289abe0fb4f64dcd09b8f7cbae89da11a64db1f123b7fb8a9986dafe31e6bdd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T06:59:47Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:5fb0e147903778a49e235a5f68ecf1436869d10de094b19db06aa5204317a252\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T07:01:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:de1f448719fa12f0f000f49cb83cab41d83a66e2a64f13503264dfdf1ac6e5d0\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T07:01:58Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:bdb3e5d18b7acfdfb42e51a1dee06611122068234d9b5e78fd40e61aedbe65c1\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:01:34Z\",\n                \"finishedOn\": \"2025-09-04T07:06:20Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8, quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b@sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:e206be2ffdfec6787d6a8284c98236a4820493131055509ee7a15a8646ba2189\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:22Z\",\n                \"finishedOn\": \"2025-09-04T07:16:36Z\"\n              },\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": true, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\\\", \\\"image_digest\\\": \\\"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src@sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:sha256-8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:29Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\"\n              },\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\":\\\"sha256:8de22cde4c025fa5a2280aae23bfba29affb99c85c1a55ee86278f162e653c58\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\":\\\"sha256:2dea4572abe98b008cfecd7794c81976a05e0e757a538043a3090722c91a5e44\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\":\\\"sha256:1b468490de5adda615f836950610ee8c2191c2fb0c74ade4e2713a570f69fdcd\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\":\\\"sha256:0836df554e3319b95f52f20b89cc6ded3f9debdf61148c4d022dcd92ee2cd56e\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:19:51+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:52Z\"\n              },\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970367\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:34Z\"\n              },\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:57+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:38Z\",\n                \"finishedOn\": \"2025-09-04T07:18:58Z\"\n              },\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970376\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:19:39Z\"\n              },\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:42+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:43Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:02+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:03Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:05+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:38Z\",\n                \"finishedOn\": \"2025-09-04T07:17:07Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:44Z\"\n              },\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:6b42b39c3854c5bb9555c0c36c41e4295ee4dd403a4fbc08d72fb91f4657b9f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:37Z\",\n                \"finishedOn\": \"2025-09-04T07:17:49Z\"\n              },\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\", \\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\", \\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\", \\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\", \\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:18:46+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:37Z\",\n                \"finishedOn\": \"2025-09-04T07:18:47Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-09-04T07:19:52Z\",\n                \"finishedOn\": \"2025-09-04T07:19:58Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_names := {name |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    name := task.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:53Z\",\n                \"finishedOn\": \"2025-08-20T15:46:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:sriov-network-operator-fbc-4.17.0-20250820154201\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"eec8d48064692b2608b4e9d8781ce67dc057602671b49ef98e3170719230b91c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-operator-bundle\",\n            \"digest\": {\n              \"sha256\": \"93a99934055394954c7854354d8cb2007e151aed6fea40eb44a5798fcdb49279\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9\",\n            \"digest\": {\n              \"sha256\": \"957cebfe9df17cf4a59e2d709cf6227fda05e0fc388645f3724ff531703d9f14\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9\",\n            \"digest\": {\n              \"sha256\": \"9a70b26db76179fd1907509e0c2317d2fa2480c5541f90995c4f490dc7513f5d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9\",\n            \"digest\": {\n              \"sha256\": \"5f2735a47c2c0766cbcf71af99ac0719431759d750c9e93dff37e4cccb9dad65\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:25:11+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:25:00Z\",\n                \"finishedOn\": \"2025-08-20T16:25:13Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6be80c5dce2508aaaa0c9107048affbef718d67c06d3ac8775c35fffd9a2bea2\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:1a81d43ad88fc13ac10a0efabf9967a3554040742ba98e04fe9cd0083de3e1c7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:vertical-pod-autoscaler-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:11:23+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:24Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'show-sbom'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-20T16:25:13Z\",\n                \"finishedOn\": \"2025-08-20T16:25:21Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check the status of task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:36d40d4009cd527f0beab5c7584356b4fb9c5baf001a7e83d8733f9a6757c818\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\\\",\\\"sha256:78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\\\",\\\"sha256:8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\\\",\\\"sha256:600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\\\",\\\"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756404804\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:13:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clamav-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970294\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201@sha256:6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:f1caf0f8195b2db72f5451315a5ab0cf45b1aaf0cc4e2d7704ca6db7c6b944f3\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:15:16Z\",\n                \"finishedOn\": \"2025-08-20T16:15:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"c44d6928eb70221d2bd7dca77d53abd36cca5691\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ptp-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:89aead32dc21404e4e0913be9668bdd2eea795db3e4caa762fb619044e479cb8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:41+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"--project-name=Discovery/discovery-ui --report --org=3e74668d-0a76-49f9-8822-a84cec963cde\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:1f6e2c9beba52d21c562ba1dea55f579f67e33b80099615bfd2043864896284d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970294\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"7625345c9a0f6f009241cc288bcacba9413f40f244ca2c218934a2b58be4007b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"78cd3b3f1287feddbf28ae74f17ad1d89d6dfde7366f8b425cd6780c2953bfbc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"8aa6ca8bdd76d195d905e2e0ad0bf91bebaca9080b8aaf4a4bac3f21d5831fcf\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"600a17d5735eca5c3064275069fe10e01721125d27701b6051f9e842b06cbeb4\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"e8897c6a03bad2050ee3a101be78d95ff086858d651cadfec678ed16a424880a\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find a task named 'clamav-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970294\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:18Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b38d64a3b1c55fb49f7f24e9d698308cb8ef4d04319e6dc0e70bf8e49fe35bc7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"090fb558925ff12714f920f9967e585612674398\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:49+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:51Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6ca9242d4de33935a84220f299f3204c220d601963f13cc7bae433d995cc3c4c\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"2975a2b9f265c73ab093e3189319f2d4618f903279be9d4fabca1071ff638003\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"595ba03d6a295337dcb8993cc9eb2a7d089de0d0d257b18b6b6722948bcd7700\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"2f80d9d4e9aaea430c05f898f1eb47ab6e00d530c65a213faacc81bfeaace9ae\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"6608868f0a1af23d992d16ba0ffa39f0e62b4d1869284f0668a581a36787a4be\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:08f0413958c10027ce982f1d120c2377f7f0740643245567430226ac0bed6312\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:39Z\",\n                \"finishedOn\": \"2025-09-04T07:17:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"manager/Containerfile.manager\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:7e7446e238976c3832d1e26feee86f92a43836808a7153a587cf22804a0e2e8a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:47:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"rhoai-2.24-d10e457ed421f3c7bc22d8df89068c9b7ac317c2\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the first subject's SHA256 digest", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"aab0f28f3fd31f5853e0138c7245292bbc846b5f8766dcc65005f70b6c3574dd\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"8d140c20f929c63456eb51a800f33d65bb85499dd972f95343a0264f4fab2e52\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"9b121b0489745ac37bed851cfae824c3171cd65b9e655fc54d9a2679e8ec68bd\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"439523f59fb75d2257308c7d2f3d22799a75b4561f05e242f6a2c52adceca0a7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"bb91102fb8d4edefb7258f2cff0d967039eb2e559455438942f93303040cb23c\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:ded314206f09712b2116deb050b774ae7efef9ab243794334c8e616871a3ffa5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:39Z\",\n                \"finishedOn\": \"2025-09-04T06:55:44Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:f289abe0fb4f64dcd09b8f7cbae89da11a64db1f123b7fb8a9986dafe31e6bdd\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:57:31Z\",\n                \"finishedOn\": \"2025-09-04T06:59:47Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:c7dd89376208d15c933598a9f8fd8077dfecaff09cf0a7eb119f48d2c9fa513d\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"operator/Containerfile.operator\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5@sha256:913ebb310581a966328571cb8bcf5ff830390fa01960f87988380cf4c6848b0a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:252e5c94fb2375c43bdfd4b65097d246f4f37392956b08e5c38f366623a0b9ce\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64@sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:2e2d1bafb57422191e4a181d2b365689dcf9c0786df355ca748c5ffb0632357a\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:04:07Z\",\n                \"finishedOn\": \"2025-09-04T07:07:38Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"COMMIT_SHA\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"manager/Containerfile.manager\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release\",\n            \"digest\": {\n              \"sha256\": \"17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:1f6e2c9beba52d21c562ba1dea55f579f67e33b80099615bfd2043864896284d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:29:59Z\",\n                \"finishedOn\": \"2025-06-10T04:32:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:9ab3f091c4027f0f761e8eaa6a820ef8f11fc8d656fcd04c0e633f5d30f6c832\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"true\",\n                    \"input\": \"[{\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\"konflux\\\"}, {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:24+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'fbc-fips-check-oci-ta'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-fips-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-fips-check-oci-ta:0.1@sha256:4ff3a82892cc75c05fdf895898849094544439bfe8aa23c340548f2d01710cc0\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:7fc71f7890bfc3b63c0c10d333a405c1339b3eea3123e63f5545ba79b51da81f\\\",\\\"sha256:3f1c955346129c3458f207e9691a9554197ddc962c3188047cb81b3c2521ceda\\\",\\\"sha256:c78b6a6634d2c3420b5505da230b2b53f919d4be7b5b39483242cb5c459ced39\\\",\\\"sha256:cb5a87a2d6a4def0f7079568cf60ccb0a6b21f0ef2650523cab67dca2a8b31df\\\",\\\"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:05:22+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-4-17-dpu-operator-9rmqb-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:02:23Z\",\n                \"finishedOn\": \"2025-08-20T16:05:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:00f2fc03b205563a0b6c62cfadb638e084f769a7056779b69c20705d6428e79c\",\n                    \"image-digest\": \"sha256:db3556f9fa8a2727a1605d771cac1614d08aa30de7eeafc99739e337e5afd468\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:dpu-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-fips-check-oci-ta\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\\\", \\\"sha256:8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\\\", \\\"sha256:6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\\\", \\\"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\\\", \\\"sha256:7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:05:45+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:05:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.3@sha256:b0bd59748cda4a7abf311e4f448e6c1d00c6b6d8c0ecc1c2eb33e08dc0e0b802\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1756970369\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":8,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:18:39Z\",\n                \"finishedOn\": \"2025-09-04T07:19:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"clamd-max-threads\": \"8\",\n                    \"docker-auth\": \"\",\n                    \"image-arch\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'validate-fbc'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"validate-fbc\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-validate-fbc:0.1@sha256:b6dc1948778552a53b863682f8d42dcdda8b25348b5a3b97efb2398ba17f290d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-11-12T05:28:00+00:00\\\",\\\"note\\\":\\\"Task validate-fbc completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":10,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RELATED_IMAGES_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:818e582f4c8457fbbe9ede7b2075a1284be5fe240f2527278453df64bfda9030\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:8ead5773015968aac802e763e476afc9bf801cf826370f465da8f1764438c810\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:28:03Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"validate-fbc\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'generate-version-labels'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"generate-version-labels\",\n                \"status\": \"Succeeded\",\n                \"results\": [\n                  {\n                    \"name\": \"labels\",\n                    \"type\": \"array\",\n                    \"value\": [\n                      \"version=1.14.1\",\n                      \"version_minor=1.14\"\n                    ]\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:55:03Z\",\n                \"finishedOn\": \"2025-05-08T19:55:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server@sha256:5836fd201d2e8390eefc44fb66bdbe7e2229d3dbb5ffec089cb79f2dc1505e61\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"generate-version-labels\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'sast-unicode-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:21:03+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:20:40Z\",\n                \"finishedOn\": \"2025-09-04T07:21:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:33369d8bc2007364db48d63e2d36a4f94c40917538c2280e61158a29bfc1b56b\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:d852a312ea97c10a9a81e26c549212840ace87988916f1f8c306e17a5e3f108a\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:7a24924417260b7094541caaedd2853dc8da08d4bb0968f710a400d3e8062063\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:13:06Z\",\n                \"finishedOn\": \"2025-05-08T19:13:12Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\",\\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\",\\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\",\\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\",\\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970300\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:18:27Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\",\n            \"digest\": {\n              \"sha256\": \"955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'push-dockerfile' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:d0ee13ab3d9564f7ee806a8ceaced934db493a3a40e11ff6db3a912b8bbace95\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:0de18e60b1809462a586f22e0476ef11f038f8d7adf7c7c0f6c8eaea0aa5ad4f\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"build/Dockerfile.openshift\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_DIGEST\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20\",\n            \"digest\": {\n              \"sha256\": \"ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\", \\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\", \\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 554, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:24+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:25Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:7e7446e238976c3832d1e26feee86f92a43836808a7153a587cf22804a0e2e8a\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-08-27T17:49:10Z\",\n                \"finishedOn\": \"2025-08-27T17:49:16Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"rhoai-2.24-5963a6cc76fa32879f860e9b2df35fa9428106a0\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-llm-d-inference-scheduler-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://quay.io/konflux-ci/git-clone' and commit '4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"4e53ebd9242f05ca55bfc8d58b3363d8b9d9bc3ab439d9ab76cdbdf5b1fd42d9\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'prefetch-dependencies'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"prefetch-dependencies-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-prefetch-dependencies-oci-ta:0.2@sha256:05551e144d090844903d61893a383fa4dc69ab563797f03ffaab0f8624bf530d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:b9b20bc6dcb72b4d8b1f358cd45bd464c53e8d242354a11e840e5e5e72d20f6d\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:56:09Z\",\n                \"finishedOn\": \"2025-09-04T06:58:04Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:8f73fd977807d4e3dc322814b7f8d7c4b66da457ddb664a4f91c21244b91df9d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"config-file-content\": \"\",\n                    \"dev-package-managers\": \"false\",\n                    \"input\": \"[ {\\\"type\\\": \\\"gomod\\\", \\\"path\\\": \\\".\\\"}, {\\\"type\\\": \\\"rpm\\\", \\\"path\\\": \\\".\\\"} ]\",\n                    \"log-level\": \"info\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.prefetch\",\n                    \"sbom-type\": \"spdx\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"prefetch-dependencies\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clair-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:076d5cde62b55bbfcdda2b4782392256bbda5ad38f839013b4330b3aba70a973\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\":\\\"sha256:9f280cc0d2093d95dfba3a0a050fc39ed9977c7d829e6e389f08d6dcfad1f478\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\":\\\"sha256:28eaabd9496b4451a73b82ebd4106e9b5c856eaeb460244501650e361e4c66ef\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\":\\\"sha256:b4993c129faaf7ba0dcaf0aeeb7598ca6099ae3ff51087689875d65dc5086f41\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\":\\\"sha256:3f33e229bd14925b2b180d5c06e8301a134a7ab6ebf38c16c722ce100619d782\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":60,\\\"low\\\":151,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:20:54+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:55Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:82436859839d816c9e368ae2154e6f8fe0affe44ecca52048e9494a3ccafdc21\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:31Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"agent/Containerfile.agent\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"IMAGE_DIGEST\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5@sha256:d9fc5e8e7dffef8439974351e31823304b143388254548fd7f60c83cdfefd684\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:c49732039f105de809840be396f83ead8c46f6a6948e1335b76d37e9eb469574\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\\\",\\\"sha256:c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\\\",\\\"sha256:1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\\\",\\\"sha256:907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\\\",\\\"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:46+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:36Z\",\n                \"finishedOn\": \"2025-09-04T07:16:46Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'show-sbom' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"show-sbom\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-show-sbom:0.1@sha256:beb0616db051952b4b861dd8c3e00fa1c0eccbd926feddf71194d3bb3ace9ce7\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-11-12T05:28:28Z\",\n                \"finishedOn\": \"2025-11-12T05:28:34Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"PLATFORM\": \"linux/amd64\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"show-sbom\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all subject names", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_names := {name |\n    some att in input.attestations\n    some subject in att.statement.subject\n    name := subject.name\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"806e7609a92f824c0e611a3b4d76b7dc266c2b23a6d07396237a0ad3dcc89725\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/rhoai-konflux/alpine' and commit '149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/rhoai-konflux/alpine\",\n              \"digest\": {\n                \"sha256\": \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/rhoai-konflux/alpine\"\n    material.digest.sha1 == \"149feff81b1fc443edb5eb8351753344abb5aba4a04a5ade4a760fb9efe48c2e\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"6a6aea60fa31bc71d720a23502d1d1c989a7987e9b341c395d98faf0c3a36e31\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"8ccace91f93366ab5ff8c4fbfec0568dfae1ecf4dda3a783f982a486bcc188d1\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"7e6f6596a4e390195318d89b734f46ae99aad5967123a0567f1a29441d03fe18\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"3cd6209d08afba9632d9d87811f3190bf8ea0faa07806c65f7e7e3a5a7f4898a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\"\n            }\n          },\n          {\n            \"name\": \"quay.io/rhoai/odh-rhel9-operator\",\n            \"digest\": {\n              \"sha256\": \"cb97d5cc085827e8c70da890248b8c8044886ddbbfeddca6ad391172f913f6cb\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'git+https://github.com/red-hat-data-services/konflux-central.git' and commit '3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"git+https://github.com/red-hat-data-services/konflux-central.git\",\n              \"digest\": {\n                \"sha1\": \"3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"git+https://github.com/red-hat-data-services/konflux-central.git\"\n    material.digest.sha1 == \"3b2fd6ce8fc720ea2af2e6d2a25e47e3e610e4db\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:4a601aeec58a1dd89c271e728fd8f0d84777825b46940c3aec27f15bab3edacf\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1756968922\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"b84a9a1\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/stolostron/multicluster-global-hub\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5@sha256:6872ae092ff49f29cf61b9b5cf6fa3ef48e137d92ce30d8f13e63ccd3704f56e\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T06:55:45Z\",\n                \"finishedOn\": \"2025-09-04T06:56:09Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b.git\",\n                    \"refspec\": \"\",\n                    \"revision\": \"b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/stolostron/multicluster-global-hub\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-model-controller-rhel9@sha256:704eebd2a2ac770a9fc4449f9ef5eb03e60f9793bc2f12bb488b21738ce98d9e\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T14:20:59Z\",\n                \"finishedOn\": \"2025-08-28T14:21:06Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Dockerfile.konflux\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\",\n                    \"IMAGE_DIGEST\": \"sha256:38d1c10c4235b0b22e85218816fe8273e6927c5642a3873b95d53c660bbe7347\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-model-controller-rhel9@sha256:89197c6c3e5686b5dca8b4c6e1e604d575197ca61ef21765630ed8d32fd4085f\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'apply-tags'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"apply-tags\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-apply-tags:0.1@sha256:3f89ba89cacf8547261b5ce064acce81bfe470c8ace127794d0e90aebc8c347d\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ADDITIONAL_TAGS\": [\n                      \"latest\"\n                    ],\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"apply-tags\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:72f77a8c62f9d6f69ab5c35170839e4b190026e6cc3d7d4ceafa7033fc30ad7b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201@sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6db79e557b0a1326f64c7da65f62ebd954d30ee3d75e3812372d936685947b41\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:24:49Z\",\n                \"finishedOn\": \"2025-08-20T16:25:07Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"bb936a5dbd90cb5ad7d01d80b5c95017bb5706c3\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\",\n                      \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:e153141f82b220506294f2002fd2f781cffa98b5db296a9c2f6de67bb0ee9392\\\",\\\"sha256:79fb29e2007d9dc442815627f4d10686eb3f65e292aa5a49f811a1cef28b99e7\\\",\\\"sha256:3a01fb6a5afc15fc8ae1e85a31e160d4eba6eae9572164c414077f3d571de623\\\",\\\"sha256:64eca0256e3b675686c54417132e9ad572e89f9741f4b95236215b20f81a719d\\\",\\\"sha256:921163d139bca9e47bf95df43d7b408ff6fe2bf9b0902fb6af9f4cfc9d4598cc\\\"]}}\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1756970431\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":28,\\\"failures\\\":4,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:19:39Z\",\n                \"finishedOn\": \"2025-09-04T07:20:39Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-manager-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://quay.io/konflux-ci/git-clone' and commit 'aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://quay.io/konflux-ci/git-clone\",\n              \"digest\": {\n                \"sha256\": \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://quay.io/konflux-ci/git-clone\"\n    material.digest.sha1 == \"aedc5ba99f95c3d77fc256ac01677212c18298373a0b3de3aeabc41ba69cc301\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:462ecbf94ec44a8b770d6ef8838955f91f57ee79795e5c18bdc0fcb0df593742\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755@sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:976058e10b643ac4df6aa99e1090a74ba305e11dd660d4336d6f2710f53c7ff0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:20:51Z\",\n                \"finishedOn\": \"2025-05-08T19:21:13Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\",\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the bundle used by task 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:89aead32dc21404e4e0913be9668bdd2eea795db3e4caa762fb619044e479cb8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:41+00:00\\\",\\\"note\\\":\\\"For details, check Tekton task log.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"--project-name=Discovery/discovery-ui --report --org=3e74668d-0a76-49f9-8822-a84cec963cde\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"75c6ac42431e29465eba3ff3367a18416722cdc18cb7c5745b448f199082fdef\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'coverity-availability-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"coverity-availability-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"coverity-availability-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-coverity-availability-check:0.2@sha256:db2b267dc15e4ed17f704ee91b8e9b38068e1a35b1018a328fdca621819d74c6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"STATUS\",\n                    \"type\": \"string\",\n                    \"value\": \"failed\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-09-04T07:16:42+00:00\\\",\\\"note\\\":\\\"Task coverity-availability-check failed: No license file for Coverity was detected. Please, create a secret called 'cov-license' with a key called 'cov-license' and the value containing the Coverity license\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":1,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:16:37Z\",\n                \"finishedOn\": \"2025-09-04T07:16:43Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"AUTH_TOKEN_COVERITY_IMAGE\": \"auth-token-coverity-image\",\n                    \"COV_LICENSE\": \"cov-license\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"coverity-availability-check\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "List the results from task 'sast-unicode-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-unicode-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"image-digest\",\n                      \"value\": \"$(tasks.build-image-index.results.IMAGE_DIGEST)\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-unicode-check-oci-ta:0.3@sha256:a2bde66f6b4164620298c7d709b8f08515409404000fa1dc2260d2508b135651\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:21:24+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:21:13Z\",\n                \"finishedOn\": \"2025-08-20T16:21:26Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"FIND_UNICODE_CONTROL_ARGS\": \"-p bidi -v -d -t\",\n                    \"FIND_UNICODE_CONTROL_GIT_URL\": \"https://github.com/siddhesh/find-unicode-control.git#c2accbfbba7553a8bc1ebd97089ae08ad8347e58\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:413d2216c1af3f28985e5e36a3abfac36dbf3f06b4d1b451a3d1cb1b08460d00\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:5255af42e66652108d030e435c2bef165e6fd0537e0b324cef8629cc8114bfa0\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-smb-csi-driver-operator-fbc-4.17.0-20250820154201\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-unicode-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:bf7bdde00b7212f730c1356672290af6f38d070da2c8a316987b5c32fd49e0b9\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-28T18:11:13+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-28T18:10:59Z\",\n                \"finishedOn\": \"2025-08-28T18:11:15Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:cfcfa921e148610916faa22d962bbe414cb12431e99347638c1e2d92076ef2e3\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:864d6723d2477372cd1f043a00c882d58093ea389bb7b3ad57860013d20130f1\",\n                    \"TARGET_DIRS\": \".\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:aee59236a97464e70b4114a479a7b9753fe3eec9f4843e319256a51a57936c05\",\n                    \"image-url\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'clamav-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clamav-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clamav-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clamav-scan:0.2@sha256:386c8c3395b44f6eb927dbad72382808b0ae42008f183064ca77cb4cad998442\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\\\", \\\"digests\\\": [\\\"sha256:37dab63ae68c1043e086e00903847a326ca6cf6a3cda48056780bee5d8ddc647\\\",\\\"sha256:649df11627fb3a7f87552941ab2305880fa5d1751100cc9d4b3e3eb75c0d0704\\\",\\\"sha256:d23cdbbc713a5fb5f9df29aa619764ed3a8489d4affca0016ecfbf1d54682a2d\\\",\\\"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"timestamp\\\":\\\"1749530486\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":6,\\\"failures\\\":0,\\\"warnings\\\":0,\\\"result\\\":\\\"SUCCESS\\\",\\\"note\\\":\\\"All checks passed successfully\\\"}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:28Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"scan-threads\": \"1\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clamav-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find the status for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.6@sha256:c9eb4f18a14f4fab96add0028759af7aac21e42a93d3e098a5461de641a06f7f\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64@sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:2b0ec16a5f284a3c12ef363ecc19fd834c94e681ab27c83b9eb791fcb5527701\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:17:45Z\",\n                \"finishedOn\": \"2025-11-12T05:20:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"BUILD_TIMESTAMP\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"CONTEXT\": \".\",\n                    \"CONTEXTUALIZE_SBOM\": \"false\",\n                    \"DOCKERFILE\": \"Dockerfile-4.20.catalog\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"ICM_KEEP_COMPAT_LOCATION\": \"true\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"OMIT_HISTORY\": \"false\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"REWRITE_TIMESTAMP\": \"false\",\n                    \"SBOM_SOURCE_SCAN_ENABLED\": \"true\",\n                    \"SBOM_SYFT_SELECT_CATALOGERS\": \"\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_INJECTIONS\": \"false\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20@sha256:416eb73edb4ee6810ac77b4b1ea0856231d66a60ec467c987026150f3af7f6c1\",\n                    \"SOURCE_DATE_EPOCH\": \"\",\n                    \"SOURCE_URL\": \"\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the SHA256 digest of the first subject", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"subject\": [\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1acbd8b74aaff4b6a390c8a1424a3d08ca7b7b1c3fc0f0a9d2551c0188bcfa32\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"c1a1ce9430d76908aff733328543111dbe22ec2744abd344ce928db2cf95f73a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"1513daf1bbc1b774a10912843a6339d8d4804335f0fccb44269f20e6ff3581f8\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"907beea4d3dc9731035eb84c58e2912e6bda27be79c3366ead31ed24315e9620\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"8af7e57b8c6285ad232084e7776fef32d026e080eb0bf14b91986ac28d00bb6a\"\n            }\n          },\n          {\n            \"name\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-operator-globalhub-1-5\",\n            \"digest\": {\n              \"sha256\": \"d7aa47d511bae31a6c7e21efe5e43a64dc6c94922d7fa168b606ffcda5fc0b3d\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}", "output_code": "subject_digest := digest if {\n    some att in input.attestations\n    att.statement.subject[0].digest.sha256 == digest\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if material exists for git repo 'oci://registry.access.redhat.com/ubi9/skopeo' and commit '0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"0e340121696fecccfccb2a93c460fe73438fa21d0cfe639b53b4069f644f3e07\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:302828e9d7abc72b8a44fb2b9be068f86c982d8e5f4550b8bf654571d6361ee8\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"application\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"1749530491\\\",\\\"note\\\":\\\"Task preflight is a FAILURE: Refer to Tekton task logs for more information\\\",\\\"successes\\\":21,\\\"failures\\\":3,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'deprecated-base-image-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"deprecated-image-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-deprecated-image-check:0.5@sha256:462baed733dfc38aca5395499e92f19b6f13a74c2e88fe5d86c3cffa2f899b57\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\\\", \\\"digests\\\": [\\\"sha256:eb05bfe82e1789c2f746ee587fc0951d4ccc5c08c73111441b36c41f87c5b3c1\\\",\\\"sha256:d6289438d744c67c56c6085432bd7b045e1a27f12cf2a2a87ced79805e11344b\\\",\\\"sha256:196704e2e020a5927d522234707c02e7c904dbbc1ea4abbe990eab44d6029b6a\\\",\\\"sha256:78e7dc4da333af9a6bf38da3eddbdeb4915e83045bd5e4f304b8b16b15d50ba6\\\",\\\"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"WARNING\\\",\\\"timestamp\\\":\\\"2025-11-12T05:27:08+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":1}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-12T05:26:57Z\",\n                \"finishedOn\": \"2025-11-12T05:27:08Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES_DIGESTS\": \"\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"IMAGE_DIGEST\": \"sha256:ebbc1804d66787beae3f613dde8b871e19993405df886a212eac3ea311cc31ca\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/cluster-observabilit-tenant/cluster-observability-operator/coo-fbc-v4-20:fcef9ef565fd3200f4a7e6d5baf332911eb4e16d\",\n                    \"POLICY_DIR\": \"/project/repository/\",\n                    \"POLICY_NAMESPACE\": \"required_checks\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"deprecated-base-image-check\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "In an attestation, check all tasks for a task named 'build-image-index'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"build-image-index\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-build-image-index:0.1@sha256:462ecbf94ec44a8b770d6ef8838955f91f57ee79795e5c18bdc0fcb0df593742\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991, quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755@sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:976058e10b643ac4df6aa99e1090a74ba305e11dd660d4336d6f2710f53c7ff0\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:20:51Z\",\n                \"finishedOn\": \"2025-05-08T19:21:13Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ALWAYS_BUILD_INDEX\": \"true\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"COMMIT_SHA\": \"142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\",\n                    \"IMAGES\": [\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-x86-64@sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\",\n                      \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755-linux-mxlarge-arm64@sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\"\n                    ],\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"STORAGE_DRIVER\": \"vfs\",\n                    \"TLSVERIFY\": \"true\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-image-index\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'clone-repository'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"git-clone-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-git-clone-oci-ta:0.1@sha256:be82c55346e8810bd1edc5547f864064da6945979baccca7dfc99990b392a02b\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"c35eb1f\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:377dd6d5d3d1129ebf5f4313831692fe2a0b565a15ae40245769f4f48bd428e7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:38Z\",\n                \"finishedOn\": \"2025-08-20T15:47:52Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"depth\": \"1\",\n                    \"enableSymlinkCheck\": \"true\",\n                    \"fetchTags\": \"false\",\n                    \"httpProxy\": \"\",\n                    \"httpsProxy\": \"\",\n                    \"mergeTargetBranch\": \"false\",\n                    \"noProxy\": \"\",\n                    \"ociArtifactExpiresAfter\": \"\",\n                    \"ociStorage\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:local-storage-operator-fbc-4.17.0-20250820154201.git\",\n                    \"refspec\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313:refs/remotes/origin/art-openshift-4.17-assembly-stream-fbc-local-storage-operator refs/tags/*:refs/tags/*\",\n                    \"revision\": \"c35eb1f3fa164e74c9a790e9b76a0fe64fbcf313\",\n                    \"shortCommitLength\": \"7\",\n                    \"sparseCheckoutDirectories\": \"\",\n                    \"sslVerify\": \"true\",\n                    \"submodules\": \"true\",\n                    \"targetBranch\": \"main\",\n                    \"url\": \"https://github.com/openshift-priv/art-fbc\",\n                    \"userHome\": \"/tekton/home\",\n                    \"verbose\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clone-repository\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'sast-shell-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-shell-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-shell-check-oci-ta:0.1@sha256:57b3262138eb06186ae7375f84ca53788bba2a66cfd03d39cb82c78df050aba5\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:21:30+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:21:33Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:410ff155b9adbe7d38b51668d5bd50da4a4f088904d3f29c71476c9c0bc42744\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui@sha256:fa84abd911f964ebfe809ffea5d58590661211c78b4ba1849d93a2f1015ce02c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-shell-check\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find material with URI 'quay.io/konflux-ci/tekton-catalog/task-init' and commit '08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:46:54Z\",\n                \"finishedOn\": \"2025-08-20T15:47:01Z\"\n              },\n              {\n                \"name\": \"clone-repository\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CHAINS-GIT_COMMIT\",\n                    \"type\": \"string\",\n                    \"value\": \"090fb558925ff12714f920f9967e585612674398\"\n                  },\n                  {\n                    \"name\": \"CHAINS-GIT_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"commit\",\n                    \"type\": \"string\",\n                    \"value\": \"090fb558925ff12714f920f9967e585612674398\"\n                  },\n                  {\n                    \"name\": \"commit-timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"1755704775\"\n                  },\n                  {\n                    \"name\": \"short-commit\",\n                    \"type\": \"string\",\n                    \"value\": \"090fb55\"\n                  },\n                  {\n                    \"name\": \"url\",\n                    \"type\": \"string\",\n                    \"value\": \"https://github.com/openshift-priv/art-fbc\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:03Z\",\n                \"finishedOn\": \"2025-08-20T15:47:11Z\"\n              },\n              {\n                \"name\": \"prefetch-dependencies\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"CACHI2_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"\"\n                  },\n                  {\n                    \"name\": \"SOURCE_ARTIFACT\",\n                    \"type\": \"string\",\n                    \"value\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:de2319a053b0b74fcb860c44029d0d5830d0536c51972e07bcda66c74128f2c2\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:12Z\",\n                \"finishedOn\": \"2025-08-20T15:47:19Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:b38d64a3b1c55fb49f7f24e9d698308cb8ef4d04319e6dc0e70bf8e49fe35bc7\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T15:49:00Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-s390x@sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-s390x\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:db1fbd17581e9a31ef3119237a0268070ad39a537e1313446c47f36c1cbeb3b4\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T16:10:36Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-ppc64le@sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-ppc64le\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:4984b6af2da543631e0b13e6e536c5cbf51b20883b964da5b129bd88d37cd310\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:20Z\",\n                \"finishedOn\": \"2025-08-20T16:01:20Z\"\n              },\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-arm64@sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201-linux-arm64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:700ed0ab32b333c9ce0b642bce7aa7c2ce1f931b88a1d5d4085bdab2e447681f\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:21Z\",\n                \"finishedOn\": \"2025-08-20T15:53:21Z\"\n              },\n              {\n                \"name\": \"build-image-index\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740, quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\"\n                  },\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201@sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:20f61294017537cda680f700425c53dfd6c58305401a1abbe88e74aec7bdec25\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:36Z\",\n                \"finishedOn\": \"2025-08-20T16:10:57Z\"\n              },\n              {\n                \"name\": \"sast-shell-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:11:07+00:00\\\",\\\"note\\\":\\\"Task sast-shell-check-oci-ta completed successfully.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:10Z\"\n              },\n              {\n                \"name\": \"sast-unicode-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:11:23+00:00\\\",\\\"note\\\":\\\"Task sast-unicode-check-oci-ta success: No finding was detected\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:24Z\"\n              },\n              {\n                \"name\": \"deprecated-base-image-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:11:07+00:00\\\",\\\"note\\\":\\\"Task deprecated-image-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"required_checks\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:08Z\"\n              },\n              {\n                \"name\": \"apply-tags\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:11:04Z\"\n              },\n              {\n                \"name\": \"validate-fbc\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"FAILURE\\\",\\\"timestamp\\\":\\\"2025-08-20T16:12:17+00:00\\\",\\\"note\\\":\\\"Step extract-and-validate failed (1): Could not fetch related images. Make sure you have catalog.yaml or catalog.json formatted correctly in your file-based catalog (FBC) fragment image.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":8,\\\"failures\\\":1,\\\"warnings\\\":0}\"\n                  },\n                  {\n                    \"name\": \"RENDERED_CATALOG_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:63cc9fef3ac927c93ad7ffe9c1eff75eb4afc9ad9804ac37840754bd211f59b0\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:12:20Z\"\n              },\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:13:22+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:12:20Z\",\n                \"finishedOn\": \"2025-08-20T16:13:23Z\"\n              },\n              {\n                \"name\": \"fbc-fips-check-oci-ta\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ingress-node-firewall-operator-fbc-4.17.0-20250820154201\\\", \\\"digests\\\": [\\\"sha256:6bcecd9a1da390a4e75fa369390bcfaeb35189c858d1e3671b7a29b3a980b9b1\\\",\\\"sha256:0ac51c880d8ea17150d14c611cd179ed1fd208f765d469f628d1bcd175becf95\\\",\\\"sha256:978a79e639aaad57393e79df8eaf86bb589b9bb675023a90594bd5b1754b4740\\\",\\\"sha256:96734717e449333cc6d10df5db9ab068f3f015153944ed3fb759b283e7eb44e5\\\",\\\"sha256:28cb9ed78ec0c27bb576fbd1c9e612341297caea7feefc759d2755ea71dac7c0\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:13:42+00:00\\\",\\\"note\\\":\\\"Task fbc-ose-43d404726e1e132cd7c0588f2a09e4953-fbc-fips-check-oci-ta completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":3,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:10:57Z\",\n                \"finishedOn\": \"2025-08-20T16:13:44Z\"\n              },\n              {\n                \"name\": \"show-sbom\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\"\n                },\n                \"startedOn\": \"2025-08-20T16:13:44Z\",\n                \"finishedOn\": \"2025-08-20T16:13:50Z\"\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"quay.io/konflux-ci/tekton-catalog/task-init\"\n    material.digest.sha1 == \"08e18a4dc5f947c1d20e8353a19d013144bea87b72f67236b165dd4778523951\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:c5e56643c0f5e19409e86c8fd4de4348413b6f10456aa0875498d5c63bf6ef0e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'init'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"init\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"init\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-init:0.2@sha256:4072de81ade0a75ad1eaa5449a7ff02bba84757064549a81b48c28fab3aeca59\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"build\",\n                    \"type\": \"string\",\n                    \"value\": \"true\"\n                  }\n                ],\n                \"startedOn\": \"2025-11-19T18:00:56Z\",\n                \"finishedOn\": \"2025-11-19T18:01:02Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"image-url\": \"quay.io/redhat-user-workloads/hummingbird-tenant/git--default--main:on-mr-1585-001e77d19842936a0413a87e96519c92fa7ab476\",\n                    \"rebuild\": \"false\",\n                    \"skip-checks\": \"false\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"init\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'sast-snyk-check'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"sast-snyk-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"sast-snyk-check-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-sast-snyk-check-oci-ta:0.4@sha256:9a6ec5575f80668552d861e64414e736c85af772c272ca653a6fd1ec841d2627\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SKIPPED\\\",\\\"timestamp\\\":\\\"2025-06-10T04:40:22+00:00\\\",\\\"note\\\":\\\"Task sast-snyk-check-oci-ta skipped: If you wish to use the Snyk code SAST task, please create a secret name snyk-secret with the key 'snyk_token' containing the Snyk token by following the steps given [here](https://konflux-ci.dev/docs/testing/build/snyk/)\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:40:23Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARGS\": \"\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_FILE_PATHS\": \"\",\n                    \"IMP_FINDINGS_ONLY\": \"true\",\n                    \"KFP_GIT_URL\": \"SITE_DEFAULT\",\n                    \"PROJECT_NAME\": \"\",\n                    \"RECORD_EXCLUDED\": \"false\",\n                    \"SNYK_SECRET\": \"snyk-secret\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"sast-snyk-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-images'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-images\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"buildah-remote-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-buildah-remote-oci-ta:0.4@sha256:fa90f4a5ac8485720999aabb00a1db4bb5da69b178acbc089870efc7eaf36721\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64@sha256:ffa0a13d3352cdc287bfd2075523c43b95952b2fe1fa26d94c55105ba1193f23\"\n                  },\n                  {\n                    \"name\": \"IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201-linux-x86-64\"\n                  },\n                  {\n                    \"name\": \"SBOM_BLOB_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:31294d9b2cc4f1f608ac5f9b194b9488616cade52836f28ba611604c724375f6\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T15:47:18Z\",\n                \"finishedOn\": \"2025-08-20T15:48:56Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ACTIVATION_KEY\": \"activation-key\",\n                    \"ADDITIONAL_BASE_IMAGES\": [],\n                    \"ADDITIONAL_SECRET\": \"does-not-exist\",\n                    \"ADD_CAPABILITIES\": \"\",\n                    \"ANNOTATIONS\": [],\n                    \"ANNOTATIONS_FILE\": \"\",\n                    \"BUILDAH_FORMAT\": \"oci\",\n                    \"BUILD_ARGS\": [],\n                    \"BUILD_ARGS_FILE\": \"\",\n                    \"CACHI2_ARTIFACT\": \"\",\n                    \"COMMIT_SHA\": \"3dbcca85d8a92f1465bd96edc31e8474d078cb69\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"catalog.Dockerfile\",\n                    \"ENTITLEMENT_SECRET\": \"etc-pki-entitlement\",\n                    \"HERMETIC\": \"true\",\n                    \"HTTP_PROXY\": \"\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-aws-efs-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"IMAGE_APPEND_PLATFORM\": \"true\",\n                    \"IMAGE_EXPIRES_AFTER\": \"\",\n                    \"INHERIT_BASE_IMAGE_LABELS\": \"true\",\n                    \"LABELS\": [],\n                    \"NO_PROXY\": \"\",\n                    \"PLATFORM\": \"linux/x86_64\",\n                    \"PREFETCH_INPUT\": \"\",\n                    \"PRIVILEGED_NESTED\": \"false\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"PROXY_CA_TRUST_CONFIG_MAP_NAME\": \"proxy-ca-bundle\",\n                    \"SBOM_TYPE\": \"spdx\",\n                    \"SKIP_SBOM_GENERATION\": \"false\",\n                    \"SKIP_UNUSED_STAGES\": \"true\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:bbcb490945b612c00359b666ec4dc94fab1f4e767c6922a3b4a4ab57d3301d30\",\n                    \"SQUASH\": \"false\",\n                    \"STORAGE_DRIVER\": \"overlay\",\n                    \"TARGET_STAGE\": \"\",\n                    \"TLSVERIFY\": \"true\",\n                    \"WORKINGDIR_MOUNT\": \"\",\n                    \"YUM_REPOS_D_FETCHED\": \"fetched.repos.d\",\n                    \"YUM_REPOS_D_SRC\": \"repos.d\",\n                    \"YUM_REPOS_D_TARGET\": \"/etc/yum.repos.d\",\n                    \"caTrustConfigMapKey\": \"ca-bundle.crt\",\n                    \"caTrustConfigMapName\": \"trusted-ca\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-images\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Get the status of task 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:1b6c20ab3dbfb0972803d3ebcb2fa72642e59400c77bd66dfd82028bdd09e120\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\\\", \\\"digests\\\": [\\\"sha256:65f3c8b40d11966dac787c10f6ac984ae926bdef16d103a10fdf0d2c34746652\\\", \\\"sha256:7eb90f6d6f57f2c22a4b984ba6f580e33a5a7c573859e73af27a7134bd76e21e\\\", \\\"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\\\", \\\"sha256:9b09fb65d33cb5cd45f8dbfd2b952f47e2439499139b79dd6610dd307fd5dfa5\\\", \\\"sha256:6b8423a8357e5690d6eac919bc8bc24362a360f2e1e8ed822e1b35740af81813\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 427, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-09-04T07:17:39+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-09-04T07:17:30Z\",\n                \"finishedOn\": \"2025-09-04T07:17:40Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:ab3ed25a4448a7d545648ae4cea52b493918cc4d3b0c5adc56bb2510c0838c80\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/acm-multicluster-glo-tenant/multicluster-global-hub-agent-globalhub-1-5:b84a9a1ebdf95a917d51314cb990a25b6a99f55b\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_status_check if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n    task.status == \"Succeeded\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'fbc-target-index-pruning-check' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"fbc-target-index-pruning-check\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"fbc-target-index-pruning-check\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-fbc-target-index-pruning-check:0.1@sha256:6f1d1edb746a7b20ad4fe523344c5515a259403b8314f5208d96ea0c6ec06169\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc@sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\", \\\"digests\\\": [\\\"sha256:b3ec02ae23193f9c1e5a8aa013b48d2436925895f2feedeee572f031c447f9d5\\\",\\\"sha256:e27fb482e48e3d57f16ba0bd211e0a5793c15e7cb292e0eafdccd97ee0298499\\\",\\\"sha256:d92155b89717cf24d4aecc2d0e4b568b86a9b22c966aa5d1dd5a6ea9e660b75a\\\",\\\"sha256:e74509ebf8a1385d5c3301ee7ce8f1679904292ce947121004bcba5151b82e13\\\",\\\"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-20T16:26:58+00:00\\\",\\\"note\\\":\\\"Task fbc-target-index-pruning-check completed: Check result for task result.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":1,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-20T16:26:24Z\",\n                \"finishedOn\": \"2025-08-20T16:26:59Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"IMAGE_DIGEST\": \"sha256:955252cd4af77ef00b9fd2421571d674c21856b99c25841a542e177160169df7\",\n                    \"IMAGE_URL\": \"quay.io/redhat-user-workloads/ocp-art-tenant/art-fbc:ose-secrets-store-csi-driver-operator-fbc-4.17.0-20250820154201\",\n                    \"RENDERED_CATALOG_DIGEST\": \"sha256:d50469e258b29064b58e5f153fac246306c4959c8b58930aad3dec91662d59a2\",\n                    \"TARGET_INDEX\": \"registry.redhat.io/redhat/redhat-operator-index\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"fbc-target-index-pruning-check\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'ecosystem-cert-preflight-checks'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"ecosystem-cert-preflight-checks\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"ecosystem-cert-preflight-checks\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-ecosystem-cert-preflight-checks:0.2@sha256:e106b6182e72c8f34ceae3f56b0b1aa2b4dc60f573877d9e51c3791029a7acb6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"ARTIFACT_TYPE\",\n                    \"type\": \"string\",\n                    \"value\": \"operatorbundle\"\n                  },\n                  {\n                    \"name\": \"ARTIFACT_TYPE_SET_BY\",\n                    \"type\": \"string\",\n                    \"value\": \"introspection\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T20:25:25+00:00\\\",\\\"note\\\":\\\"This ecosystem check is not executed for operatorbundles.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:24:50Z\",\n                \"finishedOn\": \"2025-08-27T20:25:32Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"artifact-type\": \"introspect\",\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-url\": \"quay.io/rhoai/odh-operator-bundle:rhoai-2.24\",\n                    \"platform\": \"\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"ecosystem-cert-preflight-checks\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get the bundle reference for task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:d0ee13ab3d9564f7ee806a8ceaced934db493a3a40e11ff6db3a912b8bbace95\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:bced27c2e2670c7139bd8b1cf8fda441ea4fce9048b7ad623062995df9cbde83\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:32:48Z\",\n                \"finishedOn\": \"2025-06-10T04:32:57Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"bundle.openshift.Dockerfile\",\n                    \"IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"IMAGE_DIGEST\": \"sha256:3aaaa9a5cd3f9e66e8c487b84e716652f4efad22a83809b138b6462ace886335\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-bundle-release@sha256:1b0d61ee77524d80b519e7afc9f897c4167bc833786bd70628a9d887b5c2abf9\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "bundle_ref := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    ref := task.ref.bundle\n} else := ref if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some param in task.ref.params\n    param.name == \"bundle\"\n    ref := param.value\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Find all results for task 'build-source-image'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"build-source-image\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"source-build-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-source-build-oci-ta:0.2@sha256:c5e56643c0f5e19409e86c8fd4de4348413b6f10456aa0875498d5c63bf6ef0e\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"BUILD_RESULT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"status\\\": \\\"success\\\", \\\"dependencies_included\\\": true, \\\"base_image_source_included\\\": false, \\\"image_url\\\": \\\"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\\\", \\\"image_digest\\\": \\\"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\\\"}\"\n                  },\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src@sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_DIGEST\",\n                    \"type\": \"string\",\n                    \"value\": \"sha256:17178df0b93f95728944c39196c99b0d4df4401cf72055c20dba73dfe3e40c19\"\n                  },\n                  {\n                    \"name\": \"SOURCE_IMAGE_URL\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:sha256-3f7c046a9f3033f66d4752ad9a7f40cf6e9fc5923a9b022840ed26a8dee51fe7.src\"\n                  }\n                ],\n                \"startedOn\": \"2025-06-10T04:39:55Z\",\n                \"finishedOn\": \"2025-06-10T04:41:29Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"BASE_IMAGES\": \"\",\n                    \"BINARY_IMAGE\": \"quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release:5b9f7b8c230cc56c90c681b1343ce9b3ad0d2336\",\n                    \"CACHI2_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:24798754d55999737ec608711fa5e4b1800dc46698d593ff026163b5cb953582\",\n                    \"IGNORE_UNSIGNED_IMAGE\": \"false\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/redhat-user-workloads/ocp-isc-tenant/file-integrity-operator-release@sha256:2e38e205752a8e325536d5aedfeb77f146acaff3321de72feee17ed72cc6622c\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"build-source-image\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check for material matching URI 'oci://registry.access.redhat.com/ubi9/skopeo' and commit 'cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"materials\": [\n            {\n              \"uri\": \"oci://registry.access.redhat.com/ubi9/skopeo\",\n              \"digest\": {\n                \"sha256\": \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  ]\n}", "output_code": "material_found if {\n    some att in input.attestations\n    some material in att.statement.predicate.materials\n    material.uri == \"oci://registry.access.redhat.com/ubi9/skopeo\"\n    material.digest.sha1 == \"cbf079a41e8dded35a1292730513857292930a2780e39f56d998ee4f3dadb856\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Look for a task with name 'clair-scan' in the attestation", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:893ffa3ce26b061e21bb4d8db9ef7ed4ddd4044fe7aa5451ef391034da3ff759\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\\\", \\\"digests\\\": [\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\",\\\"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:6da686faf29326063cba09ecf02ca640223365940335a1aa1871be7b52994439\\\":\\\"sha256:f8f32d494e7d1cba9974140d9aa382d4aa804130b61067266d146f4061ad9658\\\",\\\"sha256:19e592a2a1143e79ea4e2af02d35be86421dd7e7dac05c7ce26e2d32491a23fa\\\":\\\"sha256:466edc9b3248e9e4a76d9244d938a220ddba28be021c9aa4848fb35e1b472e66\\\",\\\"sha256:5c777cafc5f9190d4dcebad9ebfd4d47fd39ec157efa5758689163c998a2066d\\\":\\\"sha256:964e591259d0e6099dc68278534972c13028ffd864d4db43d72fb02c62eb06ad\\\",\\\"sha256:782982192d318d409f60a2c245e1ec63a1c134a7e271cf82a4180c61404b1859\\\":\\\"sha256:01c6e4cb3745aba81532939378217bc8069a9260fafcfdd9e9e6ef566817dfbe\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":12,\\\"medium\\\":76,\\\"low\\\":151,\\\"unknown\\\":8}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-08-27T18:48:34+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T18:47:21Z\",\n                \"finishedOn\": \"2025-08-27T18:48:35Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:40ed3f4f7a3823842d9177d7dc518efdcbee9091b6d263c088b76d8baba3f45b\",\n                    \"image-url\": \"quay.io/rhoai/odh-model-controller-rhel9:rhoai-2.24\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Get all results from task 'push-dockerfile'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"push-dockerfile\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"push-dockerfile-oci-ta\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-push-dockerfile-oci-ta:0.1@sha256:235ef6e835de8171c07b8a7f8947d0b40bfcff999e1ff3cb6ddd9acc65c48430\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGE_REF\",\n                    \"type\": \"string\",\n                    \"value\": \"quay.io/rhoai/odh-rhel9-operator@sha256:70e44f7770701bea3073199b77fe3e90f0f1839a6e1f4cbfd8808756be90d8fa\"\n                  }\n                ],\n                \"startedOn\": \"2025-08-27T20:04:45Z\",\n                \"finishedOn\": \"2025-08-27T20:04:54Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ARTIFACT_TYPE\": \"application/vnd.konflux.dockerfile\",\n                    \"CA_TRUST_CONFIG_MAP_KEY\": \"ca-bundle.crt\",\n                    \"CA_TRUST_CONFIG_MAP_NAME\": \"trusted-ca\",\n                    \"CONTEXT\": \".\",\n                    \"DOCKERFILE\": \"Dockerfiles/Dockerfile.konflux\",\n                    \"IMAGE\": \"quay.io/rhoai/odh-rhel9-operator:rhoai-2.24\",\n                    \"IMAGE_DIGEST\": \"sha256:2d9c8afd9bd57091355e180d5afcc5c153032f174f6ff4e96f2f245f7da20ec9\",\n                    \"SOURCE_ARTIFACT\": \"oci:quay.io/rhoai/odh-rhel9-operator@sha256:c7909d4d234c744060d8f2e245f40ba80b623a4282aad7d7be90f4ed7581effa\",\n                    \"TAG_SUFFIX\": \".dockerfile\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_results := [result |\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"push-dockerfile\"\n    some result in task.results\n]", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'clair-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"clair-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"clair-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-clair-scan:0.2@sha256:7c73e2beca9b8306387efeaf775831440ec799b05a5f5c008a65bb941a1e91f6\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\\\", \\\"digests\\\": [\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\",\\\"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"REPORTS\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"sha256:0812bc6a6e2fb69a6805e4373c342ee4c845daeeec953284552e5e0e6c79a991\\\":\\\"sha256:d0af342fc5f40e968e180cf7e1fa127968d92060cd33270c86eb8fa511da61c8\\\",\\\"sha256:219ead9f99068653443fb627f60b09fb57f64098d4460fb8d270da7734331f59\\\":\\\"sha256:baa7690ba743163a9a77694894dbf63d8ebcf93bd5220e1af2bc77c8b107c009\\\"}\\n\"\n                  },\n                  {\n                    \"name\": \"SCAN_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":0,\\\"low\\\":0,\\\"unknown\\\":0},\\\"unpatched_vulnerabilities\\\":{\\\"critical\\\":0,\\\"high\\\":0,\\\"medium\\\":62,\\\"low\\\":582,\\\"unknown\\\":0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T19:23:04+00:00\\\",\\\"note\\\":\\\"Task clair-scan completed: Refer to Tekton task result SCAN_OUTPUT for vulnerabilities scanned by Clair.\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T19:21:14Z\",\n                \"finishedOn\": \"2025-05-08T19:23:05Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"docker-auth\": \"\",\n                    \"image-digest\": \"sha256:0c2c1ee0de4bb399e19cfd52473e150d59aec22b041e8a95b553c9cbae4cb630\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-ui:142abbe6fd530a14295101c19a3c9db56a986755\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"clair-scan\"\n}", "task_type": "rego_attestation_parse"}
{"instruction": "Check if there is a task called 'rpms-signature-scan'", "context": "{\n  \"attestations\": [\n    {\n      \"statement\": {\n        \"predicate\": {\n          \"buildConfig\": {\n            \"tasks\": [\n              {\n                \"name\": \"rpms-signature-scan\",\n                \"status\": \"Succeeded\",\n                \"ref\": {\n                  \"resolver\": \"bundles\",\n                  \"params\": [\n                    {\n                      \"name\": \"name\",\n                      \"value\": \"rpms-signature-scan\"\n                    },\n                    {\n                      \"name\": \"bundle\",\n                      \"value\": \"quay.io/konflux-ci/tekton-catalog/task-rpms-signature-scan:0.2@sha256:2366b2f394610192736dd8edac1a702964daeb961603dfc9ceb6b8188e39a009\"\n                    },\n                    {\n                      \"name\": \"kind\",\n                      \"value\": \"task\"\n                    }\n                  ]\n                },\n                \"results\": [\n                  {\n                    \"name\": \"IMAGES_PROCESSED\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"image\\\": {\\\"pullspec\\\": \\\"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\\\", \\\"digests\\\": [\\\"sha256:ae2d8992d501cd21d6487b56a189a862a6003ed6a245b6136d59c20018052b46\\\", \\\"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\\\", \\\"sha256:6eacf34507446f5a916a5996f1da6e298a1355be24a931e4518f86b4fb7d8fb1\\\"]}}\\n\"\n                  },\n                  {\n                    \"name\": \"RPMS_DATA\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"keys\\\": {\\\"199e2f91fd431d51\\\": 429, \\\"unsigned\\\": 0}}\\n\"\n                  },\n                  {\n                    \"name\": \"TEST_OUTPUT\",\n                    \"type\": \"string\",\n                    \"value\": \"{\\\"result\\\":\\\"SUCCESS\\\",\\\"timestamp\\\":\\\"2025-05-08T20:27:09+00:00\\\",\\\"note\\\":\\\"Task rpms-signature-scan completed successfully\\\",\\\"namespace\\\":\\\"default\\\",\\\"successes\\\":0,\\\"failures\\\":0,\\\"warnings\\\":0}\\n\"\n                  }\n                ],\n                \"startedOn\": \"2025-05-08T20:26:54Z\",\n                \"finishedOn\": \"2025-05-08T20:27:10Z\",\n                \"invocation\": {\n                  \"parameters\": {\n                    \"ca-trust-config-map-key\": \"ca-bundle.crt\",\n                    \"ca-trust-config-map-name\": \"trusted-ca\",\n                    \"image-digest\": \"sha256:81e735a1212d0978246adfdc99c17ce80f5b2ed6c94bc8fc48b9d7e3a8e5a65e\",\n                    \"image-url\": \"quay.io/redhat-user-workloads/discovery-tenant/discovery/discovery-server:3b951972ffe6d75688946e8583e998d53c97b90a\",\n                    \"workdir\": \"/tmp\"\n                  }\n                }\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}", "output_code": "task_found if {\n    some att in input.attestations\n    some task in att.statement.predicate.buildConfig.tasks\n    task.name == \"rpms-signature-scan\"\n}", "task_type": "rego_attestation_parse"}
